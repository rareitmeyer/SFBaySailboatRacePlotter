/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={7089:(t,e,n)=>{const{Token:i}=n(5994),s=n(4126),{Interval:r}=n(8909);t.exports=class extends class{}{constructor(t){super(),this.tokenSource=t,this.tokens=[],this.index=-1,this.fetchedEOF=!1}mark(){return 0}release(t){}reset(){this.seek(0)}seek(t){this.lazyInit(),this.index=this.adjustSeekIndex(t)}get(t){return this.lazyInit(),this.tokens[t]}consume(){let t=!1;if(t=this.index>=0&&(this.fetchedEOF?this.index<this.tokens.length-1:this.index<this.tokens.length),!t&&this.LA(1)===i.EOF)throw"cannot consume EOF";this.sync(this.index+1)&&(this.index=this.adjustSeekIndex(this.index+1))}sync(t){const e=t-this.tokens.length+1;return!(e>0)||this.fetch(e)>=e}fetch(t){if(this.fetchedEOF)return 0;for(let e=0;e<t;e++){const t=this.tokenSource.nextToken();if(t.tokenIndex=this.tokens.length,this.tokens.push(t),t.type===i.EOF)return this.fetchedEOF=!0,e+1}return t}getTokens(t,e,n){if(void 0===n&&(n=null),t<0||e<0)return null;this.lazyInit();const s=[];e>=this.tokens.length&&(e=this.tokens.length-1);for(let r=t;r<e;r++){const t=this.tokens[r];if(t.type===i.EOF)break;(null===n||n.contains(t.type))&&s.push(t)}return s}LA(t){return this.LT(t).type}LB(t){return this.index-t<0?null:this.tokens[this.index-t]}LT(t){if(this.lazyInit(),0===t)return null;if(t<0)return this.LB(-t);const e=this.index+t-1;return this.sync(e),e>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[e]}adjustSeekIndex(t){return t}lazyInit(){-1===this.index&&this.setup()}setup(){this.sync(0),this.index=this.adjustSeekIndex(0)}setTokenSource(t){this.tokenSource=t,this.tokens=[],this.index=-1,this.fetchedEOF=!1}nextTokenOnChannel(t,e){if(this.sync(t),t>=this.tokens.length)return-1;let n=this.tokens[t];for(;n.channel!==this.channel;){if(n.type===i.EOF)return-1;t+=1,this.sync(t),n=this.tokens[t]}return t}previousTokenOnChannel(t,e){for(;t>=0&&this.tokens[t].channel!==e;)t-=1;return t}getHiddenTokensToRight(t,e){if(void 0===e&&(e=-1),this.lazyInit(),t<0||t>=this.tokens.length)throw t+" not in 0.."+this.tokens.length-1;const n=this.nextTokenOnChannel(t+1,s.DEFAULT_TOKEN_CHANNEL),i=t+1,r=-1===n?this.tokens.length-1:n;return this.filterForChannel(i,r,e)}getHiddenTokensToLeft(t,e){if(void 0===e&&(e=-1),this.lazyInit(),t<0||t>=this.tokens.length)throw t+" not in 0.."+this.tokens.length-1;const n=this.previousTokenOnChannel(t-1,s.DEFAULT_TOKEN_CHANNEL);if(n===t-1)return null;const i=n+1,r=t-1;return this.filterForChannel(i,r,e)}filterForChannel(t,e,n){const i=[];for(let r=t;r<e+1;r++){const t=this.tokens[r];-1===n?t.channel!==s.DEFAULT_TOKEN_CHANNEL&&i.push(t):t.channel===n&&i.push(t)}return 0===i.length?null:i}getSourceName(){return this.tokenSource.getSourceName()}getText(t){this.lazyInit(),this.fill(),null==t&&(t=new r(0,this.tokens.length-1));let e=t.start;e instanceof i&&(e=e.tokenIndex);let n=t.stop;if(n instanceof i&&(n=n.tokenIndex),null===e||null===n||e<0||n<0)return"";n>=this.tokens.length&&(n=this.tokens.length-1);let s="";for(let t=e;t<n+1;t++){const e=this.tokens[t];if(e.type===i.EOF)break;s+=e.text}return s}fill(){for(this.lazyInit();1e3===this.fetch(1e3););}}},2443:(t,e,n)=>{const i=n(8796),s=n(3654),r={fromString:function(t){return new i(t,!0)},fromBlob:function(t,e,n,s){const r=new window.FileReader;r.onload=function(t){const e=new i(t.target.result,!0);n(e)},r.onerror=s,r.readAsText(t,e)},fromBuffer:function(t,e){return new i(t.toString(e),!0)},fromPath:function(t,e,n){s.readFile(t,e,(function(t,e){let s=null;null!==e&&(s=new i(e,!0)),n(t,s)}))},fromPathSync:function(t,e){const n=s.readFileSync(t,e);return new i(n,!0)}};t.exports=r},1060:(t,e,n)=>{const i=n(5994).CommonToken;class s extends class{}{constructor(t){super(),this.copyText=void 0!==t&&t}create(t,e,n,s,r,o,a,l){const h=new i(t,e,s,r,o);return h.line=a,h.column=l,null!==n?h.text=n:this.copyText&&null!==t[1]&&(h.text=t[1].getText(r,o)),h}createThin(t,e){const n=new i(null,t);return n.text=e,n}}s.DEFAULT=new s,t.exports=s},7850:(t,e,n)=>{const i=n(5994).Token,s=n(7089);t.exports=class extends s{constructor(t,e){super(t),this.channel=void 0===e?i.DEFAULT_CHANNEL:e}adjustSeekIndex(t){return this.nextTokenOnChannel(t,this.channel)}LB(t){if(0===t||this.index-t<0)return null;let e=this.index,n=1;for(;n<=t;)e=this.previousTokenOnChannel(e-1,this.channel),n+=1;return e<0?null:this.tokens[e]}LT(t){if(this.lazyInit(),0===t)return null;if(t<0)return this.LB(-t);let e=this.index,n=1;for(;n<t;)this.sync(e+1)&&(e=this.nextTokenOnChannel(e+1,this.channel)),n+=1;return this.tokens[e]}getNumberOfOnChannelTokens(){let t=0;this.fill();for(let e=0;e<this.tokens.length;e++){const n=this.tokens[e];if(n.channel===this.channel&&(t+=1),n.type===i.EOF)break}return t}}},7661:(t,e,n)=>{const i=n(8796),s=n(3654);t.exports=class extends i{constructor(t,e){super(s.readFileSync(t,"utf8"),e),this.fileName=t}}},8796:(t,e,n)=>{const{Token:i}=n(5994);n(5879),n(6414),t.exports=class{constructor(t,e){if(this.name="<empty>",this.strdata=t,this.decodeToUnicodeCodePoints=e||!1,this._index=0,this.data=[],this.decodeToUnicodeCodePoints)for(let t=0;t<this.strdata.length;){const e=this.strdata.codePointAt(t);this.data.push(e),t+=e<=65535?1:2}else for(let t=0;t<this.strdata.length;t++){const e=this.strdata.charCodeAt(t);this.data.push(e)}this._size=this.data.length}reset(){this._index=0}consume(){if(this._index>=this._size)throw"cannot consume EOF";this._index+=1}LA(t){if(0===t)return 0;t<0&&(t+=1);const e=this._index+t-1;return e<0||e>=this._size?i.EOF:this.data[e]}LT(t){return this.LA(t)}mark(){return-1}release(t){}seek(t){t<=this._index?this._index=t:this._index=Math.min(t,this._size)}getText(t,e){if(e>=this._size&&(e=this._size-1),t>=this._size)return"";if(this.decodeToUnicodeCodePoints){let n="";for(let i=t;i<=e;i++)n+=String.fromCodePoint(this.data[i]);return n}return this.strdata.slice(t,e+1)}toString(){return this.strdata}get index(){return this._index}get size(){return this._size}}},8909:(t,e,n)=>{const{Token:i}=n(5994);class s{constructor(t,e){this.start=t,this.stop=e}contains(t){return t>=this.start&&t<this.stop}toString(){return this.start===this.stop-1?this.start.toString():this.start.toString()+".."+(this.stop-1).toString()}get length(){return this.stop-this.start}}class r{constructor(){this.intervals=null,this.readOnly=!1}first(t){return null===this.intervals||0===this.intervals.length?i.INVALID_TYPE:this.intervals[0].start}addOne(t){this.addInterval(new s(t,t+1))}addRange(t,e){this.addInterval(new s(t,e+1))}addInterval(t){if(null===this.intervals)this.intervals=[],this.intervals.push(t);else{for(let e=0;e<this.intervals.length;e++){const n=this.intervals[e];if(t.stop<n.start)return void this.intervals.splice(e,0,t);if(t.stop===n.start)return void(this.intervals[e].start=t.start);if(t.start<=n.stop)return this.intervals[e]=new s(Math.min(n.start,t.start),Math.max(n.stop,t.stop)),void this.reduce(e)}this.intervals.push(t)}}addSet(t){return null!==t.intervals&&t.intervals.forEach((t=>this.addInterval(t)),this),this}reduce(t){if(t<this.intervals.length-1){const e=this.intervals[t],n=this.intervals[t+1];e.stop>=n.stop?(this.intervals.splice(t+1,1),this.reduce(t)):e.stop>=n.start&&(this.intervals[t]=new s(e.start,n.stop),this.intervals.splice(t+1,1))}}complement(t,e){const n=new r;return n.addInterval(new s(t,e+1)),null!==this.intervals&&this.intervals.forEach((t=>n.removeRange(t))),n}contains(t){if(null===this.intervals)return!1;for(let e=0;e<this.intervals.length;e++)if(this.intervals[e].contains(t))return!0;return!1}removeRange(t){if(t.start===t.stop-1)this.removeOne(t.start);else if(null!==this.intervals){let e=0;for(let n=0;n<this.intervals.length;n++){const n=this.intervals[e];if(t.stop<=n.start)return;if(t.start>n.start&&t.stop<n.stop){this.intervals[e]=new s(n.start,t.start);const i=new s(t.stop,n.stop);return void this.intervals.splice(e,0,i)}t.start<=n.start&&t.stop>=n.stop?(this.intervals.splice(e,1),e-=1):t.start<n.stop?this.intervals[e]=new s(n.start,t.start):t.stop<n.stop&&(this.intervals[e]=new s(t.stop,n.stop)),e+=1}}}removeOne(t){if(null!==this.intervals)for(let e=0;e<this.intervals.length;e++){const n=this.intervals[e];if(t<n.start)return;if(t===n.start&&t===n.stop-1)return void this.intervals.splice(e,1);if(t===n.start)return void(this.intervals[e]=new s(n.start+1,n.stop));if(t===n.stop-1)return void(this.intervals[e]=new s(n.start,n.stop-1));if(t<n.stop-1){const i=new s(n.start,t);return n.start=t+1,void this.intervals.splice(e,0,i)}}}toString(t,e,n){return t=t||null,e=e||null,n=n||!1,null===this.intervals?"{}":null!==t||null!==e?this.toTokenString(t,e):n?this.toCharString():this.toIndexString()}toCharString(){const t=[];for(let e=0;e<this.intervals.length;e++){const n=this.intervals[e];n.stop===n.start+1?n.start===i.EOF?t.push("<EOF>"):t.push("'"+String.fromCharCode(n.start)+"'"):t.push("'"+String.fromCharCode(n.start)+"'..'"+String.fromCharCode(n.stop-1)+"'")}return t.length>1?"{"+t.join(", ")+"}":t[0]}toIndexString(){const t=[];for(let e=0;e<this.intervals.length;e++){const n=this.intervals[e];n.stop===n.start+1?n.start===i.EOF?t.push("<EOF>"):t.push(n.start.toString()):t.push(n.start.toString()+".."+(n.stop-1).toString())}return t.length>1?"{"+t.join(", ")+"}":t[0]}toTokenString(t,e){const n=[];for(let i=0;i<this.intervals.length;i++){const s=this.intervals[i];for(let i=s.start;i<s.stop;i++)n.push(this.elementName(t,e,i))}return n.length>1?"{"+n.join(", ")+"}":n[0]}elementName(t,e,n){return n===i.EOF?"<EOF>":n===i.EPSILON?"<EPSILON>":t[n]||e[n]}get length(){return this.intervals.map((t=>t.length)).reduce(((t,e)=>t+e))}}t.exports={Interval:s,IntervalSet:r}},3723:(t,e,n)=>{const{Set:i,BitSet:s}=n(7785),{Token:r}=n(5994),{ATNConfig:o}=n(3961),{IntervalSet:a}=n(8909),{RuleStopState:l}=n(290),{RuleTransition:h,NotSetTransition:u,WildcardTransition:c,AbstractPredicateTransition:d}=n(2068),{predictionContextFromRuleContext:p,PredictionContext:g,SingletonPredictionContext:f}=n(2259);class m{constructor(t){this.atn=t}getDecisionLookahead(t){if(null===t)return null;const e=t.transitions.length,n=[];for(let r=0;r<e;r++){n[r]=new a;const e=new i,o=!1;this._LOOK(t.transition(r).target,null,g.EMPTY,n[r],e,new s,o,!1),(0===n[r].length||n[r].contains(m.HIT_PRED))&&(n[r]=null)}return n}LOOK(t,e,n){const r=new a,o=null!==(n=n||null)?p(t.atn,n):null;return this._LOOK(t,e,o,r,new i,new s,!0,!0),r}_LOOK(t,e,n,i,s,a,p,x){const E=new o({state:t,alt:0,context:n},null);if(!s.contains(E)){if(s.add(E),t===e){if(null===n)return void i.addOne(r.EPSILON);if(n.isEmpty()&&x)return void i.addOne(r.EOF)}if(t instanceof l){if(null===n)return void i.addOne(r.EPSILON);if(n.isEmpty()&&x)return void i.addOne(r.EOF);if(n!==g.EMPTY){const r=a.contains(t.ruleIndex);try{a.remove(t.ruleIndex);for(let t=0;t<n.length;t++){const r=this.atn.states[n.getReturnState(t)];this._LOOK(r,e,n.getParent(t),i,s,a,p,x)}}finally{r&&a.add(t.ruleIndex)}return}}for(let o=0;o<t.transitions.length;o++){const l=t.transitions[o];if(l.constructor===h){if(a.contains(l.target.ruleIndex))continue;const t=f.create(n,l.followState.stateNumber);try{a.add(l.target.ruleIndex),this._LOOK(l.target,e,t,i,s,a,p,x)}finally{a.remove(l.target.ruleIndex)}}else if(l instanceof d)p?this._LOOK(l.target,e,n,i,s,a,p,x):i.addOne(m.HIT_PRED);else if(l.isEpsilon)this._LOOK(l.target,e,n,i,s,a,p,x);else if(l.constructor===c)i.addRange(r.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType);else{let t=l.label;null!==t&&(l instanceof u&&(t=t.complement(r.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType)),i.addSet(t))}}}}}m.HIT_PRED=r.INVALID_TYPE,t.exports=m},4126:(t,e,n)=>{const{Token:i}=n(5994),s=n(6438),r=n(1060),{RecognitionException:o}=n(3337),{LexerNoViableAltException:a}=n(3337);class l extends s{constructor(t){super(),this._input=t,this._factory=r.DEFAULT,this._tokenFactorySourcePair=[this,t],this._interp=null,this._token=null,this._tokenStartCharIndex=-1,this._tokenStartLine=-1,this._tokenStartColumn=-1,this._hitEOF=!1,this._channel=i.DEFAULT_CHANNEL,this._type=i.INVALID_TYPE,this._modeStack=[],this._mode=l.DEFAULT_MODE,this._text=null}reset(){null!==this._input&&this._input.seek(0),this._token=null,this._type=i.INVALID_TYPE,this._channel=i.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartColumn=-1,this._tokenStartLine=-1,this._text=null,this._hitEOF=!1,this._mode=l.DEFAULT_MODE,this._modeStack=[],this._interp.reset()}nextToken(){if(null===this._input)throw"nextToken requires a non-null input stream.";const t=this._input.mark();try{for(;;){if(this._hitEOF)return this.emitEOF(),this._token;this._token=null,this._channel=i.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartColumn=this._interp.column,this._tokenStartLine=this._interp.line,this._text=null;let t=!1;for(;;){this._type=i.INVALID_TYPE;let e=l.SKIP;try{e=this._interp.match(this._input,this._mode)}catch(t){if(!(t instanceof o))throw console.log(t.stack),t;this.notifyListeners(t),this.recover(t)}if(this._input.LA(1)===i.EOF&&(this._hitEOF=!0),this._type===i.INVALID_TYPE&&(this._type=e),this._type===l.SKIP){t=!0;break}if(this._type!==l.MORE)break}if(!t)return null===this._token&&this.emit(),this._token}}finally{this._input.release(t)}}skip(){this._type=l.SKIP}more(){this._type=l.MORE}mode(t){this._mode=t}pushMode(t){this._interp.debug&&console.log("pushMode "+t),this._modeStack.push(this._mode),this.mode(t)}popMode(){if(0===this._modeStack.length)throw"Empty Stack";return this._interp.debug&&console.log("popMode back to "+this._modeStack.slice(0,-1)),this.mode(this._modeStack.pop()),this._mode}emitToken(t){this._token=t}emit(){const t=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.getCharIndex()-1,this._tokenStartLine,this._tokenStartColumn);return this.emitToken(t),t}emitEOF(){const t=this.column,e=this.line,n=this._factory.create(this._tokenFactorySourcePair,i.EOF,null,i.DEFAULT_CHANNEL,this._input.index,this._input.index-1,e,t);return this.emitToken(n),n}getCharIndex(){return this._input.index}getAllTokens(){const t=[];let e=this.nextToken();for(;e.type!==i.EOF;)t.push(e),e=this.nextToken();return t}notifyListeners(t){const e=this._tokenStartCharIndex,n=this._input.index,i=this._input.getText(e,n),s="token recognition error at: '"+this.getErrorDisplay(i)+"'";this.getErrorListenerDispatch().syntaxError(this,null,this._tokenStartLine,this._tokenStartColumn,s,t)}getErrorDisplay(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n]);return e.join("")}getErrorDisplayForChar(t){return t.charCodeAt(0)===i.EOF?"<EOF>":"\n"===t?"\\n":"\t"===t?"\\t":"\r"===t?"\\r":t}getCharErrorDisplay(t){return"'"+this.getErrorDisplayForChar(t)+"'"}recover(t){this._input.LA(1)!==i.EOF&&(t instanceof a?this._interp.consume(this._input):this._input.consume())}get inputStream(){return this._input}set inputStream(t){this._input=null,this._tokenFactorySourcePair=[this,this._input],this.reset(),this._input=t,this._tokenFactorySourcePair=[this,this._input]}get sourceName(){return this._input.sourceName}get type(){return this.type}set type(t){this._type=t}get line(){return this._interp.line}set line(t){this._interp.line=t}get column(){return this._interp.column}set column(t){this._interp.column=t}get text(){return null!==this._text?this._text:this._interp.getText(this._input)}set text(t){this._text=t}}l.DEFAULT_MODE=0,l.MORE=-2,l.SKIP=-3,l.DEFAULT_TOKEN_CHANNEL=i.DEFAULT_CHANNEL,l.HIDDEN=i.HIDDEN_CHANNEL,l.MIN_CHAR_VALUE=0,l.MAX_CHAR_VALUE=1114111,t.exports=l},63:(t,e,n)=>{const{Token:i}=n(5994),{ParseTreeListener:s,TerminalNode:r,ErrorNode:o}=n(5828),a=n(6438),{DefaultErrorStrategy:l}=n(4390),h=n(3369),u=n(8962),c=n(4126);class d extends s{constructor(t){super(),this.parser=t}enterEveryRule(t){console.log("enter   "+this.parser.ruleNames[t.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}visitTerminal(t){console.log("consume "+t.symbol+" rule "+this.parser.ruleNames[this.parser._ctx.ruleIndex])}exitEveryRule(t){console.log("exit    "+this.parser.ruleNames[t.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}}class p extends a{constructor(t){super(),this._input=null,this._errHandler=new l,this._precedenceStack=[],this._precedenceStack.push(0),this._ctx=null,this.buildParseTrees=!0,this._tracer=null,this._parseListeners=null,this._syntaxErrors=0,this.setInputStream(t)}reset(){null!==this._input&&this._input.seek(0),this._errHandler.reset(this),this._ctx=null,this._syntaxErrors=0,this.setTrace(!1),this._precedenceStack=[],this._precedenceStack.push(0),null!==this._interp&&this._interp.reset()}match(t){let e=this.getCurrentToken();return e.type===t?(this._errHandler.reportMatch(this),this.consume()):(e=this._errHandler.recoverInline(this),this.buildParseTrees&&-1===e.tokenIndex&&this._ctx.addErrorNode(e)),e}matchWildcard(){let t=this.getCurrentToken();return t.type>0?(this._errHandler.reportMatch(this),this.consume()):(t=this._errHandler.recoverInline(this),this._buildParseTrees&&-1===t.tokenIndex&&this._ctx.addErrorNode(t)),t}getParseListeners(){return this._parseListeners||[]}addParseListener(t){if(null===t)throw"listener";null===this._parseListeners&&(this._parseListeners=[]),this._parseListeners.push(t)}removeParseListener(t){if(null!==this._parseListeners){const e=this._parseListeners.indexOf(t);e>=0&&this._parseListeners.splice(e,1),0===this._parseListeners.length&&(this._parseListeners=null)}}removeParseListeners(){this._parseListeners=null}triggerEnterRuleEvent(){if(null!==this._parseListeners){const t=this._ctx;this._parseListeners.map((function(e){e.enterEveryRule(t),t.enterRule(e)}))}}triggerExitRuleEvent(){if(null!==this._parseListeners){const t=this._ctx;this._parseListeners.slice(0).reverse().map((function(e){t.exitRule(e),e.exitEveryRule(t)}))}}getTokenFactory(){return this._input.tokenSource._factory}setTokenFactory(t){this._input.tokenSource._factory=t}getATNWithBypassAlts(){const t=this.getSerializedATN();if(null===t)throw"The current parser does not support an ATN with bypass alternatives.";let e=this.bypassAltsAtnCache[t];if(null===e){const n=new u;n.generateRuleBypassTransitions=!0,e=new h(n).deserialize(t),this.bypassAltsAtnCache[t]=e}return e}compileParseTreePattern(t,e,n){if(null===(n=n||null)&&null!==this.getTokenStream()){const t=this.getTokenStream().tokenSource;t instanceof c&&(n=t)}if(null===n)throw"Parser can't discover a lexer to use";return new ParseTreePatternMatcher(n,this).compile(t,e)}getInputStream(){return this.getTokenStream()}setInputStream(t){this.setTokenStream(t)}getTokenStream(){return this._input}setTokenStream(t){this._input=null,this.reset(),this._input=t}getCurrentToken(){return this._input.LT(1)}notifyErrorListeners(t,e,n){n=n||null,null===(e=e||null)&&(e=this.getCurrentToken()),this._syntaxErrors+=1;const i=e.line,s=e.column;this.getErrorListenerDispatch().syntaxError(this,e,i,s,t,n)}consume(){const t=this.getCurrentToken();t.type!==i.EOF&&this.getInputStream().consume();const e=null!==this._parseListeners&&this._parseListeners.length>0;if(this.buildParseTrees||e){let n;n=this._errHandler.inErrorRecoveryMode(this)?this._ctx.addErrorNode(t):this._ctx.addTokenNode(t),n.invokingState=this.state,e&&this._parseListeners.map((function(t){n instanceof o||void 0!==n.isErrorNode&&n.isErrorNode()?t.visitErrorNode(n):n instanceof r&&t.visitTerminal(n)}))}return t}addContextToParseTree(){null!==this._ctx.parentCtx&&this._ctx.parentCtx.addChild(this._ctx)}enterRule(t,e,n){this.state=e,this._ctx=t,this._ctx.start=this._input.LT(1),this.buildParseTrees&&this.addContextToParseTree(),null!==this._parseListeners&&this.triggerEnterRuleEvent()}exitRule(){this._ctx.stop=this._input.LT(-1),null!==this._parseListeners&&this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx.parentCtx}enterOuterAlt(t,e){t.setAltNumber(e),this.buildParseTrees&&this._ctx!==t&&null!==this._ctx.parentCtx&&(this._ctx.parentCtx.removeLastChild(),this._ctx.parentCtx.addChild(t)),this._ctx=t}getPrecedence(){return 0===this._precedenceStack.length?-1:this._precedenceStack[this._precedenceStack.length-1]}enterRecursionRule(t,e,n,i){this.state=e,this._precedenceStack.push(i),this._ctx=t,this._ctx.start=this._input.LT(1),null!==this._parseListeners&&this.triggerEnterRuleEvent()}pushNewRecursionContext(t,e,n){const i=this._ctx;i.parentCtx=t,i.invokingState=e,i.stop=this._input.LT(-1),this._ctx=t,this._ctx.start=i.start,this.buildParseTrees&&this._ctx.addChild(i),null!==this._parseListeners&&this.triggerEnterRuleEvent()}unrollRecursionContexts(t){this._precedenceStack.pop(),this._ctx.stop=this._input.LT(-1);const e=this._ctx;if(null!==this._parseListeners)for(;this._ctx!==t;)this.triggerExitRuleEvent(),this._ctx=this._ctx.parentCtx;else this._ctx=t;e.parentCtx=t,this.buildParseTrees&&null!==t&&t.addChild(e)}getInvokingContext(t){let e=this._ctx;for(;null!==e;){if(e.ruleIndex===t)return e;e=e.parentCtx}return null}precpred(t,e){return e>=this._precedenceStack[this._precedenceStack.length-1]}inContext(t){return!1}isExpectedToken(t){const e=this._interp.atn;let n=this._ctx;const s=e.states[this.state];let r=e.nextTokens(s);if(r.contains(t))return!0;if(!r.contains(i.EPSILON))return!1;for(;null!==n&&n.invokingState>=0&&r.contains(i.EPSILON);){const i=e.states[n.invokingState].transitions[0];if(r=e.nextTokens(i.followState),r.contains(t))return!0;n=n.parentCtx}return!(!r.contains(i.EPSILON)||t!==i.EOF)}getExpectedTokens(){return this._interp.atn.getExpectedTokens(this.state,this._ctx)}getExpectedTokensWithinCurrentRule(){const t=this._interp.atn,e=t.states[this.state];return t.nextTokens(e)}getRuleIndex(t){const e=this.getRuleIndexMap()[t];return null!==e?e:-1}getRuleInvocationStack(t){null===(t=t||null)&&(t=this._ctx);const e=[];for(;null!==t;){const n=t.ruleIndex;n<0?e.push("n/a"):e.push(this.ruleNames[n]),t=t.parentCtx}return e}getDFAStrings(){return this._interp.decisionToDFA.toString()}dumpDFA(){let t=!1;for(let e=0;e<this._interp.decisionToDFA.length;e++){const n=this._interp.decisionToDFA[e];n.states.length>0&&(t&&console.log(),this.printer.println("Decision "+n.decision+":"),this.printer.print(n.toString(this.literalNames,this.symbolicNames)),t=!0)}}getSourceName(){return this._input.sourceName}setTrace(t){t?(null!==this._tracer&&this.removeParseListener(this._tracer),this._tracer=new d(this),this.addParseListener(this._tracer)):(this.removeParseListener(this._tracer),this._tracer=null)}}p.bypassAltsAtnCache={},t.exports=p},2449:(t,e,n)=>{const i=n(5302),s=n(5828),r=s.INVALID_INTERVAL,o=s.TerminalNode,a=s.TerminalNodeImpl,l=s.ErrorNodeImpl,h=n(8909).Interval;class u extends i{constructor(t,e){super(t=t||null,e=e||null),this.ruleIndex=-1,this.children=null,this.start=null,this.stop=null,this.exception=null}copyFrom(t){this.parentCtx=t.parentCtx,this.invokingState=t.invokingState,this.children=null,this.start=t.start,this.stop=t.stop,t.children&&(this.children=[],t.children.map((function(t){t instanceof l&&(this.children.push(t),t.parentCtx=this)}),this))}enterRule(t){}exitRule(t){}addChild(t){return null===this.children&&(this.children=[]),this.children.push(t),t}removeLastChild(){null!==this.children&&this.children.pop()}addTokenNode(t){const e=new a(t);return this.addChild(e),e.parentCtx=this,e}addErrorNode(t){const e=new l(t);return this.addChild(e),e.parentCtx=this,e}getChild(t,e){if(e=e||null,null===this.children||t<0||t>=this.children.length)return null;if(null===e)return this.children[t];for(let n=0;n<this.children.length;n++){const i=this.children[n];if(i instanceof e){if(0===t)return i;t-=1}}return null}getToken(t,e){if(null===this.children||e<0||e>=this.children.length)return null;for(let n=0;n<this.children.length;n++){const i=this.children[n];if(i instanceof o&&i.symbol.type===t){if(0===e)return i;e-=1}}return null}getTokens(t){if(null===this.children)return[];{const e=[];for(let n=0;n<this.children.length;n++){const i=this.children[n];i instanceof o&&i.symbol.type===t&&e.push(i)}return e}}getTypedRuleContext(t,e){return this.getChild(e,t)}getTypedRuleContexts(t){if(null===this.children)return[];{const e=[];for(let n=0;n<this.children.length;n++){const i=this.children[n];i instanceof t&&e.push(i)}return e}}getChildCount(){return null===this.children?0:this.children.length}getSourceInterval(){return null===this.start||null===this.stop?r:new h(this.start.tokenIndex,this.stop.tokenIndex)}}i.EMPTY=new u,t.exports=u},2259:(t,e,n)=>{const i=n(5302),{Hash:s,Map:r,equalArrays:o}=n(7785);class a{constructor(t){this.cachedHashCode=t}isEmpty(){return this===a.EMPTY}hasEmptyPath(){return this.getReturnState(this.length-1)===a.EMPTY_RETURN_STATE}hashCode(){return this.cachedHashCode}updateHashCode(t){t.update(this.cachedHashCode)}}a.EMPTY=null,a.EMPTY_RETURN_STATE=2147483647,a.globalNodeCount=1,a.id=a.globalNodeCount;class l extends a{constructor(t,e){let n=0;const i=new s;null!==t?i.update(t,e):i.update(1),n=i.finish(),super(n),this.parentCtx=t,this.returnState=e}getParent(t){return this.parentCtx}getReturnState(t){return this.returnState}equals(t){return this===t||t instanceof l&&this.hashCode()===t.hashCode()&&this.returnState===t.returnState&&(null==this.parentCtx?null==t.parentCtx:this.parentCtx.equals(t.parentCtx))}toString(){const t=null===this.parentCtx?"":this.parentCtx.toString();return 0===t.length?this.returnState===a.EMPTY_RETURN_STATE?"$":""+this.returnState:this.returnState+" "+t}get length(){return 1}static create(t,e){return e===a.EMPTY_RETURN_STATE&&null===t?a.EMPTY:new l(t,e)}}class h extends l{constructor(){super(null,a.EMPTY_RETURN_STATE)}isEmpty(){return!0}getParent(t){return null}getReturnState(t){return this.returnState}equals(t){return this===t}toString(){return"$"}}a.EMPTY=new h;class u extends a{constructor(t,e){const n=new s;return n.update(t,e),super(n.finish()),this.parents=t,this.returnStates=e,this}isEmpty(){return this.returnStates[0]===a.EMPTY_RETURN_STATE}getParent(t){return this.parents[t]}getReturnState(t){return this.returnStates[t]}equals(t){return this===t||t instanceof u&&this.hashCode()===t.hashCode()&&o(this.returnStates,t.returnStates)&&o(this.parents,t.parents)}toString(){if(this.isEmpty())return"[]";{let t="[";for(let e=0;e<this.returnStates.length;e++)e>0&&(t+=", "),this.returnStates[e]!==a.EMPTY_RETURN_STATE?(t+=this.returnStates[e],null!==this.parents[e]?t=t+" "+this.parents[e]:t+="null"):t+="$";return t+"]"}}get length(){return this.returnStates.length}}t.exports={merge:function t(e,n,i,s){if(e===n)return e;if(e instanceof l&&n instanceof l)return function(e,n,i,s){if(null!==s){let t=s.get(e,n);if(null!==t)return t;if(t=s.get(n,e),null!==t)return t}const r=function(t,e,n){if(n){if(t===a.EMPTY)return a.EMPTY;if(e===a.EMPTY)return a.EMPTY}else{if(t===a.EMPTY&&e===a.EMPTY)return a.EMPTY;if(t===a.EMPTY){const t=[e.returnState,a.EMPTY_RETURN_STATE],n=[e.parentCtx,null];return new u(n,t)}if(e===a.EMPTY){const e=[t.returnState,a.EMPTY_RETURN_STATE],n=[t.parentCtx,null];return new u(n,e)}}return null}(e,n,i);if(null!==r)return null!==s&&s.set(e,n,r),r;if(e.returnState===n.returnState){const r=t(e.parentCtx,n.parentCtx,i,s);if(r===e.parentCtx)return e;if(r===n.parentCtx)return n;const o=l.create(r,e.returnState);return null!==s&&s.set(e,n,o),o}{let t=null;if((e===n||null!==e.parentCtx&&e.parentCtx===n.parentCtx)&&(t=e.parentCtx),null!==t){const i=[e.returnState,n.returnState];e.returnState>n.returnState&&(i[0]=n.returnState,i[1]=e.returnState);const r=new u([t,t],i);return null!==s&&s.set(e,n,r),r}const i=[e.returnState,n.returnState];let r=[e.parentCtx,n.parentCtx];e.returnState>n.returnState&&(i[0]=n.returnState,i[1]=e.returnState,r=[n.parentCtx,e.parentCtx]);const o=new u(r,i);return null!==s&&s.set(e,n,o),o}}(e,n,i,s);if(i){if(e instanceof h)return e;if(n instanceof h)return n}return e instanceof l&&(e=new u([e.getParent()],[e.returnState])),n instanceof l&&(n=new u([n.getParent()],[n.returnState])),function(e,n,i,s){if(null!==s){let t=s.get(e,n);if(null!==t)return t;if(t=s.get(n,e),null!==t)return t}let o=0,h=0,c=0,d=[],p=[];for(;o<e.returnStates.length&&h<n.returnStates.length;){const r=e.parents[o],l=n.parents[h];if(e.returnStates[o]===n.returnStates[h]){const n=e.returnStates[o],u=null!==r&&null!==l&&r===l;n===a.EMPTY_RETURN_STATE&&null===r&&null===l||u?(p[c]=r,d[c]=n):(p[c]=t(r,l,i,s),d[c]=n),o+=1,h+=1}else e.returnStates[o]<n.returnStates[h]?(p[c]=r,d[c]=e.returnStates[o],o+=1):(p[c]=l,d[c]=n.returnStates[h],h+=1);c+=1}if(o<e.returnStates.length)for(let t=o;t<e.returnStates.length;t++)p[c]=e.parents[t],d[c]=e.returnStates[t],c+=1;else for(let t=h;t<n.returnStates.length;t++)p[c]=n.parents[t],d[c]=n.returnStates[t],c+=1;if(c<p.length){if(1===c){const t=l.create(p[0],d[0]);return null!==s&&s.set(e,n,t),t}p=p.slice(0,c),d=d.slice(0,c)}const g=new u(p,d);return g===e?(null!==s&&s.set(e,n,e),e):g===n?(null!==s&&s.set(e,n,n),n):(function(t){const e=new r;for(let n=0;n<t.length;n++){const i=t[n];e.containsKey(i)||e.put(i,i)}for(let n=0;n<t.length;n++)t[n]=e.get(t[n])}(p),null!==s&&s.set(e,n,g),g)}(e,n,i,s)},PredictionContext:a,PredictionContextCache:class{constructor(){this.cache=new r}add(t){if(t===a.EMPTY)return a.EMPTY;const e=this.cache.get(t)||null;return null!==e?e:(this.cache.put(t,t),t)}get(t){return this.cache.get(t)||null}get length(){return this.cache.length}},SingletonPredictionContext:l,predictionContextFromRuleContext:function t(e,n){if(null==n&&(n=i.EMPTY),null===n.parentCtx||n===i.EMPTY)return a.EMPTY;const s=t(e,n.parentCtx),r=e.states[n.invokingState].transitions[0];return l.create(s,r.followState.stateNumber)},getCachedPredictionContext:function t(e,n,i){if(e.isEmpty())return e;let s=i.get(e)||null;if(null!==s)return s;if(s=n.get(e),null!==s)return i.put(e,s),s;let r=!1,o=[];for(let s=0;s<o.length;s++){const a=t(e.getParent(s),n,i);if(r||a!==e.getParent(s)){if(!r){o=[];for(let t=0;t<e.length;t++)o[t]=e.getParent(t);r=!0}o[s]=a}}if(!r)return n.add(e),i.put(e,e),e;let h=null;return h=0===o.length?a.EMPTY:1===o.length?l.create(o[0],e.getReturnState(0)):new u(o,e.returnStates),n.add(h),i.put(h,h),i.put(e,h),h}}},6438:(t,e,n)=>{const{Token:i}=n(5994),{ConsoleErrorListener:s}=n(9553),{ProxyErrorListener:r}=n(9553);class o{constructor(){this._listeners=[s.INSTANCE],this._interp=null,this._stateNumber=-1}checkVersion(t){"4.9.2"!==t&&console.log("ANTLR runtime and generated code versions disagree: 4.9.2!="+t)}addErrorListener(t){this._listeners.push(t)}removeErrorListeners(){this._listeners=[]}getTokenTypeMap(){const t=this.getTokenNames();if(null===t)throw"The current recognizer does not provide a list of token names.";let e=this.tokenTypeMapCache[t];return void 0===e&&(e=t.reduce((function(t,e,n){t[e]=n})),e.EOF=i.EOF,this.tokenTypeMapCache[t]=e),e}getRuleIndexMap(){const t=this.ruleNames;if(null===t)throw"The current recognizer does not provide a list of rule names.";let e=this.ruleIndexMapCache[t];return void 0===e&&(e=t.reduce((function(t,e,n){t[e]=n})),this.ruleIndexMapCache[t]=e),e}getTokenType(t){const e=this.getTokenTypeMap()[t];return void 0!==e?e:i.INVALID_TYPE}getErrorHeader(t){return"line "+t.getOffendingToken().line+":"+t.getOffendingToken().column}getTokenErrorDisplay(t){if(null===t)return"<no token>";let e=t.text;return null===e&&(e=t.type===i.EOF?"<EOF>":"<"+t.type+">"),e=e.replace("\n","\\n").replace("\r","\\r").replace("\t","\\t"),"'"+e+"'"}getErrorListenerDispatch(){return new r(this._listeners)}sempred(t,e,n){return!0}precpred(t,e){return!0}get state(){return this._stateNumber}set state(t){this._stateNumber=t}}o.tokenTypeMapCache={},o.ruleIndexMapCache={},t.exports=o},5302:(t,e,n)=>{const{RuleNode:i}=n(5828),{INVALID_INTERVAL:s}=n(5828),r=n(8030);t.exports=class extends i{constructor(t,e){super(),this.parentCtx=t||null,this.invokingState=e||-1}depth(){let t=0,e=this;for(;null!==e;)e=e.parentCtx,t+=1;return t}isEmpty(){return-1===this.invokingState}getSourceInterval(){return s}getRuleContext(){return this}getPayload(){return this}getText(){return 0===this.getChildCount()?"":this.children.map((function(t){return t.getText()})).join("")}getAltNumber(){return 0}setAltNumber(t){}getChild(t){return null}getChildCount(){return 0}accept(t){return t.visitChildren(this)}toStringTree(t,e){return r.toStringTree(this,t,e)}toString(t,e){t=t||null,e=e||null;let n=this,i="[";for(;null!==n&&n!==e;){if(null===t)n.isEmpty()||(i+=n.invokingState);else{const e=n.ruleIndex;i+=e>=0&&e<t.length?t[e]:""+e}null===n.parentCtx||null===t&&n.parentCtx.isEmpty()||(i+=" "),n=n.parentCtx}return i+="]",i}}},5994:t=>{class e{constructor(){this.source=null,this.type=null,this.channel=null,this.start=null,this.stop=null,this.tokenIndex=null,this.line=null,this.column=null,this._text=null}getTokenSource(){return this.source[0]}getInputStream(){return this.source[1]}get text(){return this._text}set text(t){this._text=t}}e.INVALID_TYPE=0,e.EPSILON=-2,e.MIN_USER_TOKEN_TYPE=1,e.EOF=-1,e.DEFAULT_CHANNEL=0,e.HIDDEN_CHANNEL=1;class n extends e{constructor(t,i,s,r,o){super(),this.source=void 0!==t?t:n.EMPTY_SOURCE,this.type=void 0!==i?i:null,this.channel=void 0!==s?s:e.DEFAULT_CHANNEL,this.start=void 0!==r?r:-1,this.stop=void 0!==o?o:-1,this.tokenIndex=-1,null!==this.source[0]?(this.line=t[0].line,this.column=t[0].column):this.column=-1}clone(){const t=new n(this.source,this.type,this.channel,this.start,this.stop);return t.tokenIndex=this.tokenIndex,t.line=this.line,t.column=this.column,t.text=this.text,t}toString(){let t=this.text;return t=null!==t?t.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"):"<no text>","[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+t+"',<"+this.type+">"+(this.channel>0?",channel="+this.channel:"")+","+this.line+":"+this.column+"]"}get text(){if(null!==this._text)return this._text;const t=this.getInputStream();if(null===t)return null;const e=t.size;return this.start<e&&this.stop<e?t.getText(this.start,this.stop):"<EOF>"}set text(t){this._text=t}}n.EMPTY_SOURCE=[null,null],t.exports={Token:e,CommonToken:n}},7785:t=>{function e(t){return Array.isArray(t)?"["+t.join(", ")+"]":"null"}function n(t,e){return t?t.equals(e):t==e}function i(t){return t?t.hashCode():-1}String.prototype.seed=String.prototype.seed||Math.round(Math.random()*Math.pow(2,32)),String.prototype.hashCode=function(){const t=this.toString();let e,n;const i=3&t.length,s=t.length-i;let r=String.prototype.seed;const o=3432918353,a=461845907;let l=0;for(;l<s;)n=255&t.charCodeAt(l)|(255&t.charCodeAt(++l))<<8|(255&t.charCodeAt(++l))<<16|(255&t.charCodeAt(++l))<<24,++l,n=(65535&n)*o+(((n>>>16)*o&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*a+(((n>>>16)*a&65535)<<16)&4294967295,r^=n,r=r<<13|r>>>19,e=5*(65535&r)+((5*(r>>>16)&65535)<<16)&4294967295,r=27492+(65535&e)+((58964+(e>>>16)&65535)<<16);switch(n=0,i){case 3:n^=(255&t.charCodeAt(l+2))<<16;case 2:n^=(255&t.charCodeAt(l+1))<<8;case 1:n^=255&t.charCodeAt(l),n=(65535&n)*o+(((n>>>16)*o&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*a+(((n>>>16)*a&65535)<<16)&4294967295,r^=n}return r^=t.length,r^=r>>>16,r=2246822507*(65535&r)+((2246822507*(r>>>16)&65535)<<16)&4294967295,r^=r>>>13,r=3266489909*(65535&r)+((3266489909*(r>>>16)&65535)<<16)&4294967295,r^=r>>>16,r>>>0};class s{constructor(){this.data=[]}add(t){this.data[t]=!0}or(t){const e=this;Object.keys(t.data).map((function(t){e.add(t)}))}remove(t){delete this.data[t]}contains(t){return!0===this.data[t]}values(){return Object.keys(this.data)}minValue(){return Math.min.apply(null,this.values())}hashCode(){const t=new o;return t.update(this.values()),t.finish()}equals(t){return t instanceof s&&this.hashCode()===t.hashCode()}toString(){return"{"+this.values().join(", ")+"}"}get length(){return this.values().length}}class r{constructor(t,e){this.data={},this.hashFunction=t||i,this.equalsFunction=e||n}put(t,e){const n="hash_"+this.hashFunction(t);if(n in this.data){const i=this.data[n];for(let n=0;n<i.length;n++){const s=i[n];if(this.equalsFunction(t,s.key)){const t=s.value;return s.value=e,t}}return i.push({key:t,value:e}),e}return this.data[n]=[{key:t,value:e}],e}containsKey(t){const e="hash_"+this.hashFunction(t);if(e in this.data){const n=this.data[e];for(let e=0;e<n.length;e++){const i=n[e];if(this.equalsFunction(t,i.key))return!0}}return!1}get(t){const e="hash_"+this.hashFunction(t);if(e in this.data){const n=this.data[e];for(let e=0;e<n.length;e++){const i=n[e];if(this.equalsFunction(t,i.key))return i.value}}return null}entries(){let t=[];for(const e in this.data)0===e.indexOf("hash_")&&(t=t.concat(this.data[e]));return t}getKeys(){return this.entries().map((function(t){return t.key}))}getValues(){return this.entries().map((function(t){return t.value}))}toString(){return"["+this.entries().map((function(t){return"{"+t.key+":"+t.value+"}"})).join(", ")+"]"}get length(){let t=0;for(const e in this.data)0===e.indexOf("hash_")&&(t+=this.data[e].length);return t}}class o{constructor(){this.count=0,this.hash=0}update(){for(let t=0;t<arguments.length;t++){const e=arguments[t];if(null!=e)if(Array.isArray(e))this.update.apply(this,e);else{let t=0;switch(typeof e){case"undefined":case"function":continue;case"number":case"boolean":t=e;break;case"string":t=e.hashCode();break;default:e.updateHashCode?e.updateHashCode(this):console.log("No updateHashCode for "+e.toString());continue}t*=3432918353,t=t<<15|t>>>17,t*=461845907,this.count=this.count+1;let n=this.hash^t;n=n<<13|n>>>19,n=5*n+3864292196,this.hash=n}}}finish(){let t=this.hash^4*this.count;return t^=t>>>16,t*=2246822507,t^=t>>>13,t*=3266489909,t^=t>>>16,t}}t.exports={Hash:o,Set:class{constructor(t,e){this.data={},this.hashFunction=t||i,this.equalsFunction=e||n}add(t){const e="hash_"+this.hashFunction(t);if(e in this.data){const n=this.data[e];for(let e=0;e<n.length;e++)if(this.equalsFunction(t,n[e]))return n[e];return n.push(t),t}return this.data[e]=[t],t}contains(t){return null!=this.get(t)}get(t){const e="hash_"+this.hashFunction(t);if(e in this.data){const n=this.data[e];for(let e=0;e<n.length;e++)if(this.equalsFunction(t,n[e]))return n[e]}return null}values(){let t=[];for(const e in this.data)0===e.indexOf("hash_")&&(t=t.concat(this.data[e]));return t}toString(){return e(this.values())}get length(){let t=0;for(const e in this.data)0===e.indexOf("hash_")&&(t+=this.data[e].length);return t}},Map:r,BitSet:s,AltDict:class{constructor(){this.data={}}get(t){return(t="k-"+t)in this.data?this.data[t]:null}put(t,e){t="k-"+t,this.data[t]=e}values(){const t=this.data;return Object.keys(this.data).map((function(e){return t[e]}))}},DoubleDict:class{constructor(t){this.defaultMapCtor=t||r,this.cacheMap=new this.defaultMapCtor}get(t,e){const n=this.cacheMap.get(t)||null;return null===n?null:n.get(e)||null}set(t,e,n){let i=this.cacheMap.get(t)||null;null===i&&(i=new this.defaultMapCtor,this.cacheMap.put(t,i)),i.put(e,n)}},hashStuff:function(){const t=new o;return t.update.apply(t,arguments),t.finish()},escapeWhitespace:function(t,e){return t=t.replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r"),e&&(t=t.replace(/ /g,"·")),t},arrayToString:e,titleCase:function(t){return t.replace(/\w\S*/g,(function(t){return t.charAt(0).toUpperCase()+t.substr(1)}))},equalArrays:function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!(t[n]===e[n]||t[n].equals&&t[n].equals(e[n])))return!1;return!0}}},8641:(t,e,n)=>{const i=n(3723),{IntervalSet:s}=n(8909),{Token:r}=n(5994);class o{constructor(t,e){this.grammarType=t,this.maxTokenType=e,this.states=[],this.decisionToState=[],this.ruleToStartState=[],this.ruleToStopState=null,this.modeNameToStartState={},this.ruleToTokenType=null,this.lexerActions=null,this.modeToStartState=[]}nextTokensInContext(t,e){return new i(this).LOOK(t,null,e)}nextTokensNoContext(t){return null!==t.nextTokenWithinRule||(t.nextTokenWithinRule=this.nextTokensInContext(t,null),t.nextTokenWithinRule.readOnly=!0),t.nextTokenWithinRule}nextTokens(t,e){return void 0===e?this.nextTokensNoContext(t):this.nextTokensInContext(t,e)}addState(t){null!==t&&(t.atn=this,t.stateNumber=this.states.length),this.states.push(t)}removeState(t){this.states[t.stateNumber]=null}defineDecisionState(t){return this.decisionToState.push(t),t.decision=this.decisionToState.length-1,t.decision}getDecisionState(t){return 0===this.decisionToState.length?null:this.decisionToState[t]}getExpectedTokens(t,e){if(t<0||t>=this.states.length)throw"Invalid state number.";const n=this.states[t];let i=this.nextTokens(n);if(!i.contains(r.EPSILON))return i;const o=new s;for(o.addSet(i),o.removeOne(r.EPSILON);null!==e&&e.invokingState>=0&&i.contains(r.EPSILON);){const t=this.states[e.invokingState].transitions[0];i=this.nextTokens(t.followState),o.addSet(i),o.removeOne(r.EPSILON),e=e.parentCtx}return i.contains(r.EPSILON)&&o.addOne(r.EOF),o}}o.INVALID_ALT_NUMBER=0,t.exports=o},3961:(t,e,n)=>{const{DecisionState:i}=n(290),{SemanticContext:s}=n(660),{Hash:r}=n(7785);function o(t,e){if(null===t){const t={state:null,alt:null,context:null,semanticContext:null};return e&&(t.reachesIntoOuterContext=0),t}{const n={};return n.state=t.state||null,n.alt=void 0===t.alt?null:t.alt,n.context=t.context||null,n.semanticContext=t.semanticContext||null,e&&(n.reachesIntoOuterContext=t.reachesIntoOuterContext||0,n.precedenceFilterSuppressed=t.precedenceFilterSuppressed||!1),n}}class a{constructor(t,e){this.checkContext(t,e),t=o(t),e=o(e,!0),this.state=null!==t.state?t.state:e.state,this.alt=null!==t.alt?t.alt:e.alt,this.context=null!==t.context?t.context:e.context,this.semanticContext=null!==t.semanticContext?t.semanticContext:null!==e.semanticContext?e.semanticContext:s.NONE,this.reachesIntoOuterContext=e.reachesIntoOuterContext,this.precedenceFilterSuppressed=e.precedenceFilterSuppressed}checkContext(t,e){null!==t.context&&void 0!==t.context||null!==e&&null!==e.context&&void 0!==e.context||(this.context=null)}hashCode(){const t=new r;return this.updateHashCode(t),t.finish()}updateHashCode(t){t.update(this.state.stateNumber,this.alt,this.context,this.semanticContext)}equals(t){return this===t||t instanceof a&&this.state.stateNumber===t.state.stateNumber&&this.alt===t.alt&&(null===this.context?null===t.context:this.context.equals(t.context))&&this.semanticContext.equals(t.semanticContext)&&this.precedenceFilterSuppressed===t.precedenceFilterSuppressed}hashCodeForConfigSet(){const t=new r;return t.update(this.state.stateNumber,this.alt,this.semanticContext),t.finish()}equalsForConfigSet(t){return this===t||t instanceof a&&this.state.stateNumber===t.state.stateNumber&&this.alt===t.alt&&this.semanticContext.equals(t.semanticContext)}toString(){return"("+this.state+","+this.alt+(null!==this.context?",["+this.context.toString()+"]":"")+(this.semanticContext!==s.NONE?","+this.semanticContext.toString():"")+(this.reachesIntoOuterContext>0?",up="+this.reachesIntoOuterContext:"")+")"}}class l extends a{constructor(t,e){super(t,e);const n=t.lexerActionExecutor||null;return this.lexerActionExecutor=n||(null!==e?e.lexerActionExecutor:null),this.passedThroughNonGreedyDecision=null!==e&&this.checkNonGreedyDecision(e,this.state),this.hashCodeForConfigSet=l.prototype.hashCode,this.equalsForConfigSet=l.prototype.equals,this}updateHashCode(t){t.update(this.state.stateNumber,this.alt,this.context,this.semanticContext,this.passedThroughNonGreedyDecision,this.lexerActionExecutor)}equals(t){return this===t||t instanceof l&&this.passedThroughNonGreedyDecision===t.passedThroughNonGreedyDecision&&(this.lexerActionExecutor?this.lexerActionExecutor.equals(t.lexerActionExecutor):!t.lexerActionExecutor)&&super.equals(t)}checkNonGreedyDecision(t,e){return t.passedThroughNonGreedyDecision||e instanceof i&&e.nonGreedy}}t.exports.ATNConfig=a,t.exports.LexerATNConfig=l},7021:(t,e,n)=>{const i=n(8641),s=n(7785),{SemanticContext:r}=n(660),{merge:o}=n(2259);function a(t){return t.hashCodeForConfigSet()}function l(t,e){return t===e||null!==t&&null!==e&&t.equalsForConfigSet(e)}class h{constructor(t){this.configLookup=new s.Set(a,l),this.fullCtx=void 0===t||t,this.readOnly=!1,this.configs=[],this.uniqueAlt=0,this.conflictingAlts=null,this.hasSemanticContext=!1,this.dipsIntoOuterContext=!1,this.cachedHashCode=-1}add(t,e){if(void 0===e&&(e=null),this.readOnly)throw"This set is readonly";t.semanticContext!==r.NONE&&(this.hasSemanticContext=!0),t.reachesIntoOuterContext>0&&(this.dipsIntoOuterContext=!0);const n=this.configLookup.add(t);if(n===t)return this.cachedHashCode=-1,this.configs.push(t),!0;const i=!this.fullCtx,s=o(n.context,t.context,i,e);return n.reachesIntoOuterContext=Math.max(n.reachesIntoOuterContext,t.reachesIntoOuterContext),t.precedenceFilterSuppressed&&(n.precedenceFilterSuppressed=!0),n.context=s,!0}getStates(){const t=new s.Set;for(let e=0;e<this.configs.length;e++)t.add(this.configs[e].state);return t}getPredicates(){const t=[];for(let e=0;e<this.configs.length;e++){const n=this.configs[e].semanticContext;n!==r.NONE&&t.push(n.semanticContext)}return t}optimizeConfigs(t){if(this.readOnly)throw"This set is readonly";if(0!==this.configLookup.length)for(let e=0;e<this.configs.length;e++){const n=this.configs[e];n.context=t.getCachedContext(n.context)}}addAll(t){for(let e=0;e<t.length;e++)this.add(t[e]);return!1}equals(t){return this===t||t instanceof h&&s.equalArrays(this.configs,t.configs)&&this.fullCtx===t.fullCtx&&this.uniqueAlt===t.uniqueAlt&&this.conflictingAlts===t.conflictingAlts&&this.hasSemanticContext===t.hasSemanticContext&&this.dipsIntoOuterContext===t.dipsIntoOuterContext}hashCode(){const t=new s.Hash;return t.update(this.configs),t.finish()}updateHashCode(t){this.readOnly?(-1===this.cachedHashCode&&(this.cachedHashCode=this.hashCode()),t.update(this.cachedHashCode)):t.update(this.hashCode())}isEmpty(){return 0===this.configs.length}contains(t){if(null===this.configLookup)throw"This method is not implemented for readonly sets.";return this.configLookup.contains(t)}containsFast(t){if(null===this.configLookup)throw"This method is not implemented for readonly sets.";return this.configLookup.containsFast(t)}clear(){if(this.readOnly)throw"This set is readonly";this.configs=[],this.cachedHashCode=-1,this.configLookup=new s.Set}setReadonly(t){this.readOnly=t,t&&(this.configLookup=null)}toString(){return s.arrayToString(this.configs)+(this.hasSemanticContext?",hasSemanticContext="+this.hasSemanticContext:"")+(this.uniqueAlt!==i.INVALID_ALT_NUMBER?",uniqueAlt="+this.uniqueAlt:"")+(null!==this.conflictingAlts?",conflictingAlts="+this.conflictingAlts:"")+(this.dipsIntoOuterContext?",dipsIntoOuterContext":"")}get items(){return this.configs}get length(){return this.configs.length}}t.exports={ATNConfigSet:h,OrderedATNConfigSet:class extends h{constructor(){super(),this.configLookup=new s.Set}}}},8962:t=>{class e{constructor(t){void 0===t&&(t=null),this.readOnly=!1,this.verifyATN=null===t||t.verifyATN,this.generateRuleBypassTransitions=null!==t&&t.generateRuleBypassTransitions}}e.defaultOptions=new e,e.defaultOptions.readOnly=!0,t.exports=e},3369:(t,e,n)=>{const{Token:i}=n(5994),s=n(8641),r=n(8456),{ATNState:o,BasicState:a,DecisionState:l,BlockStartState:h,BlockEndState:u,LoopEndState:c,RuleStartState:d,RuleStopState:p,TokensStartState:g,PlusLoopbackState:f,StarLoopbackState:m,StarLoopEntryState:x,PlusBlockStartState:E,StarBlockStartState:S,BasicBlockStartState:T}=n(290),{Transition:_,AtomTransition:v,SetTransition:A,NotSetTransition:N,RuleTransition:y,RangeTransition:C,ActionTransition:M,EpsilonTransition:L,WildcardTransition:w,PredicateTransition:R,PrecedencePredicateTransition:k}=n(2068),{IntervalSet:I}=n(8909),D=n(8962),{LexerActionType:b,LexerSkipAction:O,LexerChannelAction:P,LexerCustomAction:F,LexerMoreAction:U,LexerTypeAction:z,LexerPushModeAction:B,LexerPopModeAction:H,LexerModeAction:G}=n(9294),V="59627784-3BE5-417A-B9EB-8131A7286089",X=["AADB8D7E-AEEF-4415-AD2B-8204D6CF042E",V];function $(t,e){const n=[];return n[t-1]=e,n.map((function(t){return e}))}const Y=function(){const t=[];for(let e=0;e<256;e++)t[e]=(e+256).toString(16).substr(1).toUpperCase();return t}();t.exports=class{constructor(t){null==t&&(t=D.defaultOptions),this.deserializationOptions=t,this.stateFactories=null,this.actionFactories=null}isFeatureSupported(t,e){const n=X.indexOf(t);return!(n<0)&&X.indexOf(e)>=n}deserialize(t){this.reset(t),this.checkVersion(),this.checkUUID();const e=this.readATN();this.readStates(e),this.readRules(e),this.readModes(e);const n=[];return this.readSets(e,n,this.readInt.bind(this)),this.isFeatureSupported(V,this.uuid)&&this.readSets(e,n,this.readInt32.bind(this)),this.readEdges(e,n),this.readDecisions(e),this.readLexerActions(e),this.markPrecedenceDecisions(e),this.verifyATN(e),this.deserializationOptions.generateRuleBypassTransitions&&e.grammarType===r.PARSER&&(this.generateRuleBypassTransitions(e),this.verifyATN(e)),e}reset(t){const e=t.split("").map((function(t){const e=t.charCodeAt(0);return e>1?e-2:e+65534}));e[0]=t.charCodeAt(0),this.data=e,this.pos=0}checkVersion(){const t=this.readInt();if(3!==t)throw"Could not deserialize ATN with version "+t+" (expected 3)."}checkUUID(){const t=this.readUUID();if(X.indexOf(t)<0)throw"59627784-3BE5-417A-B9EB-8131A7286089";this.uuid=t}readATN(){const t=this.readInt(),e=this.readInt();return new s(t,e)}readStates(t){let e,n,i;const s=[],r=[],a=this.readInt();for(let e=0;e<a;e++){const e=this.readInt();if(e===o.INVALID_TYPE){t.addState(null);continue}let n=this.readInt();65535===n&&(n=-1);const i=this.stateFactory(e,n);if(e===o.LOOP_END){const t=this.readInt();s.push([i,t])}else if(i instanceof h){const t=this.readInt();r.push([i,t])}t.addState(i)}for(e=0;e<s.length;e++)n=s[e],n[0].loopBackState=t.states[n[1]];for(e=0;e<r.length;e++)n=r[e],n[0].endState=t.states[n[1]];let l=this.readInt();for(e=0;e<l;e++)i=this.readInt(),t.states[i].nonGreedy=!0;let u=this.readInt();for(e=0;e<u;e++)i=this.readInt(),t.states[i].isPrecedenceRule=!0}readRules(t){let e;const n=this.readInt();for(t.grammarType===r.LEXER&&(t.ruleToTokenType=$(n,0)),t.ruleToStartState=$(n,0),e=0;e<n;e++){const n=this.readInt();if(t.ruleToStartState[e]=t.states[n],t.grammarType===r.LEXER){let n=this.readInt();65535===n&&(n=i.EOF),t.ruleToTokenType[e]=n}}for(t.ruleToStopState=$(n,0),e=0;e<t.states.length;e++){const n=t.states[e];n instanceof p&&(t.ruleToStopState[n.ruleIndex]=n,t.ruleToStartState[n.ruleIndex].stopState=n)}}readModes(t){const e=this.readInt();for(let n=0;n<e;n++){let e=this.readInt();t.modeToStartState.push(t.states[e])}}readSets(t,e,n){const i=this.readInt();for(let t=0;t<i;t++){const t=new I;e.push(t);const i=this.readInt();0!==this.readInt()&&t.addOne(-1);for(let e=0;e<i;e++){const e=n(),i=n();t.addRange(e,i)}}}readEdges(t,e){let n,i,s,r,o;const a=this.readInt();for(n=0;n<a;n++){const n=this.readInt(),i=this.readInt(),s=this.readInt(),o=this.readInt(),a=this.readInt(),l=this.readInt();r=this.edgeFactory(t,s,n,i,o,a,l,e),t.states[n].addTransition(r)}for(n=0;n<t.states.length;n++)for(s=t.states[n],i=0;i<s.transitions.length;i++){const e=s.transitions[i];if(!(e instanceof y))continue;let n=-1;t.ruleToStartState[e.target.ruleIndex].isPrecedenceRule&&0===e.precedence&&(n=e.target.ruleIndex),r=new L(e.followState,n),t.ruleToStopState[e.target.ruleIndex].addTransition(r)}for(n=0;n<t.states.length;n++){if(s=t.states[n],s instanceof h){if(null===s.endState)throw"IllegalState";if(null!==s.endState.startState)throw"IllegalState";s.endState.startState=s}if(s instanceof f)for(i=0;i<s.transitions.length;i++)o=s.transitions[i].target,o instanceof E&&(o.loopBackState=s);else if(s instanceof m)for(i=0;i<s.transitions.length;i++)o=s.transitions[i].target,o instanceof x&&(o.loopBackState=s)}}readDecisions(t){const e=this.readInt();for(let n=0;n<e;n++){const e=this.readInt(),i=t.states[e];t.decisionToState.push(i),i.decision=n}}readLexerActions(t){if(t.grammarType===r.LEXER){const e=this.readInt();t.lexerActions=$(e,null);for(let n=0;n<e;n++){const e=this.readInt();let i=this.readInt();65535===i&&(i=-1);let s=this.readInt();65535===s&&(s=-1),t.lexerActions[n]=this.lexerActionFactory(e,i,s)}}}generateRuleBypassTransitions(t){let e;const n=t.ruleToStartState.length;for(e=0;e<n;e++)t.ruleToTokenType[e]=t.maxTokenType+e+1;for(e=0;e<n;e++)this.generateRuleBypassTransition(t,e)}generateRuleBypassTransition(t,e){let n,i;const s=new T;s.ruleIndex=e,t.addState(s);const r=new u;r.ruleIndex=e,t.addState(r),s.endState=r,t.defineDecisionState(s),r.startState=s;let o=null,l=null;if(t.ruleToStartState[e].isPrecedenceRule){for(l=null,n=0;n<t.states.length;n++)if(i=t.states[n],this.stateIsEndStateFor(i,e)){l=i,o=i.loopBackState.transitions[0];break}if(null===o)throw"Couldn't identify final state of the precedence rule prefix section."}else l=t.ruleToStopState[e];for(n=0;n<t.states.length;n++){i=t.states[n];for(let t=0;t<i.transitions.length;t++){const e=i.transitions[t];e!==o&&e.target===l&&(e.target=r)}}const h=t.ruleToStartState[e],c=h.transitions.length;for(;c>0;)s.addTransition(h.transitions[c-1]),h.transitions=h.transitions.slice(-1);t.ruleToStartState[e].addTransition(new L(s)),r.addTransition(new L(l));const d=new a;t.addState(d),d.addTransition(new v(r,t.ruleToTokenType[e])),s.addTransition(new L(d))}stateIsEndStateFor(t,e){if(t.ruleIndex!==e)return null;if(!(t instanceof x))return null;const n=t.transitions[t.transitions.length-1].target;return n instanceof c&&n.epsilonOnlyTransitions&&n.transitions[0].target instanceof p?t:null}markPrecedenceDecisions(t){for(let e=0;e<t.states.length;e++){const n=t.states[e];if(n instanceof x&&t.ruleToStartState[n.ruleIndex].isPrecedenceRule){const t=n.transitions[n.transitions.length-1].target;t instanceof c&&t.epsilonOnlyTransitions&&t.transitions[0].target instanceof p&&(n.isPrecedenceDecision=!0)}}}verifyATN(t){if(this.deserializationOptions.verifyATN)for(let e=0;e<t.states.length;e++){const n=t.states[e];if(null!==n)if(this.checkCondition(n.epsilonOnlyTransitions||n.transitions.length<=1),n instanceof E)this.checkCondition(null!==n.loopBackState);else if(n instanceof x)if(this.checkCondition(null!==n.loopBackState),this.checkCondition(2===n.transitions.length),n.transitions[0].target instanceof S)this.checkCondition(n.transitions[1].target instanceof c),this.checkCondition(!n.nonGreedy);else{if(!(n.transitions[0].target instanceof c))throw"IllegalState";this.checkCondition(n.transitions[1].target instanceof S),this.checkCondition(n.nonGreedy)}else n instanceof m?(this.checkCondition(1===n.transitions.length),this.checkCondition(n.transitions[0].target instanceof x)):n instanceof c?this.checkCondition(null!==n.loopBackState):n instanceof d?this.checkCondition(null!==n.stopState):n instanceof h?this.checkCondition(null!==n.endState):n instanceof u?this.checkCondition(null!==n.startState):n instanceof l?this.checkCondition(n.transitions.length<=1||n.decision>=0):this.checkCondition(n.transitions.length<=1||n instanceof p)}}checkCondition(t,e){if(!t)throw null==e&&(e="IllegalState"),e}readInt(){return this.data[this.pos++]}readInt32(){return this.readInt()|this.readInt()<<16}readLong(){return 4294967295&this.readInt32()|this.readInt32()<<32}readUUID(){const t=[];for(let e=7;e>=0;e--){const n=this.readInt();t[2*e+1]=255&n,t[2*e]=n>>8&255}return Y[t[0]]+Y[t[1]]+Y[t[2]]+Y[t[3]]+"-"+Y[t[4]]+Y[t[5]]+"-"+Y[t[6]]+Y[t[7]]+"-"+Y[t[8]]+Y[t[9]]+"-"+Y[t[10]]+Y[t[11]]+Y[t[12]]+Y[t[13]]+Y[t[14]]+Y[t[15]]}edgeFactory(t,e,n,s,r,o,a,l){const h=t.states[s];switch(e){case _.EPSILON:return new L(h);case _.RANGE:return new C(h,0!==a?i.EOF:r,o);case _.RULE:return new y(t.states[r],o,a,h);case _.PREDICATE:return new R(h,r,o,0!==a);case _.PRECEDENCE:return new k(h,r);case _.ATOM:return new v(h,0!==a?i.EOF:r);case _.ACTION:return new M(h,r,o,0!==a);case _.SET:return new A(h,l[r]);case _.NOT_SET:return new N(h,l[r]);case _.WILDCARD:return new w(h);default:throw"The specified transition type: "+e+" is not valid."}}stateFactory(t,e){if(null===this.stateFactories){const t=[];t[o.INVALID_TYPE]=null,t[o.BASIC]=()=>new a,t[o.RULE_START]=()=>new d,t[o.BLOCK_START]=()=>new T,t[o.PLUS_BLOCK_START]=()=>new E,t[o.STAR_BLOCK_START]=()=>new S,t[o.TOKEN_START]=()=>new g,t[o.RULE_STOP]=()=>new p,t[o.BLOCK_END]=()=>new u,t[o.STAR_LOOP_BACK]=()=>new m,t[o.STAR_LOOP_ENTRY]=()=>new x,t[o.PLUS_LOOP_BACK]=()=>new f,t[o.LOOP_END]=()=>new c,this.stateFactories=t}if(t>this.stateFactories.length||null===this.stateFactories[t])throw"The specified state type "+t+" is not valid.";{const n=this.stateFactories[t]();if(null!==n)return n.ruleIndex=e,n}}lexerActionFactory(t,e,n){if(null===this.actionFactories){const t=[];t[b.CHANNEL]=(t,e)=>new P(t),t[b.CUSTOM]=(t,e)=>new F(t,e),t[b.MODE]=(t,e)=>new G(t),t[b.MORE]=(t,e)=>U.INSTANCE,t[b.POP_MODE]=(t,e)=>H.INSTANCE,t[b.PUSH_MODE]=(t,e)=>new B(t),t[b.SKIP]=(t,e)=>O.INSTANCE,t[b.TYPE]=(t,e)=>new z(t),this.actionFactories=t}if(t>this.actionFactories.length||null===this.actionFactories[t])throw"The specified lexer action type "+t+" is not valid.";return this.actionFactories[t](e,n)}}},6380:(t,e,n)=>{const{DFAState:i}=n(6254),{ATNConfigSet:s}=n(7021),{getCachedPredictionContext:r}=n(2259),{Map:o}=n(7785);class a{constructor(t,e){return this.atn=t,this.sharedContextCache=e,this}getCachedContext(t){if(null===this.sharedContextCache)return t;const e=new o;return r(t,this.sharedContextCache,e)}}a.ERROR=new i(2147483647,new s),t.exports=a},290:t=>{class e{constructor(){this.atn=null,this.stateNumber=e.INVALID_STATE_NUMBER,this.stateType=null,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.nextTokenWithinRule=null}toString(){return this.stateNumber}equals(t){return t instanceof e&&this.stateNumber===t.stateNumber}isNonGreedyExitState(){return!1}addTransition(t,e){void 0===e&&(e=-1),0===this.transitions.length?this.epsilonOnlyTransitions=t.isEpsilon:this.epsilonOnlyTransitions!==t.isEpsilon&&(this.epsilonOnlyTransitions=!1),-1===e?this.transitions.push(t):this.transitions.splice(e,1,t)}}e.INVALID_TYPE=0,e.BASIC=1,e.RULE_START=2,e.BLOCK_START=3,e.PLUS_BLOCK_START=4,e.STAR_BLOCK_START=5,e.TOKEN_START=6,e.RULE_STOP=7,e.BLOCK_END=8,e.STAR_LOOP_BACK=9,e.STAR_LOOP_ENTRY=10,e.PLUS_LOOP_BACK=11,e.LOOP_END=12,e.serializationNames=["INVALID","BASIC","RULE_START","BLOCK_START","PLUS_BLOCK_START","STAR_BLOCK_START","TOKEN_START","RULE_STOP","BLOCK_END","STAR_LOOP_BACK","STAR_LOOP_ENTRY","PLUS_LOOP_BACK","LOOP_END"],e.INVALID_STATE_NUMBER=-1;class n extends e{constructor(){return super(),this.decision=-1,this.nonGreedy=!1,this}}class i extends n{constructor(){return super(),this.endState=null,this}}t.exports={ATNState:e,BasicState:class extends e{constructor(){super(),this.stateType=e.BASIC}},DecisionState:n,BlockStartState:i,BlockEndState:class extends e{constructor(){return super(),this.stateType=e.BLOCK_END,this.startState=null,this}},LoopEndState:class extends e{constructor(){return super(),this.stateType=e.LOOP_END,this.loopBackState=null,this}},RuleStartState:class extends e{constructor(){return super(),this.stateType=e.RULE_START,this.stopState=null,this.isPrecedenceRule=!1,this}},RuleStopState:class extends e{constructor(){return super(),this.stateType=e.RULE_STOP,this}},TokensStartState:class extends n{constructor(){return super(),this.stateType=e.TOKEN_START,this}},PlusLoopbackState:class extends n{constructor(){return super(),this.stateType=e.PLUS_LOOP_BACK,this}},StarLoopbackState:class extends e{constructor(){return super(),this.stateType=e.STAR_LOOP_BACK,this}},StarLoopEntryState:class extends n{constructor(){return super(),this.stateType=e.STAR_LOOP_ENTRY,this.loopBackState=null,this.isPrecedenceDecision=null,this}},PlusBlockStartState:class extends i{constructor(){return super(),this.stateType=e.PLUS_BLOCK_START,this.loopBackState=null,this}},StarBlockStartState:class extends i{constructor(){return super(),this.stateType=e.STAR_BLOCK_START,this}},BasicBlockStartState:class extends i{constructor(){return super(),this.stateType=e.BLOCK_START,this}}}},8456:t=>{t.exports={LEXER:0,PARSER:1}},7205:(t,e,n)=>{const{Token:i}=n(5994),s=n(4126),r=n(8641),o=n(6380),{DFAState:a}=n(6254),{OrderedATNConfigSet:l}=n(7021),{PredictionContext:h}=n(2259),{SingletonPredictionContext:u}=n(2259),{RuleStopState:c}=n(290),{LexerATNConfig:d}=n(3961),{Transition:p}=n(2068),g=n(7366),{LexerNoViableAltException:f}=n(3337);function m(t){t.index=-1,t.line=0,t.column=-1,t.dfaState=null}class x{constructor(){m(this)}reset(){m(this)}}class E extends o{constructor(t,e,n,i){super(e,i),this.decisionToDFA=n,this.recog=t,this.startIndex=-1,this.line=1,this.column=0,this.mode=s.DEFAULT_MODE,this.prevAccept=new x}copyState(t){this.column=t.column,this.line=t.line,this.mode=t.mode,this.startIndex=t.startIndex}match(t,e){this.match_calls+=1,this.mode=e;const n=t.mark();try{this.startIndex=t.index,this.prevAccept.reset();const i=this.decisionToDFA[e];return null===i.s0?this.matchATN(t):this.execATN(t,i.s0)}finally{t.release(n)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this.line=1,this.column=0,this.mode=s.DEFAULT_MODE}matchATN(t){const e=this.atn.modeToStartState[this.mode];E.debug&&console.log("matchATN mode "+this.mode+" start: "+e);const n=this.mode,i=this.computeStartState(t,e),s=i.hasSemanticContext;i.hasSemanticContext=!1;const r=this.addDFAState(i);s||(this.decisionToDFA[this.mode].s0=r);const o=this.execATN(t,r);return E.debug&&console.log("DFA after matchATN: "+this.decisionToDFA[n].toLexerString()),o}execATN(t,e){E.debug&&console.log("start state closure="+e.configs),e.isAcceptState&&this.captureSimState(this.prevAccept,t,e);let n=t.LA(1),s=e;for(;;){E.debug&&console.log("execATN loop starting closure: "+s.configs);let e=this.getExistingTargetState(s,n);if(null===e&&(e=this.computeTargetState(t,s,n)),e===o.ERROR)break;if(n!==i.EOF&&this.consume(t),e.isAcceptState&&(this.captureSimState(this.prevAccept,t,e),n===i.EOF))break;n=t.LA(1),s=e}return this.failOrAccept(this.prevAccept,t,s.configs,n)}getExistingTargetState(t,e){if(null===t.edges||e<E.MIN_DFA_EDGE||e>E.MAX_DFA_EDGE)return null;let n=t.edges[e-E.MIN_DFA_EDGE];return void 0===n&&(n=null),E.debug&&null!==n&&console.log("reuse state "+t.stateNumber+" edge to "+n.stateNumber),n}computeTargetState(t,e,n){const i=new l;return this.getReachableConfigSet(t,e.configs,i,n),0===i.items.length?(i.hasSemanticContext||this.addDFAEdge(e,n,o.ERROR),o.ERROR):this.addDFAEdge(e,n,null,i)}failOrAccept(t,e,n,s){if(null!==this.prevAccept.dfaState){const n=t.dfaState.lexerActionExecutor;return this.accept(e,n,this.startIndex,t.index,t.line,t.column),t.dfaState.prediction}if(s===i.EOF&&e.index===this.startIndex)return i.EOF;throw new f(this.recog,e,this.startIndex,n)}getReachableConfigSet(t,e,n,s){let o=r.INVALID_ALT_NUMBER;for(let r=0;r<e.items.length;r++){const a=e.items[r],l=a.alt===o;if(!l||!a.passedThroughNonGreedyDecision){E.debug&&console.log("testing %s at %s\n",this.getTokenName(s),a.toString(this.recog,!0));for(let e=0;e<a.state.transitions.length;e++){const r=a.state.transitions[e],h=this.getReachableTarget(r,s);if(null!==h){let e=a.lexerActionExecutor;null!==e&&(e=e.fixOffsetBeforeMatch(t.index-this.startIndex));const r=s===i.EOF,u=new d({state:h,lexerActionExecutor:e},a);this.closure(t,u,n,l,!0,r)&&(o=a.alt)}}}}}accept(t,e,n,i,s,r){E.debug&&console.log("ACTION %s\n",e),t.seek(i),this.line=s,this.column=r,null!==e&&null!==this.recog&&e.execute(this.recog,t,n)}getReachableTarget(t,e){return t.matches(e,0,s.MAX_CHAR_VALUE)?t.target:null}computeStartState(t,e){const n=h.EMPTY,i=new l;for(let s=0;s<e.transitions.length;s++){const r=e.transitions[s].target,o=new d({state:r,alt:s+1,context:n},null);this.closure(t,o,i,!1,!1,!1)}return i}closure(t,e,n,i,s,r){let o=null;if(E.debug&&console.log("closure("+e.toString(this.recog,!0)+")"),e.state instanceof c){if(E.debug&&(null!==this.recog?console.log("closure at %s rule stop %s\n",this.recog.ruleNames[e.state.ruleIndex],e):console.log("closure at rule stop %s\n",e)),null===e.context||e.context.hasEmptyPath()){if(null===e.context||e.context.isEmpty())return n.add(e),!0;n.add(new d({state:e.state,context:h.EMPTY},e)),i=!0}if(null!==e.context&&!e.context.isEmpty())for(let a=0;a<e.context.length;a++)if(e.context.getReturnState(a)!==h.EMPTY_RETURN_STATE){const l=e.context.getParent(a),h=this.atn.states[e.context.getReturnState(a)];o=new d({state:h,context:l},e),i=this.closure(t,o,n,i,s,r)}return i}e.state.epsilonOnlyTransitions||i&&e.passedThroughNonGreedyDecision||n.add(e);for(let a=0;a<e.state.transitions.length;a++){const l=e.state.transitions[a];o=this.getEpsilonTarget(t,e,l,n,s,r),null!==o&&(i=this.closure(t,o,n,i,s,r))}return i}getEpsilonTarget(t,e,n,r,o,a){let l=null;if(n.serializationType===p.RULE){const t=u.create(e.context,n.followState.stateNumber);l=new d({state:n.target,context:t},e)}else{if(n.serializationType===p.PRECEDENCE)throw"Precedence predicates are not supported in lexers.";if(n.serializationType===p.PREDICATE)E.debug&&console.log("EVAL rule "+n.ruleIndex+":"+n.predIndex),r.hasSemanticContext=!0,this.evaluatePredicate(t,n.ruleIndex,n.predIndex,o)&&(l=new d({state:n.target},e));else if(n.serializationType===p.ACTION)if(null===e.context||e.context.hasEmptyPath()){const t=g.append(e.lexerActionExecutor,this.atn.lexerActions[n.actionIndex]);l=new d({state:n.target,lexerActionExecutor:t},e)}else l=new d({state:n.target},e);else n.serializationType===p.EPSILON?l=new d({state:n.target},e):n.serializationType!==p.ATOM&&n.serializationType!==p.RANGE&&n.serializationType!==p.SET||a&&n.matches(i.EOF,0,s.MAX_CHAR_VALUE)&&(l=new d({state:n.target},e))}return l}evaluatePredicate(t,e,n,i){if(null===this.recog)return!0;if(!i)return this.recog.sempred(null,e,n);const s=this.column,r=this.line,o=t.index,a=t.mark();try{return this.consume(t),this.recog.sempred(null,e,n)}finally{this.column=s,this.line=r,t.seek(o),t.release(a)}}captureSimState(t,e,n){t.index=e.index,t.line=this.line,t.column=this.column,t.dfaState=n}addDFAEdge(t,e,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),null===n&&null!==i){const t=i.hasSemanticContext;if(i.hasSemanticContext=!1,n=this.addDFAState(i),t)return n}return e<E.MIN_DFA_EDGE||e>E.MAX_DFA_EDGE||(E.debug&&console.log("EDGE "+t+" -> "+n+" upon "+e),null===t.edges&&(t.edges=[]),t.edges[e-E.MIN_DFA_EDGE]=n),n}addDFAState(t){const e=new a(null,t);let n=null;for(let e=0;e<t.items.length;e++){const i=t.items[e];if(i.state instanceof c){n=i;break}}null!==n&&(e.isAcceptState=!0,e.lexerActionExecutor=n.lexerActionExecutor,e.prediction=this.atn.ruleToTokenType[n.state.ruleIndex]);const i=this.decisionToDFA[this.mode],s=i.states.get(e);if(null!==s)return s;const r=e;return r.stateNumber=i.states.length,t.setReadonly(!0),r.configs=t,i.states.add(r),r}getDFA(t){return this.decisionToDFA[t]}getText(t){return t.getText(this.startIndex,t.index-1)}consume(t){t.LA(1)==="\n".charCodeAt(0)?(this.line+=1,this.column=0):this.column+=1,t.consume()}getTokenName(t){return-1===t?"EOF":"'"+String.fromCharCode(t)+"'"}}E.debug=!1,E.dfa_debug=!1,E.MIN_DFA_EDGE=0,E.MAX_DFA_EDGE=127,E.match_calls=0,t.exports=E},9294:t=>{const e={CHANNEL:0,CUSTOM:1,MODE:2,MORE:3,POP_MODE:4,PUSH_MODE:5,SKIP:6,TYPE:7};class n{constructor(t){this.actionType=t,this.isPositionDependent=!1}hashCode(){const t=new Hash;return this.updateHashCode(t),t.finish()}updateHashCode(t){t.update(this.actionType)}equals(t){return this===t}}class i extends n{constructor(){super(e.SKIP)}execute(t){t.skip()}toString(){return"skip"}}i.INSTANCE=new i;class s extends n{constructor(t){super(e.TYPE),this.type=t}execute(t){t.type=this.type}updateHashCode(t){t.update(this.actionType,this.type)}equals(t){return this===t||t instanceof s&&this.type===t.type}toString(){return"type("+this.type+")"}}class r extends n{constructor(t){super(e.PUSH_MODE),this.mode=t}execute(t){t.pushMode(this.mode)}updateHashCode(t){t.update(this.actionType,this.mode)}equals(t){return this===t||t instanceof r&&this.mode===t.mode}toString(){return"pushMode("+this.mode+")"}}class o extends n{constructor(){super(e.POP_MODE)}execute(t){t.popMode()}toString(){return"popMode"}}o.INSTANCE=new o;class a extends n{constructor(){super(e.MORE)}execute(t){t.more()}toString(){return"more"}}a.INSTANCE=new a;class l extends n{constructor(t){super(e.MODE),this.mode=t}execute(t){t.mode(this.mode)}updateHashCode(t){t.update(this.actionType,this.mode)}equals(t){return this===t||t instanceof l&&this.mode===t.mode}toString(){return"mode("+this.mode+")"}}class h extends n{constructor(t,n){super(e.CUSTOM),this.ruleIndex=t,this.actionIndex=n,this.isPositionDependent=!0}execute(t){t.action(null,this.ruleIndex,this.actionIndex)}updateHashCode(t){t.update(this.actionType,this.ruleIndex,this.actionIndex)}equals(t){return this===t||t instanceof h&&this.ruleIndex===t.ruleIndex&&this.actionIndex===t.actionIndex}}class u extends n{constructor(t){super(e.CHANNEL),this.channel=t}execute(t){t._channel=this.channel}updateHashCode(t){t.update(this.actionType,this.channel)}equals(t){return this===t||t instanceof u&&this.channel===t.channel}toString(){return"channel("+this.channel+")"}}class c extends n{constructor(t,e){super(e.actionType),this.offset=t,this.action=e,this.isPositionDependent=!0}execute(t){this.action.execute(t)}updateHashCode(t){t.update(this.actionType,this.offset,this.action)}equals(t){return this===t||t instanceof c&&this.offset===t.offset&&this.action===t.action}}t.exports={LexerActionType:e,LexerSkipAction:i,LexerChannelAction:u,LexerCustomAction:h,LexerIndexedCustomAction:c,LexerMoreAction:a,LexerTypeAction:s,LexerPushModeAction:r,LexerPopModeAction:o,LexerModeAction:l}},7366:(t,e,n)=>{const{hashStuff:i}=n(7785),{LexerIndexedCustomAction:s}=n(9294);class r{constructor(t){return this.lexerActions=null===t?[]:t,this.cachedHashCode=i(t),this}fixOffsetBeforeMatch(t){let e=null;for(let n=0;n<this.lexerActions.length;n++)!this.lexerActions[n].isPositionDependent||this.lexerActions[n]instanceof s||(null===e&&(e=this.lexerActions.concat([])),e[n]=new s(t,this.lexerActions[n]));return null===e?this:new r(e)}execute(t,e,n){let i=!1;const r=e.index;try{for(let o=0;o<this.lexerActions.length;o++){let a=this.lexerActions[o];if(a instanceof s){const t=a.offset;e.seek(n+t),a=a.action,i=n+t!==r}else a.isPositionDependent&&(e.seek(r),i=!1);a.execute(t)}}finally{i&&e.seek(r)}}hashCode(){return this.cachedHashCode}updateHashCode(t){t.update(this.cachedHashCode)}equals(t){if(this===t)return!0;if(t instanceof r){if(this.cachedHashCode!=t.cachedHashCode)return!1;if(this.lexerActions.length!=t.lexerActions.length)return!1;{const e=this.lexerActions.length;for(let n=0;n<e;++n)if(!this.lexerActions[n].equals(t.lexerActions[n]))return!1;return!0}}return!1}static append(t,e){if(null===t)return new r([e]);const n=t.lexerActions.concat([e]);return new r(n)}}t.exports=r},2355:(t,e,n)=>{const i=n(7785),{Set:s,BitSet:r,DoubleDict:o}=i,a=n(8641),{ATNState:l,RuleStopState:h}=n(290),{ATNConfig:u}=n(3961),{ATNConfigSet:c}=n(7021),{Token:d}=n(5994),{DFAState:p,PredPrediction:g}=n(6254),f=n(6380),m=n(8505),x=n(5302),{SemanticContext:E}=(n(2449),n(660)),{PredictionContext:S}=n(2259),{Interval:T}=n(8909),{Transition:_,SetTransition:v,NotSetTransition:A,RuleTransition:N,ActionTransition:y}=n(2068),{NoViableAltException:C}=n(3337),{SingletonPredictionContext:M,predictionContextFromRuleContext:L}=n(2259);t.exports=class extends f{constructor(t,e,n,i){super(e,i),this.parser=t,this.decisionToDFA=n,this.predictionMode=m.LL,this._input=null,this._startIndex=0,this._outerContext=null,this._dfa=null,this.mergeCache=null,this.debug=!1,this.debug_closure=!1,this.debug_add=!1,this.debug_list_atn_decisions=!1,this.dfa_debug=!1,this.retry_debug=!1}reset(){}adaptivePredict(t,e,n){(this.debug||this.debug_list_atn_decisions)&&console.log("adaptivePredict decision "+e+" exec LA(1)=="+this.getLookaheadName(t)+" line "+t.LT(1).line+":"+t.LT(1).column),this._input=t,this._startIndex=t.index,this._outerContext=n;const i=this.decisionToDFA[e];this._dfa=i;const s=t.mark(),r=t.index;try{let e;if(e=i.precedenceDfa?i.getPrecedenceStartState(this.parser.getPrecedence()):i.s0,null===e){null===n&&(n=x.EMPTY),(this.debug||this.debug_list_atn_decisions)&&console.log("predictATN decision "+i.decision+" exec LA(1)=="+this.getLookaheadName(t)+", outerContext="+n.toString(this.parser.ruleNames));const s=!1;let r=this.computeStartState(i.atnStartState,x.EMPTY,s);i.precedenceDfa?(i.s0.configs=r,r=this.applyPrecedenceFilter(r),e=this.addDFAState(i,new p(null,r)),i.setPrecedenceStartState(this.parser.getPrecedence(),e)):(e=this.addDFAState(i,new p(null,r)),i.s0=e)}const o=this.execATN(i,e,t,r,n);return this.debug&&console.log("DFA after predictATN: "+i.toString(this.parser.literalNames)),o}finally{this._dfa=null,this.mergeCache=null,t.seek(r),t.release(s)}}execATN(t,e,n,i,s){let r;(this.debug||this.debug_list_atn_decisions)&&console.log("execATN decision "+t.decision+" exec LA(1)=="+this.getLookaheadName(n)+" line "+n.LT(1).line+":"+n.LT(1).column);let o=e;this.debug&&console.log("s0 = "+e);let l=n.LA(1);for(;;){let e=this.getExistingTargetState(o,l);if(null===e&&(e=this.computeTargetState(t,o,l)),e===f.ERROR){const t=this.noViableAlt(n,s,o.configs,i);if(n.seek(i),r=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(o.configs,s),r!==a.INVALID_ALT_NUMBER)return r;throw t}if(e.requiresFullContext&&this.predictionMode!==m.SLL){let o=null;if(null!==e.predicates){this.debug&&console.log("DFA state has preds in DFA sim LL failover");const t=n.index;if(t!==i&&n.seek(i),o=this.evalSemanticContext(e.predicates,s,!0),1===o.length)return this.debug&&console.log("Full LL avoided"),o.minValue();t!==i&&n.seek(t)}this.dfa_debug&&console.log("ctx sensitive state "+s+" in "+e);const a=!0,l=this.computeStartState(t.atnStartState,s,a);return this.reportAttemptingFullContext(t,o,e.configs,i,n.index),r=this.execATNWithFullContext(t,e,l,n,i,s),r}if(e.isAcceptState){if(null===e.predicates)return e.prediction;const r=n.index;n.seek(i);const o=this.evalSemanticContext(e.predicates,s,!0);if(0===o.length)throw this.noViableAlt(n,s,e.configs,i);return 1===o.length||this.reportAmbiguity(t,e,i,r,!1,o,e.configs),o.minValue()}o=e,l!==d.EOF&&(n.consume(),l=n.LA(1))}}getExistingTargetState(t,e){const n=t.edges;return null===n?null:n[e+1]||null}computeTargetState(t,e,n){const s=this.computeReachSet(e.configs,n,!1);if(null===s)return this.addDFAEdge(t,e,n,f.ERROR),f.ERROR;let r=new p(null,s);const o=this.getUniqueAlt(s);if(this.debug){const t=m.getConflictingAltSubsets(s);console.log("SLL altSubSets="+i.arrayToString(t)+", previous="+e.configs+", configs="+s+", predict="+o+", allSubsetsConflict="+m.allSubsetsConflict(t)+", conflictingAlts="+this.getConflictingAlts(s))}return o!==a.INVALID_ALT_NUMBER?(r.isAcceptState=!0,r.configs.uniqueAlt=o,r.prediction=o):m.hasSLLConflictTerminatingPrediction(this.predictionMode,s)&&(r.configs.conflictingAlts=this.getConflictingAlts(s),r.requiresFullContext=!0,r.isAcceptState=!0,r.prediction=r.configs.conflictingAlts.minValue()),r.isAcceptState&&r.configs.hasSemanticContext&&(this.predicateDFAState(r,this.atn.getDecisionState(t.decision)),null!==r.predicates&&(r.prediction=a.INVALID_ALT_NUMBER)),r=this.addDFAEdge(t,e,n,r),r}predicateDFAState(t,e){const n=e.transitions.length,i=this.getConflictingAltsOrUniqueAlt(t.configs),s=this.getPredsForAmbigAlts(i,t.configs,n);null!==s?(t.predicates=this.getPredicatePredictions(i,s),t.prediction=a.INVALID_ALT_NUMBER):t.prediction=i.minValue()}execATNWithFullContext(t,e,n,i,s,r){(this.debug||this.debug_list_atn_decisions)&&console.log("execATNWithFullContext "+n);let o,l=!1,h=n;i.seek(s);let u=i.LA(1),c=-1;for(;;){if(o=this.computeReachSet(h,u,!0),null===o){const t=this.noViableAlt(i,r,h,s);i.seek(s);const e=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(h,r);if(e!==a.INVALID_ALT_NUMBER)return e;throw t}const t=m.getConflictingAltSubsets(o);if(this.debug&&console.log("LL altSubSets="+t+", predict="+m.getUniqueAlt(t)+", resolvesToJustOneViableAlt="+m.resolvesToJustOneViableAlt(t)),o.uniqueAlt=this.getUniqueAlt(o),o.uniqueAlt!==a.INVALID_ALT_NUMBER){c=o.uniqueAlt;break}if(this.predictionMode!==m.LL_EXACT_AMBIG_DETECTION){if(c=m.resolvesToJustOneViableAlt(t),c!==a.INVALID_ALT_NUMBER)break}else if(m.allSubsetsConflict(t)&&m.allSubsetsEqual(t)){l=!0,c=m.getSingleViableAlt(t);break}h=o,u!==d.EOF&&(i.consume(),u=i.LA(1))}return o.uniqueAlt!==a.INVALID_ALT_NUMBER?(this.reportContextSensitivity(t,c,o,s,i.index),c):(this.reportAmbiguity(t,e,s,i.index,l,null,o),c)}computeReachSet(t,e,n){this.debug&&console.log("in computeReachSet, starting closure: "+t),null===this.mergeCache&&(this.mergeCache=new o);const i=new c(n);let r=null;for(let s=0;s<t.items.length;s++){const o=t.items[s];if(this.debug&&console.log("testing "+this.getTokenName(e)+" at "+o),o.state instanceof h)(n||e===d.EOF)&&(null===r&&(r=[]),r.push(o),this.debug_add&&console.log("added "+o+" to skippedStopStates"));else for(let t=0;t<o.state.transitions.length;t++){const n=o.state.transitions[t],s=this.getReachableTarget(n,e);if(null!==s){const t=new u({state:s},o);i.add(t,this.mergeCache),this.debug_add&&console.log("added "+t+" to intermediate")}}}let l=null;if(null===r&&e!==d.EOF&&(1===i.items.length||this.getUniqueAlt(i)!==a.INVALID_ALT_NUMBER)&&(l=i),null===l){l=new c(n);const t=new s,r=e===d.EOF;for(let e=0;e<i.items.length;e++)this.closure(i.items[e],l,t,!1,n,r)}if(e===d.EOF&&(l=this.removeAllConfigsNotInRuleStopState(l,l===i)),!(null===r||n&&m.hasConfigInRuleStopState(l)))for(let t=0;t<r.length;t++)l.add(r[t],this.mergeCache);return 0===l.items.length?null:l}removeAllConfigsNotInRuleStopState(t,e){if(m.allConfigsInRuleStopStates(t))return t;const n=new c(t.fullCtx);for(let i=0;i<t.items.length;i++){const s=t.items[i];if(s.state instanceof h)n.add(s,this.mergeCache);else if(e&&s.state.epsilonOnlyTransitions&&this.atn.nextTokens(s.state).contains(d.EPSILON)){const t=this.atn.ruleToStopState[s.state.ruleIndex];n.add(new u({state:t},s),this.mergeCache)}}return n}computeStartState(t,e,n){const i=L(this.atn,e),r=new c(n);for(let e=0;e<t.transitions.length;e++){const o=t.transitions[e].target,a=new u({state:o,alt:e+1,context:i},null),l=new s;this.closure(a,r,l,!0,n,!1)}return r}applyPrecedenceFilter(t){let e;const n=[],i=new c(t.fullCtx);for(let s=0;s<t.items.length;s++){if(e=t.items[s],1!==e.alt)continue;const r=e.semanticContext.evalPrecedence(this.parser,this._outerContext);null!==r&&(n[e.state.stateNumber]=e.context,r!==e.semanticContext?i.add(new u({semanticContext:r},e),this.mergeCache):i.add(e,this.mergeCache))}for(let s=0;s<t.items.length;s++)if(e=t.items[s],1!==e.alt){if(!e.precedenceFilterSuppressed){const t=n[e.state.stateNumber]||null;if(null!==t&&t.equals(e.context))continue}i.add(e,this.mergeCache)}return i}getReachableTarget(t,e){return t.matches(e,0,this.atn.maxTokenType)?t.target:null}getPredsForAmbigAlts(t,e,n){let s=[];for(let n=0;n<e.items.length;n++){const i=e.items[n];t.contains(i.alt)&&(s[i.alt]=E.orContext(s[i.alt]||null,i.semanticContext))}let r=0;for(let t=1;t<n+1;t++){const e=s[t]||null;null===e?s[t]=E.NONE:e!==E.NONE&&(r+=1)}return 0===r&&(s=null),this.debug&&console.log("getPredsForAmbigAlts result "+i.arrayToString(s)),s}getPredicatePredictions(t,e){const n=[];let i=!1;for(let s=1;s<e.length;s++){const r=e[s];null!==t&&t.contains(s)&&n.push(new g(r,s)),r!==E.NONE&&(i=!0)}return i?n:null}getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(t,e){const n=this.splitAccordingToSemanticValidity(t,e),i=n[0],s=n[1];let r=this.getAltThatFinishedDecisionEntryRule(i);return r!==a.INVALID_ALT_NUMBER||s.items.length>0&&(r=this.getAltThatFinishedDecisionEntryRule(s),r!==a.INVALID_ALT_NUMBER)?r:a.INVALID_ALT_NUMBER}getAltThatFinishedDecisionEntryRule(t){const e=[];for(let n=0;n<t.items.length;n++){const i=t.items[n];(i.reachesIntoOuterContext>0||i.state instanceof h&&i.context.hasEmptyPath())&&e.indexOf(i.alt)<0&&e.push(i.alt)}return 0===e.length?a.INVALID_ALT_NUMBER:Math.min.apply(null,e)}splitAccordingToSemanticValidity(t,e){const n=new c(t.fullCtx),i=new c(t.fullCtx);for(let s=0;s<t.items.length;s++){const r=t.items[s];r.semanticContext!==E.NONE?r.semanticContext.evaluate(this.parser,e)?n.add(r):i.add(r):n.add(r)}return[n,i]}evalSemanticContext(t,e,n){const i=new r;for(let s=0;s<t.length;s++){const r=t[s];if(r.pred===E.NONE){if(i.add(r.alt),!n)break;continue}const o=r.pred.evaluate(this.parser,e);if((this.debug||this.dfa_debug)&&console.log("eval pred "+r+"="+o),o&&((this.debug||this.dfa_debug)&&console.log("PREDICT "+r.alt),i.add(r.alt),!n))break}return i}closure(t,e,n,i,s,r){this.closureCheckingStopState(t,e,n,i,s,0,r)}closureCheckingStopState(t,e,n,i,s,r,o){if((this.debug||this.debug_closure)&&(console.log("closure("+t.toString(this.parser,!0)+")"),t.reachesIntoOuterContext>50))throw"problem";if(t.state instanceof h){if(!t.context.isEmpty()){for(let a=0;a<t.context.length;a++){if(t.context.getReturnState(a)===S.EMPTY_RETURN_STATE){if(s){e.add(new u({state:t.state,context:S.EMPTY},t),this.mergeCache);continue}this.debug&&console.log("FALLING off rule "+this.getRuleName(t.state.ruleIndex)),this.closure_(t,e,n,i,s,r,o);continue}const l=this.atn.states[t.context.getReturnState(a)],h=t.context.getParent(a),c={state:l,alt:t.alt,context:h,semanticContext:t.semanticContext},d=new u(c,null);d.reachesIntoOuterContext=t.reachesIntoOuterContext,this.closureCheckingStopState(d,e,n,i,s,r-1,o)}return}if(s)return void e.add(t,this.mergeCache);this.debug&&console.log("FALLING off rule "+this.getRuleName(t.state.ruleIndex))}this.closure_(t,e,n,i,s,r,o)}closure_(t,e,n,i,s,r,o){const a=t.state;a.epsilonOnlyTransitions||e.add(t,this.mergeCache);for(let l=0;l<a.transitions.length;l++){if(0===l&&this.canDropLoopEntryEdgeInLeftRecursiveRule(t))continue;const u=a.transitions[l],c=i&&!(u instanceof y),d=this.getEpsilonTarget(t,u,c,0===r,s,o);if(null!==d){let i=r;if(t.state instanceof h){if(null!==this._dfa&&this._dfa.precedenceDfa&&u.outermostPrecedenceReturn===this._dfa.atnStartState.ruleIndex&&(d.precedenceFilterSuppressed=!0),d.reachesIntoOuterContext+=1,n.add(d)!==d)continue;e.dipsIntoOuterContext=!0,i-=1,this.debug&&console.log("dips into outer ctx: "+d)}else{if(!u.isEpsilon&&n.add(d)!==d)continue;u instanceof N&&i>=0&&(i+=1)}this.closureCheckingStopState(d,e,n,c,s,i,o)}}}canDropLoopEntryEdgeInLeftRecursiveRule(t){const e=t.state;if(e.stateType!==l.STAR_LOOP_ENTRY)return!1;if(e.stateType!==l.STAR_LOOP_ENTRY||!e.isPrecedenceDecision||t.context.isEmpty()||t.context.hasEmptyPath())return!1;const n=t.context.length;for(let i=0;i<n;i++)if(this.atn.states[t.context.getReturnState(i)].ruleIndex!==e.ruleIndex)return!1;const i=e.transitions[0].target.endState.stateNumber,s=this.atn.states[i];for(let i=0;i<n;i++){const n=t.context.getReturnState(i),r=this.atn.states[n];if(1!==r.transitions.length||!r.transitions[0].isEpsilon)return!1;const o=r.transitions[0].target;if(!(r.stateType===l.BLOCK_END&&o===e||r===s||o===s||o.stateType===l.BLOCK_END&&1===o.transitions.length&&o.transitions[0].isEpsilon&&o.transitions[0].target===e))return!1}return!0}getRuleName(t){return null!==this.parser&&t>=0?this.parser.ruleNames[t]:"<rule "+t+">"}getEpsilonTarget(t,e,n,i,s,r){switch(e.serializationType){case _.RULE:return this.ruleTransition(t,e);case _.PRECEDENCE:return this.precedenceTransition(t,e,n,i,s);case _.PREDICATE:return this.predTransition(t,e,n,i,s);case _.ACTION:return this.actionTransition(t,e);case _.EPSILON:return new u({state:e.target},t);case _.ATOM:case _.RANGE:case _.SET:return r&&e.matches(d.EOF,0,1)?new u({state:e.target},t):null;default:return null}}actionTransition(t,e){if(this.debug){const t=-1===e.actionIndex?65535:e.actionIndex;console.log("ACTION edge "+e.ruleIndex+":"+t)}return new u({state:e.target},t)}precedenceTransition(t,e,n,s,r){this.debug&&(console.log("PRED (collectPredicates="+n+") "+e.precedence+">=_p, ctx dependent=true"),null!==this.parser&&console.log("context surrounding pred is "+i.arrayToString(this.parser.getRuleInvocationStack())));let o=null;if(n&&s)if(r){const n=this._input.index;this._input.seek(this._startIndex);const i=e.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(n),i&&(o=new u({state:e.target},t))}else{const n=E.andContext(t.semanticContext,e.getPredicate());o=new u({state:e.target,semanticContext:n},t)}else o=new u({state:e.target},t);return this.debug&&console.log("config from pred transition="+o),o}predTransition(t,e,n,s,r){this.debug&&(console.log("PRED (collectPredicates="+n+") "+e.ruleIndex+":"+e.predIndex+", ctx dependent="+e.isCtxDependent),null!==this.parser&&console.log("context surrounding pred is "+i.arrayToString(this.parser.getRuleInvocationStack())));let o=null;if(n&&(e.isCtxDependent&&s||!e.isCtxDependent))if(r){const n=this._input.index;this._input.seek(this._startIndex);const i=e.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(n),i&&(o=new u({state:e.target},t))}else{const n=E.andContext(t.semanticContext,e.getPredicate());o=new u({state:e.target,semanticContext:n},t)}else o=new u({state:e.target},t);return this.debug&&console.log("config from pred transition="+o),o}ruleTransition(t,e){this.debug&&console.log("CALL rule "+this.getRuleName(e.target.ruleIndex)+", ctx="+t.context);const n=e.followState,i=M.create(t.context,n.stateNumber);return new u({state:e.target,context:i},t)}getConflictingAlts(t){const e=m.getConflictingAltSubsets(t);return m.getAlts(e)}getConflictingAltsOrUniqueAlt(t){let e=null;return t.uniqueAlt!==a.INVALID_ALT_NUMBER?(e=new r,e.add(t.uniqueAlt)):e=t.conflictingAlts,e}getTokenName(t){if(t===d.EOF)return"EOF";if(null!==this.parser&&null!==this.parser.literalNames){if(!(t>=this.parser.literalNames.length&&t>=this.parser.symbolicNames.length))return(this.parser.literalNames[t]||this.parser.symbolicNames[t])+"<"+t+">";console.log(t+" ttype out of range: "+this.parser.literalNames),console.log(""+this.parser.getInputStream().getTokens())}return""+t}getLookaheadName(t){return this.getTokenName(t.LA(1))}dumpDeadEndConfigs(t){console.log("dead end configs: ");const e=t.getDeadEndConfigs();for(let t=0;t<e.length;t++){const n=e[t];let i="no edges";if(n.state.transitions.length>0){const t=n.state.transitions[0];t instanceof AtomTransition?i="Atom "+this.getTokenName(t.label):t instanceof v&&(i=(t instanceof A?"~":"")+"Set "+t.set)}console.error(n.toString(this.parser,!0)+":"+i)}}noViableAlt(t,e,n,i){return new C(this.parser,t,t.get(i),t.LT(1),n,e)}getUniqueAlt(t){let e=a.INVALID_ALT_NUMBER;for(let n=0;n<t.items.length;n++){const i=t.items[n];if(e===a.INVALID_ALT_NUMBER)e=i.alt;else if(i.alt!==e)return a.INVALID_ALT_NUMBER}return e}addDFAEdge(t,e,n,i){if(this.debug&&console.log("EDGE "+e+" -> "+i+" upon "+this.getTokenName(n)),null===i)return null;if(i=this.addDFAState(t,i),null===e||n<-1||n>this.atn.maxTokenType)return i;if(null===e.edges&&(e.edges=[]),e.edges[n+1]=i,this.debug){const e=null===this.parser?null:this.parser.literalNames,n=null===this.parser?null:this.parser.symbolicNames;console.log("DFA=\n"+t.toString(e,n))}return i}addDFAState(t,e){if(e===f.ERROR)return e;const n=t.states.get(e);return null!==n?n:(e.stateNumber=t.states.length,e.configs.readOnly||(e.configs.optimizeConfigs(this),e.configs.setReadonly(!0)),t.states.add(e),this.debug&&console.log("adding new DFA state: "+e),e)}reportAttemptingFullContext(t,e,n,i,s){if(this.debug||this.retry_debug){const e=new T(i,s+1);console.log("reportAttemptingFullContext decision="+t.decision+":"+n+", input="+this.parser.getTokenStream().getText(e))}null!==this.parser&&this.parser.getErrorListenerDispatch().reportAttemptingFullContext(this.parser,t,i,s,e,n)}reportContextSensitivity(t,e,n,i,s){if(this.debug||this.retry_debug){const e=new T(i,s+1);console.log("reportContextSensitivity decision="+t.decision+":"+n+", input="+this.parser.getTokenStream().getText(e))}null!==this.parser&&this.parser.getErrorListenerDispatch().reportContextSensitivity(this.parser,t,i,s,e,n)}reportAmbiguity(t,e,n,i,s,r,o){if(this.debug||this.retry_debug){const t=new T(n,i+1);console.log("reportAmbiguity "+r+":"+o+", input="+this.parser.getTokenStream().getText(t))}null!==this.parser&&this.parser.getErrorListenerDispatch().reportAmbiguity(this.parser,t,n,i,s,r,o)}}},8505:(t,e,n)=>{const{Map:i,BitSet:s,AltDict:r,hashStuff:o}=n(7785),a=n(8641),{RuleStopState:l}=n(290),{ATNConfigSet:h}=n(7021),{ATNConfig:u}=n(3961),{SemanticContext:c}=n(660),d={SLL:0,LL:1,LL_EXACT_AMBIG_DETECTION:2,hasSLLConflictTerminatingPrediction:function(t,e){if(d.allConfigsInRuleStopStates(e))return!0;if(t===d.SLL&&e.hasSemanticContext){const t=new h;for(let n=0;n<e.items.length;n++){let i=e.items[n];i=new u({semanticContext:c.NONE},i),t.add(i)}e=t}const n=d.getConflictingAltSubsets(e);return d.hasConflictingAltSet(n)&&!d.hasStateAssociatedWithOneAlt(e)},hasConfigInRuleStopState:function(t){for(let e=0;e<t.items.length;e++)if(t.items[e].state instanceof l)return!0;return!1},allConfigsInRuleStopStates:function(t){for(let e=0;e<t.items.length;e++)if(!(t.items[e].state instanceof l))return!1;return!0},resolvesToJustOneViableAlt:function(t){return d.getSingleViableAlt(t)},allSubsetsConflict:function(t){return!d.hasNonConflictingAltSet(t)},hasNonConflictingAltSet:function(t){for(let e=0;e<t.length;e++)if(1===t[e].length)return!0;return!1},hasConflictingAltSet:function(t){for(let e=0;e<t.length;e++)if(t[e].length>1)return!0;return!1},allSubsetsEqual:function(t){let e=null;for(let n=0;n<t.length;n++){const i=t[n];if(null===e)e=i;else if(i!==e)return!1}return!0},getUniqueAlt:function(t){const e=d.getAlts(t);return 1===e.length?e.minValue():a.INVALID_ALT_NUMBER},getAlts:function(t){const e=new s;return t.map((function(t){e.or(t)})),e},getConflictingAltSubsets:function(t){const e=new i;return e.hashFunction=function(t){o(t.state.stateNumber,t.context)},e.equalsFunction=function(t,e){return t.state.stateNumber===e.state.stateNumber&&t.context.equals(e.context)},t.items.map((function(t){let n=e.get(t);null===n&&(n=new s,e.put(t,n)),n.add(t.alt)})),e.getValues()},getStateToAltMap:function(t){const e=new r;return t.items.map((function(t){let n=e.get(t.state);null===n&&(n=new s,e.put(t.state,n)),n.add(t.alt)})),e},hasStateAssociatedWithOneAlt:function(t){const e=d.getStateToAltMap(t).values();for(let t=0;t<e.length;t++)if(1===e[t].length)return!0;return!1},getSingleViableAlt:function(t){let e=null;for(let n=0;n<t.length;n++){const i=t[n].minValue();if(null===e)e=i;else if(e!==i)return a.INVALID_ALT_NUMBER}return e}};t.exports=d},660:(t,e,n)=>{const{Set:i,Hash:s,equalArrays:r}=n(7785);class o{hashCode(){const t=new s;return this.updateHashCode(t),t.finish()}evaluate(t,e){}evalPrecedence(t,e){return this}static andContext(t,e){if(null===t||t===o.NONE)return e;if(null===e||e===o.NONE)return t;const n=new h(t,e);return 1===n.opnds.length?n.opnds[0]:n}static orContext(t,e){if(null===t)return e;if(null===e)return t;if(t===o.NONE||e===o.NONE)return o.NONE;const n=new u(t,e);return 1===n.opnds.length?n.opnds[0]:n}}class a extends o{constructor(t,e,n){super(),this.ruleIndex=void 0===t?-1:t,this.predIndex=void 0===e?-1:e,this.isCtxDependent=void 0!==n&&n}evaluate(t,e){const n=this.isCtxDependent?e:null;return t.sempred(n,this.ruleIndex,this.predIndex)}updateHashCode(t){t.update(this.ruleIndex,this.predIndex,this.isCtxDependent)}equals(t){return this===t||t instanceof a&&this.ruleIndex===t.ruleIndex&&this.predIndex===t.predIndex&&this.isCtxDependent===t.isCtxDependent}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}o.NONE=new a;class l extends o{constructor(t){super(),this.precedence=void 0===t?0:t}evaluate(t,e){return t.precpred(e,this.precedence)}evalPrecedence(t,e){return t.precpred(e,this.precedence)?o.NONE:null}compareTo(t){return this.precedence-t.precedence}updateHashCode(t){t.update(this.precedence)}equals(t){return this===t||t instanceof l&&this.precedence===t.precedence}toString(){return"{"+this.precedence+">=prec}?"}static filterPrecedencePredicates(t){const e=[];return t.values().map((function(t){t instanceof l&&e.push(t)})),e}}class h extends o{constructor(t,e){super();const n=new i;t instanceof h?t.opnds.map((function(t){n.add(t)})):n.add(t),e instanceof h?e.opnds.map((function(t){n.add(t)})):n.add(e);const s=l.filterPrecedencePredicates(n);if(s.length>0){let t=null;s.map((function(e){(null===t||e.precedence<t.precedence)&&(t=e)})),n.add(t)}this.opnds=Array.from(n.values())}equals(t){return this===t||t instanceof h&&r(this.opnds,t.opnds)}updateHashCode(t){t.update(this.opnds,"AND")}evaluate(t,e){for(let n=0;n<this.opnds.length;n++)if(!this.opnds[n].evaluate(t,e))return!1;return!0}evalPrecedence(t,e){let n=!1;const i=[];for(let s=0;s<this.opnds.length;s++){const r=this.opnds[s],a=r.evalPrecedence(t,e);if(n|=a!==r,null===a)return null;a!==o.NONE&&i.push(a)}if(!n)return this;if(0===i.length)return o.NONE;let s=null;return i.map((function(t){s=null===s?t:o.andContext(s,t)})),s}toString(){const t=this.opnds.map((t=>t.toString()));return(t.length>3?t.slice(3):t).join("&&")}}class u extends o{constructor(t,e){super();const n=new i;t instanceof u?t.opnds.map((function(t){n.add(t)})):n.add(t),e instanceof u?e.opnds.map((function(t){n.add(t)})):n.add(e);const s=l.filterPrecedencePredicates(n);if(s.length>0){const t=s.sort((function(t,e){return t.compareTo(e)})),e=t[t.length-1];n.add(e)}this.opnds=Array.from(n.values())}equals(t){return this===t||t instanceof u&&r(this.opnds,t.opnds)}updateHashCode(t){t.update(this.opnds,"OR")}evaluate(t,e){for(let n=0;n<this.opnds.length;n++)if(this.opnds[n].evaluate(t,e))return!0;return!1}evalPrecedence(t,e){let n=!1;const i=[];for(let s=0;s<this.opnds.length;s++){const r=this.opnds[s],a=r.evalPrecedence(t,e);if(n|=a!==r,a===o.NONE)return o.NONE;null!==a&&i.push(a)}if(!n)return this;if(0===i.length)return null;return i.map((function(t){return t})),null}toString(){const t=this.opnds.map((t=>t.toString()));return(t.length>3?t.slice(3):t).join("||")}}t.exports={SemanticContext:o,PrecedencePredicate:l,Predicate:a}},2068:(t,e,n)=>{const{Token:i}=n(5994),{IntervalSet:s}=n(8909),{Predicate:r,PrecedencePredicate:o}=n(660);class a{constructor(t){if(null==t)throw"target cannot be null.";this.target=t,this.isEpsilon=!1,this.label=null}}a.EPSILON=1,a.RANGE=2,a.RULE=3,a.PREDICATE=4,a.ATOM=5,a.ACTION=6,a.SET=7,a.NOT_SET=8,a.WILDCARD=9,a.PRECEDENCE=10,a.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],a.serializationTypes={EpsilonTransition:a.EPSILON,RangeTransition:a.RANGE,RuleTransition:a.RULE,PredicateTransition:a.PREDICATE,AtomTransition:a.ATOM,ActionTransition:a.ACTION,SetTransition:a.SET,NotSetTransition:a.NOT_SET,WildcardTransition:a.WILDCARD,PrecedencePredicateTransition:a.PRECEDENCE};class l extends a{constructor(t){super(t)}}class h extends a{constructor(t,e){super(t),this.serializationType=a.SET,null!=e?this.label=e:(this.label=new s,this.label.addOne(i.INVALID_TYPE))}matches(t,e,n){return this.label.contains(t)}toString(){return this.label.toString()}}t.exports={Transition:a,AtomTransition:class extends a{constructor(t,e){super(t),this.label_=e,this.label=this.makeLabel(),this.serializationType=a.ATOM}makeLabel(){const t=new s;return t.addOne(this.label_),t}matches(t,e,n){return this.label_===t}toString(){return this.label_}},SetTransition:h,NotSetTransition:class extends h{constructor(t,e){super(t,e),this.serializationType=a.NOT_SET}matches(t,e,n){return t>=e&&t<=n&&!super.matches(t,e,n)}toString(){return"~"+super.toString()}},RuleTransition:class extends a{constructor(t,e,n,i){super(t),this.ruleIndex=e,this.precedence=n,this.followState=i,this.serializationType=a.RULE,this.isEpsilon=!0}matches(t,e,n){return!1}},ActionTransition:class extends a{constructor(t,e,n,i){super(t),this.serializationType=a.ACTION,this.ruleIndex=e,this.actionIndex=void 0===n?-1:n,this.isCtxDependent=void 0!==i&&i,this.isEpsilon=!0}matches(t,e,n){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}},EpsilonTransition:class extends a{constructor(t,e){super(t),this.serializationType=a.EPSILON,this.isEpsilon=!0,this.outermostPrecedenceReturn=e}matches(t,e,n){return!1}toString(){return"epsilon"}},RangeTransition:class extends a{constructor(t,e,n){super(t),this.serializationType=a.RANGE,this.start=e,this.stop=n,this.label=this.makeLabel()}makeLabel(){const t=new s;return t.addRange(this.start,this.stop),t}matches(t,e,n){return t>=this.start&&t<=this.stop}toString(){return"'"+String.fromCharCode(this.start)+"'..'"+String.fromCharCode(this.stop)+"'"}},WildcardTransition:class extends a{constructor(t){super(t),this.serializationType=a.WILDCARD}matches(t,e,n){return t>=e&&t<=n}toString(){return"."}},PredicateTransition:class extends l{constructor(t,e,n,i){super(t),this.serializationType=a.PREDICATE,this.ruleIndex=e,this.predIndex=n,this.isCtxDependent=i,this.isEpsilon=!0}matches(t,e,n){return!1}getPredicate(){return new r(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}},PrecedencePredicateTransition:class extends l{constructor(t,e){super(t),this.serializationType=a.PRECEDENCE,this.precedence=e,this.isEpsilon=!0}matches(t,e,n){return!1}getPredicate(){return new o(this.precedence)}toString(){return this.precedence+" >= _p"}},AbstractPredicateTransition:l}},4907:(t,e,n)=>{e.ATN=n(8641),e.ATNDeserializer=n(3369),e.LexerATNSimulator=n(7205),e.ParserATNSimulator=n(2355),n(8505)},4178:(t,e,n)=>{const{Set:i}=n(7785),{DFAState:s}=n(6254),{StarLoopEntryState:r}=n(290),{ATNConfigSet:o}=n(7021),{DFASerializer:a}=n(7999),{LexerDFASerializer:l}=n(7999);t.exports=class{constructor(t,e){if(void 0===e&&(e=0),this.atnStartState=t,this.decision=e,this._states=new i,this.s0=null,this.precedenceDfa=!1,t instanceof r&&t.isPrecedenceDecision){this.precedenceDfa=!0;const t=new s(null,new o);t.edges=[],t.isAcceptState=!1,t.requiresFullContext=!1,this.s0=t}}getPrecedenceStartState(t){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";return t<0||t>=this.s0.edges.length?null:this.s0.edges[t]||null}setPrecedenceStartState(t,e){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";t<0||(this.s0.edges[t]=e)}setPrecedenceDfa(t){if(this.precedenceDfa!==t){if(this._states=new i,t){const t=new s(null,new o);t.edges=[],t.isAcceptState=!1,t.requiresFullContext=!1,this.s0=t}else this.s0=null;this.precedenceDfa=t}}sortedStates(){return this._states.values().sort((function(t,e){return t.stateNumber-e.stateNumber}))}toString(t,e){return t=t||null,e=e||null,null===this.s0?"":new a(this,t,e).toString()}toLexerString(){return null===this.s0?"":new l(this).toString()}get states(){return this._states}}},7999:t=>{class e{constructor(t,e,n){this.dfa=t,this.literalNames=e||[],this.symbolicNames=n||[]}toString(){if(null===this.dfa.s0)return null;let t="";const e=this.dfa.sortedStates();for(let n=0;n<e.length;n++){const i=e[n];if(null!==i.edges){const e=i.edges.length;for(let n=0;n<e;n++){const e=i.edges[n]||null;null!==e&&2147483647!==e.stateNumber&&(t=t.concat(this.getStateString(i)),t=t.concat("-"),t=t.concat(this.getEdgeLabel(n)),t=t.concat("->"),t=t.concat(this.getStateString(e)),t=t.concat("\n"))}}}return 0===t.length?null:t}getEdgeLabel(t){return 0===t?"EOF":null!==this.literalNames||null!==this.symbolicNames?this.literalNames[t-1]||this.symbolicNames[t-1]:String.fromCharCode(t-1)}getStateString(t){const e=(t.isAcceptState?":":"")+"s"+t.stateNumber+(t.requiresFullContext?"^":"");return t.isAcceptState?null!==t.predicates?e+"=>"+t.predicates.toString():e+"=>"+t.prediction.toString():e}}t.exports={DFASerializer:e,LexerDFASerializer:class extends e{constructor(t){super(t,null)}getEdgeLabel(t){return"'"+String.fromCharCode(t)+"'"}}}},6254:(t,e,n)=>{const{ATNConfigSet:i}=n(7021),{Hash:s,Set:r}=n(7785);class o{constructor(t,e){return null===t&&(t=-1),null===e&&(e=new i),this.stateNumber=t,this.configs=e,this.edges=null,this.isAcceptState=!1,this.prediction=0,this.lexerActionExecutor=null,this.requiresFullContext=!1,this.predicates=null,this}getAltSet(){const t=new r;if(null!==this.configs)for(let e=0;e<this.configs.length;e++){const n=this.configs[e];t.add(n.alt)}return 0===t.length?null:t}equals(t){return this===t||t instanceof o&&this.configs.equals(t.configs)}toString(){let t=this.stateNumber+":"+this.configs;return this.isAcceptState&&(t+="=>",null!==this.predicates?t+=this.predicates:t+=this.prediction),t}hashCode(){const t=new s;return t.update(this.configs),t.finish()}}t.exports={DFAState:o,PredPrediction:class{constructor(t,e){this.alt=e,this.pred=t}toString(){return"("+this.pred+", "+this.alt+")"}}}},2014:(t,e,n)=>{e.DFA=n(4178),n(7999).DFASerializer,n(7999).LexerDFASerializer,n(6254).PredPrediction},114:(t,e,n)=>{const{BitSet:i}=n(7785),{ErrorListener:s}=n(9553),{Interval:r}=n(8909);t.exports=class extends s{constructor(t){super(),t=t||!0,this.exactOnly=t}reportAmbiguity(t,e,n,i,s,o,a){if(this.exactOnly&&!s)return;const l="reportAmbiguity d="+this.getDecisionDescription(t,e)+": ambigAlts="+this.getConflictingAlts(o,a)+", input='"+t.getTokenStream().getText(new r(n,i))+"'";t.notifyErrorListeners(l)}reportAttemptingFullContext(t,e,n,i,s,o){const a="reportAttemptingFullContext d="+this.getDecisionDescription(t,e)+", input='"+t.getTokenStream().getText(new r(n,i))+"'";t.notifyErrorListeners(a)}reportContextSensitivity(t,e,n,i,s,o){const a="reportContextSensitivity d="+this.getDecisionDescription(t,e)+", input='"+t.getTokenStream().getText(new r(n,i))+"'";t.notifyErrorListeners(a)}getDecisionDescription(t,e){const n=e.decision,i=e.atnStartState.ruleIndex,s=t.ruleNames;if(i<0||i>=s.length)return""+n;const r=s[i]||null;return null===r||0===r.length?""+n:`${n} (${r})`}getConflictingAlts(t,e){if(null!==t)return t;const n=new i;for(let t=0;t<e.items.length;t++)n.add(e.items[t].alt);return`{${n.values().join(", ")}}`}}},9553:t=>{class e{syntaxError(t,e,n,i,s,r){}reportAmbiguity(t,e,n,i,s,r,o){}reportAttemptingFullContext(t,e,n,i,s,r){}reportContextSensitivity(t,e,n,i,s,r){}}class n extends e{constructor(){super()}syntaxError(t,e,n,i,s,r){console.error("line "+n+":"+i+" "+s)}}n.INSTANCE=new n,t.exports={ErrorListener:e,ConsoleErrorListener:n,ProxyErrorListener:class extends e{constructor(t){if(super(),null===t)throw"delegates";return this.delegates=t,this}syntaxError(t,e,n,i,s,r){this.delegates.map((o=>o.syntaxError(t,e,n,i,s,r)))}reportAmbiguity(t,e,n,i,s,r,o){this.delegates.map((a=>a.reportAmbiguity(t,e,n,i,s,r,o)))}reportAttemptingFullContext(t,e,n,i,s,r){this.delegates.map((o=>o.reportAttemptingFullContext(t,e,n,i,s,r)))}reportContextSensitivity(t,e,n,i,s,r){this.delegates.map((o=>o.reportContextSensitivity(t,e,n,i,s,r)))}}}},4390:(t,e,n)=>{const{Token:i}=n(5994),{NoViableAltException:s,InputMismatchException:r,FailedPredicateException:o,ParseCancellationException:a}=n(3337),{ATNState:l}=n(290),{Interval:h,IntervalSet:u}=n(8909);class c extends class{reset(t){}recoverInline(t){}recover(t,e){}sync(t){}inErrorRecoveryMode(t){}reportError(t){}}{constructor(){super(),this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.lastErrorStates=null,this.nextTokensContext=null,this.nextTokenState=0}reset(t){this.endErrorCondition(t)}beginErrorCondition(t){this.errorRecoveryMode=!0}inErrorRecoveryMode(t){return this.errorRecoveryMode}endErrorCondition(t){this.errorRecoveryMode=!1,this.lastErrorStates=null,this.lastErrorIndex=-1}reportMatch(t){this.endErrorCondition(t)}reportError(t,e){this.inErrorRecoveryMode(t)||(this.beginErrorCondition(t),e instanceof s?this.reportNoViableAlternative(t,e):e instanceof r?this.reportInputMismatch(t,e):e instanceof o?this.reportFailedPredicate(t,e):(console.log("unknown recognition error type: "+e.constructor.name),console.log(e.stack),t.notifyErrorListeners(e.getOffendingToken(),e.getMessage(),e)))}recover(t,e){this.lastErrorIndex===t.getInputStream().index&&null!==this.lastErrorStates&&this.lastErrorStates.indexOf(t.state)>=0&&t.consume(),this.lastErrorIndex=t._input.index,null===this.lastErrorStates&&(this.lastErrorStates=[]),this.lastErrorStates.push(t.state);const n=this.getErrorRecoverySet(t);this.consumeUntil(t,n)}sync(t){if(this.inErrorRecoveryMode(t))return;const e=t._interp.atn.states[t.state],n=t.getTokenStream().LA(1),s=t.atn.nextTokens(e);if(s.contains(n))return this.nextTokensContext=null,void(this.nextTokenState=l.INVALID_STATE_NUMBER);if(s.contains(i.EPSILON))null===this.nextTokensContext&&(this.nextTokensContext=t._ctx,this.nextTokensState=t._stateNumber);else switch(e.stateType){case l.BLOCK_START:case l.STAR_BLOCK_START:case l.PLUS_BLOCK_START:case l.STAR_LOOP_ENTRY:if(null!==this.singleTokenDeletion(t))return;throw new r(t);case l.PLUS_LOOP_BACK:case l.STAR_LOOP_BACK:this.reportUnwantedToken(t);const e=new u;e.addSet(t.getExpectedTokens());const n=e.addSet(this.getErrorRecoverySet(t));this.consumeUntil(t,n)}}reportNoViableAlternative(t,e){const n=t.getTokenStream();let s;s=null!==n?e.startToken.type===i.EOF?"<EOF>":n.getText(new h(e.startToken.tokenIndex,e.offendingToken.tokenIndex)):"<unknown input>";const r="no viable alternative at input "+this.escapeWSAndQuote(s);t.notifyErrorListeners(r,e.offendingToken,e)}reportInputMismatch(t,e){const n="mismatched input "+this.getTokenErrorDisplay(e.offendingToken)+" expecting "+e.getExpectedTokens().toString(t.literalNames,t.symbolicNames);t.notifyErrorListeners(n,e.offendingToken,e)}reportFailedPredicate(t,e){const n="rule "+t.ruleNames[t._ctx.ruleIndex]+" "+e.message;t.notifyErrorListeners(n,e.offendingToken,e)}reportUnwantedToken(t){if(this.inErrorRecoveryMode(t))return;this.beginErrorCondition(t);const e=t.getCurrentToken(),n="extraneous input "+this.getTokenErrorDisplay(e)+" expecting "+this.getExpectedTokens(t).toString(t.literalNames,t.symbolicNames);t.notifyErrorListeners(n,e,null)}reportMissingToken(t){if(this.inErrorRecoveryMode(t))return;this.beginErrorCondition(t);const e=t.getCurrentToken(),n="missing "+this.getExpectedTokens(t).toString(t.literalNames,t.symbolicNames)+" at "+this.getTokenErrorDisplay(e);t.notifyErrorListeners(n,e,null)}recoverInline(t){const e=this.singleTokenDeletion(t);if(null!==e)return t.consume(),e;if(this.singleTokenInsertion(t))return this.getMissingSymbol(t);throw new r(t)}singleTokenInsertion(t){const e=t.getTokenStream().LA(1),n=t._interp.atn,i=n.states[t.state].transitions[0].target;return!!n.nextTokens(i,t._ctx).contains(e)&&(this.reportMissingToken(t),!0)}singleTokenDeletion(t){const e=t.getTokenStream().LA(2);if(this.getExpectedTokens(t).contains(e)){this.reportUnwantedToken(t),t.consume();const e=t.getCurrentToken();return this.reportMatch(t),e}return null}getMissingSymbol(t){const e=t.getCurrentToken(),n=this.getExpectedTokens(t).first();let s;s=n===i.EOF?"<missing EOF>":"<missing "+t.literalNames[n]+">";let r=e;const o=t.getTokenStream().LT(-1);return r.type===i.EOF&&null!==o&&(r=o),t.getTokenFactory().create(r.source,n,s,i.DEFAULT_CHANNEL,-1,-1,r.line,r.column)}getExpectedTokens(t){return t.getExpectedTokens()}getTokenErrorDisplay(t){if(null===t)return"<no token>";let e=t.text;return null===e&&(e=t.type===i.EOF?"<EOF>":"<"+t.type+">"),this.escapeWSAndQuote(e)}escapeWSAndQuote(t){return"'"+(t=(t=(t=t.replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t"))+"'"}getErrorRecoverySet(t){const e=t._interp.atn;let n=t._ctx;const s=new u;for(;null!==n&&n.invokingState>=0;){const t=e.states[n.invokingState].transitions[0],i=e.nextTokens(t.followState);s.addSet(i),n=n.parentCtx}return s.removeOne(i.EPSILON),s}consumeUntil(t,e){let n=t.getTokenStream().LA(1);for(;n!==i.EOF&&!e.contains(n);)t.consume(),n=t.getTokenStream().LA(1)}}t.exports={BailErrorStrategy:class extends c{constructor(){super()}recover(t,e){let n=t._ctx;for(;null!==n;)n.exception=e,n=n.parentCtx;throw new a(e)}recoverInline(t){this.recover(t,new r(t))}sync(t){}},DefaultErrorStrategy:c}},3337:(t,e,n)=>{const{PredicateTransition:i}=n(2068),{Interval:s}=n(8909).Interval;class r extends Error{constructor(t){super(t.message),Error.captureStackTrace?Error.captureStackTrace(this,r):(new Error).stack,this.message=t.message,this.recognizer=t.recognizer,this.input=t.input,this.ctx=t.ctx,this.offendingToken=null,this.offendingState=-1,null!==this.recognizer&&(this.offendingState=this.recognizer.state)}getExpectedTokens(){return null!==this.recognizer?this.recognizer.atn.getExpectedTokens(this.offendingState,this.ctx):null}toString(){return this.message}}function o(t,e){return null!==e?e:"failed predicate: {"+t+"}?"}class a extends Error{constructor(){super(),Error.captureStackTrace(this,a)}}t.exports={RecognitionException:r,NoViableAltException:class extends r{constructor(t,e,n,i,s,r){r=r||t._ctx,i=i||t.getCurrentToken(),n=n||t.getCurrentToken(),e=e||t.getInputStream(),super({message:"",recognizer:t,input:e,ctx:r}),this.deadEndConfigs=s,this.startToken=n,this.offendingToken=i}},LexerNoViableAltException:class extends r{constructor(t,e,n,i){super({message:"",recognizer:t,input:e,ctx:null}),this.startIndex=n,this.deadEndConfigs=i}toString(){let t="";return this.startIndex>=0&&this.startIndex<this.input.size&&(t=this.input.getText(new s(this.startIndex,this.startIndex))),"LexerNoViableAltException"+t}},InputMismatchException:class extends r{constructor(t){super({message:"",recognizer:t,input:t.getInputStream(),ctx:t._ctx}),this.offendingToken=t.getCurrentToken()}},FailedPredicateException:class extends r{constructor(t,e,n){super({message:o(e,n||null),recognizer:t,input:t.getInputStream(),ctx:t._ctx});const s=t._interp.atn.states[t.state].transitions[0];s instanceof i?(this.ruleIndex=s.ruleIndex,this.predicateIndex=s.predIndex):(this.ruleIndex=0,this.predicateIndex=0),this.predicate=e,this.offendingToken=t.getCurrentToken()}},ParseCancellationException:a}},3984:(t,e,n)=>{t.exports.RecognitionException=n(3337).RecognitionException,t.exports.NoViableAltException=n(3337).NoViableAltException,n(3337).LexerNoViableAltException,n(3337).InputMismatchException,t.exports.FailedPredicateException=n(3337).FailedPredicateException,n(114),n(4390).BailErrorStrategy,n(4390).DefaultErrorStrategy,n(9553).ErrorListener},7938:(t,e,n)=>{e.atn=n(4907),n(5879),e.dfa=n(2014),n(6414),e.tree=n(5936),e.error=n(3984),e.Token=n(5994).Token,n(2443),n(5994).CommonToken,e.InputStream=n(8796),n(7661),e.CommonTokenStream=n(7850),e.Lexer=n(4126),e.Parser=n(63);var i=n(2259);e.d=i.PredictionContextCache,e.ParserRuleContext=n(2449),n(8909).Interval,n(8909).IntervalSet,n(7785),n(3723).LL1Analyzer},5879:()=>{String.prototype.codePointAt||function(){"use strict";var t=function(){let t;try{const e={},n=Object.defineProperty;t=n(e,e,e)&&n}catch(t){}return t}();const e=function(t){if(null==this)throw TypeError();const e=String(this),n=e.length;let i=t?Number(t):0;if(i!=i&&(i=0),i<0||i>=n)return;const s=e.charCodeAt(i);let r;return s>=55296&&s<=56319&&n>i+1&&(r=e.charCodeAt(i+1),r>=56320&&r<=57343)?1024*(s-55296)+r-56320+65536:s};t?t(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}()},6414:()=>{String.fromCodePoint||function(){const t=function(){let t;try{const e={},n=Object.defineProperty;t=n(e,e,e)&&n}catch(t){}return t}(),e=String.fromCharCode,n=Math.floor,i=function(t){const i=16384,s=[];let r,o,a=-1;const l=arguments.length;if(!l)return"";let h="";for(;++a<l;){let t=Number(arguments[a]);if(!isFinite(t)||t<0||t>1114111||n(t)!==t)throw RangeError("Invalid code point: "+t);t<=65535?s.push(t):(t-=65536,r=55296+(t>>10),o=t%1024+56320,s.push(r,o)),(a+1===l||s.length>i)&&(h+=e.apply(null,s),s.length=0)}return h};t?t(String,"fromCodePoint",{value:i,configurable:!0,writable:!0}):String.fromCodePoint=i}()},5828:(t,e,n)=>{const{Token:i}=n(5994),{Interval:s}=n(8909),r=new s(-1,-2);class o extends class extends class{}{constructor(){super()}}{constructor(){super()}}class a extends o{constructor(){super()}}class l extends a{constructor(){super()}}class h extends a{constructor(t){super(),this.parentCtx=null,this.symbol=t}getChild(t){return null}getSymbol(){return this.symbol}getParent(){return this.parentCtx}getPayload(){return this.symbol}getSourceInterval(){if(null===this.symbol)return r;const t=this.symbol.tokenIndex;return new s(t,t)}getChildCount(){return 0}accept(t){return t.visitTerminal(this)}getText(){return this.symbol.text}toString(){return this.symbol.type===i.EOF?"<EOF>":this.symbol.text}}class u{walk(t,e){if(e instanceof l||void 0!==e.isErrorNode&&e.isErrorNode())t.visitErrorNode(e);else if(e instanceof a)t.visitTerminal(e);else{this.enterRule(t,e);for(let n=0;n<e.getChildCount();n++){const i=e.getChild(n);this.walk(t,i)}this.exitRule(t,e)}}enterRule(t,e){const n=e.getRuleContext();t.enterEveryRule(n),n.enterRule(t)}exitRule(t,e){const n=e.getRuleContext();n.exitRule(t),t.exitEveryRule(n)}}u.DEFAULT=new u,t.exports={RuleNode:class extends o{constructor(){super()}getRuleContext(){throw new Error("missing interface implementation")}},ErrorNode:l,TerminalNode:a,ErrorNodeImpl:class extends h{constructor(t){super(t)}isErrorNode(){return!0}accept(t){return t.visitErrorNode(this)}},TerminalNodeImpl:h,ParseTreeListener:class{visitTerminal(t){}visitErrorNode(t){}enterEveryRule(t){}exitEveryRule(t){}},ParseTreeVisitor:class{visit(t){return Array.isArray(t)?t.map((function(t){return t.accept(this)}),this):t.accept(this)}visitChildren(t){return t.children?this.visit(t.children):null}visitTerminal(t){}visitErrorNode(t){}},ParseTreeWalker:u,INVALID_INTERVAL:r}},8030:(t,e,n)=>{const i=n(7785),{Token:s}=n(5994),{ErrorNode:r,TerminalNode:o,RuleNode:a}=n(5828),l={toStringTree:function(t,e,n){e=e||null,null!==(n=n||null)&&(e=n.ruleNames);let s=l.getNodeText(t,e);s=i.escapeWhitespace(s,!1);const r=t.getChildCount();if(0===r)return s;let o="("+s+" ";r>0&&(s=l.toStringTree(t.getChild(0),e),o=o.concat(s));for(let n=1;n<r;n++)s=l.toStringTree(t.getChild(n),e),o=o.concat(" "+s);return o=o.concat(")"),o},getNodeText:function(t,e,n){if(e=e||null,null!==(n=n||null)&&(e=n.ruleNames),null!==e){if(t instanceof a){const n=t.getRuleContext().getAltNumber();return 0!=n?e[t.ruleIndex]+":"+n:e[t.ruleIndex]}if(t instanceof r)return t.toString();if(t instanceof o&&null!==t.symbol)return t.symbol.text}const i=t.getPayload();return i instanceof s?i.text:t.getPayload().toString()},getChildren:function(t){const e=[];for(let n=0;n<t.getChildCount();n++)e.push(t.getChild(n));return e},getAncestors:function(t){let e=[];for(t=t.getParent();null!==t;)e=[t].concat(e),t=t.getParent();return e},findAllTokenNodes:function(t,e){return l.findAllNodes(t,e,!0)},findAllRuleNodes:function(t,e){return l.findAllNodes(t,e,!1)},findAllNodes:function(t,e,n){const i=[];return l._findAllNodes(t,e,n,i),i},_findAllNodes:function(t,e,n,i){n&&t instanceof o?t.symbol.type===e&&i.push(t):!n&&t instanceof a&&t.ruleIndex===e&&i.push(t);for(let s=0;s<t.getChildCount();s++)l._findAllNodes(t.getChild(s),e,n,i)},descendants:function(t){let e=[t];for(let n=0;n<t.getChildCount();n++)e=e.concat(l.descendants(t.getChild(n)));return e}};t.exports=l},5936:(t,e,n)=>{const i=n(5828),s=n(8030);t.exports={...i,Trees:s}},5150:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),s=n.n(i),r=n(3645),o=n.n(r)()(s());o.push([t.id,"body {\n    font-size: 10pt;\n    font-family: Helvetica, Arial;\n}\n\n.displayed {\n}\n\n.hidden {\n    display: None;\n}\n\ndiv#chartDiv {\n    width: 80%;\n    height: 80%;\n}\n.land {\n    stroke: black;\n    stroke-width: 0.5px;\n    fill: #f4e8c1\n}\n\n.streetGrid {\n    stroke: #222222;\n    stroke-width: 0.5px;\n    fill: none;\n}\n\npath.boat {\n    stroke: red;\n    fill: blue;\n    d: M100,100L100,200L200,200L200,100L100,100Z;\n}\n\npath.courseSegment {\n    stroke: green;\n    stroke-width: 1px;\n    fill: none\n}\ncircle.otherMarks {\n    stroke: #555;\n    fill: #5551;\n}\ncircle.courseMark {\n    stroke: green;\n    fill: green;\n}\n\ncircle.currentMark {\n    stroke: red;\n    fill: red;\n}\nline.currentMark {\n    stroke: red;\n}\nline.sun {\n    stroke: yellow;\n}\nline.shadow {\n    stroke: gray;\n}\n\npre.example, span.example {\n    font-family: Courier, Courier New;\n    font-weight: bold;\n    background-color: #eeeeee;\n}\n\nspan.legal {\n    font-family: Times New Roman, Times;\n    font-weight: bold;\n}\n\npre {\n    padding: 10pt;\n    overflow-x: auto;\n}\n\ntextarea {\n    overflow-x: auto;\n    width: 95%;\n    white-space: pre;\n}\n\ndiv.overflowxscroll {\n    overflow-x: auto;\n    width: 95%;\n}\n\np.expired {\n    font-size: 72pt;\n    color: red;\n    font-weight: bold;\n}\n\np.courseTableSummary {\n    font-weight: bold;\n    margin-bottom: 0.25pt;\n}\n\np.courseTableDescription {\n    font-weight: italic;\n    margin-top: 0.25pt;\n    margin-bottom: 0.25pt;\n}\n\nth.courseTableHeader {\n    font-family: Courier, Courier New;\n    font-weight: bold;\n\n    margin: 0px;\n    padding-left: 1em;\n    padding-right: 1em;\n    outline-width: 1px;\n    outline-style: solid;\n    outline-color: blue;\n}\ntr.courseRounding > td {\n    font-family: Courier, Courier New;\n\n    margin: 0px;\n    padding-left: 1em;\n    padding-right: 1em;\n    outline-width: 1px;\n    outline-style: solid;\n    outline-color: blue;\n}\n\ntd.courseRoundingNumber, td.courseRoundingToNextMark {\n    text-align: right;\n    white-space: pre;\n}\ntd.courseRoundingName, td.courseRoundingDirection {\n    text-align: center;\n}\n\ncircle.star {\n    fill: white;\n    stroke: none;\n}\n\ncircle.gridAE {\n    stroke: #f77;\n    fill: none;\n}\npath.gridAE {\n    stroke: #f77;\n    fill: none;\n}\n\ntext.direction {\n    color: red\n}\n",""]);const a=o},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var u=[].concat(t[h]);i&&o[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),s&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=s):u[4]="".concat(s)),e.push(u))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var l=t[a],h=i.base?l[0]+i.base:l[0],u=r[h]||0,c="".concat(h," ").concat(u);r[h]=u+1;var d=n(c),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var g=s(p,i);i.byIndex=a,e.splice(a,0,{identifier:c,updater:g,references:1})}o.push(c)}return o}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var r=i(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=n(r[o]);e[a].references--}for(var l=i(t,s),h=0;h<r.length;h++){var u=n(r[h]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}r=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3654:()=>{}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(){}function e(e){return null==e?t:function(){return this.querySelector(e)}}function i(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function s(){return[]}function r(t){return null==t?s:function(){return this.querySelectorAll(t)}}function o(t){return function(){return this.matches(t)}}function a(t){return function(e){return e.matches(t)}}var l=Array.prototype.find;function h(){return this.firstElementChild}var u=Array.prototype.filter;function c(){return Array.from(this.children)}function d(t){return new Array(t.length)}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function g(t){return function(){return t}}function f(t,e,n,i,s,r){for(var o,a=0,l=e.length,h=r.length;a<h;++a)(o=e[a])?(o.__data__=r[a],i[a]=o):n[a]=new p(t,r[a]);for(;a<l;++a)(o=e[a])&&(s[a]=o)}function m(t,e,n,i,s,r,o){var a,l,h,u=new Map,c=e.length,d=r.length,g=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(g[a]=h=o.call(l,l.__data__,a,e)+"",u.has(h)?s[a]=l:u.set(h,l));for(a=0;a<d;++a)h=o.call(t,r[a],a,r)+"",(l=u.get(h))?(i[a]=l,l.__data__=r[a],u.delete(h)):n[a]=new p(t,r[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(g[a])===l&&(s[a]=l)}function x(t){return t.__data__}function E(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function S(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var T="http://www.w3.org/1999/xhtml";const _={svg:"http://www.w3.org/2000/svg",xhtml:T,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function v(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),_.hasOwnProperty(e)?{space:_[e],local:t}:t}function A(t){return function(){this.removeAttribute(t)}}function N(t){return function(){this.removeAttributeNS(t.space,t.local)}}function y(t,e){return function(){this.setAttribute(t,e)}}function C(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function M(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function L(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function w(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function R(t){return function(){this.style.removeProperty(t)}}function k(t,e,n){return function(){this.style.setProperty(t,e,n)}}function I(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function D(t,e){return t.style.getPropertyValue(e)||w(t).getComputedStyle(t,null).getPropertyValue(e)}function b(t){return function(){delete this[t]}}function O(t,e){return function(){this[t]=e}}function P(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function F(t){return t.trim().split(/^|\s+/)}function U(t){return t.classList||new z(t)}function z(t){this._node=t,this._names=F(t.getAttribute("class")||"")}function B(t,e){for(var n=U(t),i=-1,s=e.length;++i<s;)n.add(e[i])}function H(t,e){for(var n=U(t),i=-1,s=e.length;++i<s;)n.remove(e[i])}function G(t){return function(){B(this,t)}}function V(t){return function(){H(this,t)}}function X(t,e){return function(){(e.apply(this,arguments)?B:H)(this,t)}}function $(){this.textContent=""}function Y(t){return function(){this.textContent=t}}function j(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function q(){this.innerHTML=""}function W(t){return function(){this.innerHTML=t}}function K(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function J(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===T&&e.documentElement.namespaceURI===T?e.createElement(t):e.createElementNS(n,t)}}function tt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function et(t){var e=v(t);return(e.local?tt:Z)(e)}function nt(){return null}function it(){var t=this.parentNode;t&&t.removeChild(this)}function st(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ot(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function at(t){return function(){var e=this.__on;if(e){for(var n,i=0,s=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++s]=n:this.removeEventListener(n.type,n.listener,n.options);++s?e.length=s:delete this.__on}}}function lt(t,e,n){return function(){var i,s=this.__on,r=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var o=0,a=s.length;o<a;++o)if((i=s[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=r,i.options=n),void(i.value=e);this.addEventListener(t.type,r,n),i={type:t.type,name:t.name,value:e,listener:r,options:n},s?s.push(i):this.__on=[i]}}function ht(t,e,n){var i=w(t),s=i.CustomEvent;"function"==typeof s?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function ut(t,e){return function(){return ht(this,t,e)}}function ct(t,e){return function(){return ht(this,t,e.apply(this,arguments))}}z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var dt=[null];function pt(t,e){this._groups=t,this._parents=e}function gt(){return new pt([[document.documentElement]],dt)}pt.prototype=gt.prototype={constructor:pt,select:function(t){"function"!=typeof t&&(t=e(t));for(var n=this._groups,i=n.length,s=new Array(i),r=0;r<i;++r)for(var o,a,l=n[r],h=l.length,u=s[r]=new Array(h),c=0;c<h;++c)(o=l[c])&&(a=t.call(o,o.__data__,c,l))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new pt(s,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return i(t.apply(this,arguments))}}(t):r(t);for(var e=this._groups,n=e.length,s=[],o=[],a=0;a<n;++a)for(var l,h=e[a],u=h.length,c=0;c<u;++c)(l=h[c])&&(s.push(t.call(l,l.__data__,c,h)),o.push(l));return new pt(s,o)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return l.call(this.children,t)}}("function"==typeof t?t:a(t)))},selectChildren:function(t){return this.selectAll(null==t?c:function(t){return function(){return u.call(this.children,t)}}("function"==typeof t?t:a(t)))},filter:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r,a=e[s],l=a.length,h=i[s]=[],u=0;u<l;++u)(r=a[u])&&t.call(r,r.__data__,u,a)&&h.push(r);return new pt(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,x);var n=e?m:f,i=this._parents,s=this._groups;"function"!=typeof t&&(t=g(t));for(var r=s.length,o=new Array(r),a=new Array(r),l=new Array(r),h=0;h<r;++h){var u=i[h],c=s[h],d=c.length,p=E(t.call(u,u&&u.__data__,h,i)),S=p.length,T=a[h]=new Array(S),_=o[h]=new Array(S),v=l[h]=new Array(d);n(u,c,T,_,v,p,e);for(var A,N,y=0,C=0;y<S;++y)if(A=T[y]){for(y>=C&&(C=y+1);!(N=_[C])&&++C<S;);A._next=N||null}}return(o=new pt(o,i))._enter=a,o._exit=l,o},enter:function(){return new pt(this._enter||this._groups.map(d),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(d),this._parents)},join:function(t,e,n){var i=this.enter(),s=this,r=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(s=e(s))&&(s=s.selection()),null==n?r.remove():n(r),i&&s?i.merge(s).order():s},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,s=n.length,r=i.length,o=Math.min(s,r),a=new Array(s),l=0;l<o;++l)for(var h,u=n[l],c=i[l],d=u.length,p=a[l]=new Array(d),g=0;g<d;++g)(h=u[g]||c[g])&&(p[g]=h);for(;l<s;++l)a[l]=n[l];return new pt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,s=t[e],r=s.length-1,o=s[r];--r>=0;)(i=s[r])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=S);for(var n=this._groups,i=n.length,s=new Array(i),r=0;r<i;++r){for(var o,a=n[r],l=a.length,h=s[r]=new Array(l),u=0;u<l;++u)(o=a[u])&&(h[u]=o);h.sort(e)}return new pt(s,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],s=0,r=i.length;s<r;++s){var o=i[s];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s,r=e[n],o=0,a=r.length;o<a;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this},attr:function(t,e){var n=v(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?N:A:"function"==typeof e?n.local?L:M:n.local?C:y)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?R:"function"==typeof e?I:k)(t,e,null==n?"":n)):D(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?b:"function"==typeof e?P:O)(t,e)):this.node()[t]},classed:function(t,e){var n=F(t+"");if(arguments.length<2){for(var i=U(this.node()),s=-1,r=n.length;++s<r;)if(!i.contains(n[s]))return!1;return!0}return this.each(("function"==typeof e?X:e?G:V)(n,e))},text:function(t){return arguments.length?this.each(null==t?$:("function"==typeof t?j:Y)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?q:("function"==typeof t?K:W)(t)):this.node().innerHTML},raise:function(){return this.each(J)},lower:function(){return this.each(Q)},append:function(t){var e="function"==typeof t?t:et(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,n){var i="function"==typeof t?t:et(t),s=null==n?nt:"function"==typeof n?n:e(n);return this.select((function(){return this.insertBefore(i.apply(this,arguments),s.apply(this,arguments)||null)}))},remove:function(){return this.each(it)},clone:function(t){return this.select(t?rt:st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,s,r=ot(t+""),o=r.length;if(!(arguments.length<2)){for(a=e?lt:at,i=0;i<o;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(i=0,l=a[h];i<o;++i)if((s=r[i]).type===l.type&&s.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ct:ut)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,s=t[e],r=0,o=s.length;r<o;++r)(i=s[r])&&(yield i)}};const ft=gt;var mt={value:()=>{}};function xt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Et(i)}function Et(t){this._=t}function St(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Tt(t,e){for(var n,i=0,s=t.length;i<s;++i)if((n=t[i]).name===e)return n.value}function _t(t,e,n){for(var i=0,s=t.length;i<s;++i)if(t[i].name===e){t[i]=mt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Et.prototype=xt.prototype={constructor:Et,on:function(t,e){var n,i=this._,s=St(t+"",i),r=-1,o=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<o;)if(n=(t=s[r]).type)i[n]=_t(i[n],t.name,e);else if(null==e)for(n in i)i[n]=_t(i[n],t.name,null);return this}for(;++r<o;)if((n=(t=s[r]).type)&&(n=Tt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Et(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,s=new Array(n),r=0;r<n;++r)s[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,s)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],s=0,r=i.length;s<r;++s)i[s].value.apply(e,n)}};const vt=xt;var At,Nt,yt=0,Ct=0,Mt=0,Lt=0,wt=0,Rt=0,kt="object"==typeof performance&&performance.now?performance:Date,It="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Dt(){return wt||(It(bt),wt=kt.now()+Rt)}function bt(){wt=0}function Ot(){this._call=this._time=this._next=null}function Pt(t,e,n){var i=new Ot;return i.restart(t,e,n),i}function Ft(){wt=(Lt=kt.now())+Rt,yt=Ct=0;try{!function(){Dt(),++yt;for(var t,e=At;e;)(t=wt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yt}()}finally{yt=0,function(){for(var t,e,n=At,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:At=e);Nt=t,zt(i)}(),wt=0}}function Ut(){var t=kt.now(),e=t-Lt;e>1e3&&(Rt-=e,Lt=t)}function zt(t){yt||(Ct&&(Ct=clearTimeout(Ct)),t-wt>24?(t<1/0&&(Ct=setTimeout(Ft,t-kt.now()-Rt)),Mt&&(Mt=clearInterval(Mt))):(Mt||(Lt=kt.now(),Mt=setInterval(Ut,1e3)),yt=1,It(Ft)))}function Bt(t,e,n){var i=new Ot;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}Ot.prototype=Pt.prototype={constructor:Ot,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Dt():+n)+(null==e?0:+e),this._next||Nt===this||(Nt?Nt._next=this:At=this,Nt=this),this._call=t,this._time=n,zt()},stop:function(){this._call&&(this._call=null,this._time=1/0,zt())}};var Ht=vt("start","end","cancel","interrupt"),Gt=[];function Vt(t,e,n,i,s,r){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,s=t.__transition;function r(l){var h,u,c,d;if(1!==n.state)return a();for(h in s)if((d=s[h]).name===n.name){if(3===d.state)return Bt(r);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete s[h]):+h<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete s[h])}if(Bt((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(c=n.tween.length),h=0,u=-1;h<c;++h)(d=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function o(e){for(var s=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),r=-1,o=i.length;++r<o;)i[r].call(t,s);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=n,n.timer=Pt((function(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:s,on:Ht,tween:Gt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function Xt(t,e){var n=Yt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function $t(t,e){var n=Yt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Yt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function jt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var qt,Wt=180/Math.PI,Kt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jt(t,e,n,i,s,r){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:s,translateY:r,rotate:Math.atan2(e,t)*Wt,skewX:Math.atan(l)*Wt,scaleX:o,scaleY:a}}function Qt(t,e,n,i){function s(t){return t.length?t.pop()+" ":""}return function(r,o){var a=[],l=[];return r=t(r),o=t(o),function(t,i,s,r,o,a){if(t!==s||i!==r){var l=o.push("translate(",null,e,null,n);a.push({i:l-4,x:jt(t,s)},{i:l-2,x:jt(i,r)})}else(s||r)&&o.push("translate("+s+e+r+n)}(r.translateX,r.translateY,o.translateX,o.translateY,a,l),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(s(n)+"rotate(",null,i)-2,x:jt(t,e)})):e&&n.push(s(n)+"rotate("+e+i)}(r.rotate,o.rotate,a,l),function(t,e,n,r){t!==e?r.push({i:n.push(s(n)+"skewX(",null,i)-2,x:jt(t,e)}):e&&n.push(s(n)+"skewX("+e+i)}(r.skewX,o.skewX,a,l),function(t,e,n,i,r,o){if(t!==n||e!==i){var a=r.push(s(r)+"scale(",null,",",null,")");o.push({i:a-4,x:jt(t,n)},{i:a-2,x:jt(e,i)})}else 1===n&&1===i||r.push(s(r)+"scale("+n+","+i+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,a,l),r=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Zt=Qt((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Kt:Jt(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),te=Qt((function(t){return null==t?Kt:(qt||(qt=document.createElementNS("http://www.w3.org/2000/svg","g")),qt.setAttribute("transform",t),(t=qt.transform.baseVal.consolidate())?Jt((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Kt)}),", ",")",")");function ee(t,e){var n,i;return function(){var s=$t(this,t),r=s.tween;if(r!==n)for(var o=0,a=(i=n=r).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}s.tween=i}}function ne(t,e,n){var i,s;if("function"!=typeof n)throw new Error;return function(){var r=$t(this,t),o=r.tween;if(o!==i){s=(i=o).slice();for(var a={name:e,value:n},l=0,h=s.length;l<h;++l)if(s[l].name===e){s[l]=a;break}l===h&&s.push(a)}r.tween=s}}function ie(t,e,n){var i=t._id;return t.each((function(){var t=$t(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Yt(t,i).value[e]}}function se(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function re(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function oe(){}var ae=.7,le=1/ae,he="\\s*([+-]?\\d+)\\s*",ue="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ce="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",de=/^#([0-9a-f]{3,8})$/,pe=new RegExp("^rgb\\("+[he,he,he]+"\\)$"),ge=new RegExp("^rgb\\("+[ce,ce,ce]+"\\)$"),fe=new RegExp("^rgba\\("+[he,he,he,ue]+"\\)$"),me=new RegExp("^rgba\\("+[ce,ce,ce,ue]+"\\)$"),xe=new RegExp("^hsl\\("+[ue,ce,ce]+"\\)$"),Ee=new RegExp("^hsla\\("+[ue,ce,ce,ue]+"\\)$"),Se={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Te(){return this.rgb().formatHex()}function _e(){return this.rgb().formatRgb()}function ve(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=de.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ae(e):3===n?new Me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ne(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ne(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=pe.exec(t))?new Me(e[1],e[2],e[3],1):(e=ge.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=fe.exec(t))?Ne(e[1],e[2],e[3],e[4]):(e=me.exec(t))?Ne(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=xe.exec(t))?ke(e[1],e[2]/100,e[3]/100,1):(e=Ee.exec(t))?ke(e[1],e[2]/100,e[3]/100,e[4]):Se.hasOwnProperty(t)?Ae(Se[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function Ae(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function Ne(t,e,n,i){return i<=0&&(t=e=n=NaN),new Me(t,e,n,i)}function ye(t){return t instanceof oe||(t=ve(t)),t?new Me((t=t.rgb()).r,t.g,t.b,t.opacity):new Me}function Ce(t,e,n,i){return 1===arguments.length?ye(t):new Me(t,e,n,null==i?1:i)}function Me(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Le(){return"#"+Re(this.r)+Re(this.g)+Re(this.b)}function we(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Re(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ke(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new De(t,e,n,i)}function Ie(t){if(t instanceof De)return new De(t.h,t.s,t.l,t.opacity);if(t instanceof oe||(t=ve(t)),!t)return new De;if(t instanceof De)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,s=Math.min(e,n,i),r=Math.max(e,n,i),o=NaN,a=r-s,l=(r+s)/2;return a?(o=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=l<.5?r+s:2-r-s,o*=60):a=l>0&&l<1?0:o,new De(o,a,l,t.opacity)}function De(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function be(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Oe(t,e,n,i,s){var r=t*t,o=r*t;return((1-3*t+3*r-o)*e+(4-6*r+3*o)*n+(1+3*t+3*r-3*o)*i+o*s)/6}se(oe,ve,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Te,formatHex:Te,formatHsl:function(){return Ie(this).formatHsl()},formatRgb:_e,toString:_e}),se(Me,Ce,re(oe,{brighter:function(t){return t=null==t?le:Math.pow(le,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ae:Math.pow(ae,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Le,formatHex:Le,formatRgb:we,toString:we})),se(De,(function(t,e,n,i){return 1===arguments.length?Ie(t):new De(t,e,n,null==i?1:i)}),re(oe,{brighter:function(t){return t=null==t?le:Math.pow(le,t),new De(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ae:Math.pow(ae,t),new De(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,s=2*n-i;return new Me(be(t>=240?t-240:t+120,s,i),be(t,s,i),be(t<120?t+240:t-120,s,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const Pe=t=>()=>t;function Fe(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Pe(isNaN(t)?e:t)}const Ue=function t(e){var n=function(t){return 1==(t=+t)?Fe:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Pe(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Ce(t)).r,(e=Ce(e)).r),s=n(t.g,e.g),r=n(t.b,e.b),o=Fe(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=s(e),t.b=r(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function ze(t){return function(e){var n,i,s=e.length,r=new Array(s),o=new Array(s),a=new Array(s);for(n=0;n<s;++n)i=Ce(e[n]),r[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return r=t(r),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=r(t),i.g=o(t),i.b=a(t),i+""}}}ze((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),s=t[i],r=t[i+1],o=i>0?t[i-1]:2*s-r,a=i<e-1?t[i+2]:2*r-s;return Oe((n-i/e)*e,o,s,r,a)}})),ze((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),s=t[(i+e-1)%e],r=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return Oe((n-i/e)*e,s,r,o,a)}}));var Be=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,He=new RegExp(Be.source,"g");function Ge(t,e){var n,i,s,r=Be.lastIndex=He.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=Be.exec(t))&&(i=He.exec(e));)(s=i.index)>r&&(s=e.slice(r,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:jt(n,i)})),r=He.lastIndex;return r<e.length&&(s=e.slice(r),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Ve(t,e){var n;return("number"==typeof e?jt:e instanceof ve?Ue:(n=ve(e))?(e=n,Ue):Ge)(t,e)}function Xe(t){return function(){this.removeAttribute(t)}}function $e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ye(t,e,n){var i,s,r=n+"";return function(){var o=this.getAttribute(t);return o===r?null:o===i?s:s=e(i=o,n)}}function je(t,e,n){var i,s,r=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===r?null:o===i?s:s=e(i=o,n)}}function qe(t,e,n){var i,s,r;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===i&&a===s?r:(s=a,r=e(i=o,l));this.removeAttribute(t)}}function We(t,e,n){var i,s,r;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===i&&a===s?r:(s=a,r=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function Ke(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Je(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Qe(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Je(t,s)),n}return s._value=e,s}function Ze(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Ke(t,s)),n}return s._value=e,s}function tn(t,e){return function(){Xt(this,t).delay=+e.apply(this,arguments)}}function en(t,e){return e=+e,function(){Xt(this,t).delay=e}}function nn(t,e){return function(){$t(this,t).duration=+e.apply(this,arguments)}}function sn(t,e){return e=+e,function(){$t(this,t).duration=e}}function rn(t,e){if("function"!=typeof e)throw new Error;return function(){$t(this,t).ease=e}}function on(t,e,n){var i,s,r=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Xt:$t;return function(){var o=r(this,t),a=o.on;a!==i&&(s=(i=a).copy()).on(e,n),o.on=s}}var an=ft.prototype.constructor;function ln(t){return function(){this.style.removeProperty(t)}}function hn(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function un(t,e,n){var i,s;function r(){var r=e.apply(this,arguments);return r!==s&&(i=(s=r)&&hn(t,r,n)),i}return r._value=e,r}function cn(t){return function(e){this.textContent=t.call(this,e)}}function dn(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&cn(i)),e}return i._value=t,i}var pn=0;function gn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function fn(){return++pn}var mn=ft.prototype;gn.prototype=function(t){return ft().transition(t)}.prototype={constructor:gn,select:function(t){var n=this._name,i=this._id;"function"!=typeof t&&(t=e(t));for(var s=this._groups,r=s.length,o=new Array(r),a=0;a<r;++a)for(var l,h,u=s[a],c=u.length,d=o[a]=new Array(c),p=0;p<c;++p)(l=u[p])&&(h=t.call(l,l.__data__,p,u))&&("__data__"in l&&(h.__data__=l.__data__),d[p]=h,Vt(d[p],n,i,p,d,Yt(l,i)));return new gn(o,this._parents,n,i)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=r(t));for(var i=this._groups,s=i.length,o=[],a=[],l=0;l<s;++l)for(var h,u=i[l],c=u.length,d=0;d<c;++d)if(h=u[d]){for(var p,g=t.call(h,h.__data__,d,u),f=Yt(h,n),m=0,x=g.length;m<x;++m)(p=g[m])&&Vt(p,e,n,m,g,f);o.push(g),a.push(h)}return new gn(o,a,e,n)},selectChild:mn.selectChild,selectChildren:mn.selectChildren,filter:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r,a=e[s],l=a.length,h=i[s]=[],u=0;u<l;++u)(r=a[u])&&t.call(r,r.__data__,u,a)&&h.push(r);return new gn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,s=n.length,r=Math.min(i,s),o=new Array(i),a=0;a<r;++a)for(var l,h=e[a],u=n[a],c=h.length,d=o[a]=new Array(c),p=0;p<c;++p)(l=h[p]||u[p])&&(d[p]=l);for(;a<i;++a)o[a]=e[a];return new gn(o,this._parents,this._name,this._id)},selection:function(){return new an(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=fn(),i=this._groups,s=i.length,r=0;r<s;++r)for(var o,a=i[r],l=a.length,h=0;h<l;++h)if(o=a[h]){var u=Yt(o,e);Vt(o,t,n,h,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new gn(i,this._parents,t,n)},call:mn.call,nodes:mn.nodes,node:mn.node,size:mn.size,empty:mn.empty,each:mn.each,on:function(t,e){var n=this._id;return arguments.length<2?Yt(this.node(),n).on.on(t):this.each(on(n,t,e))},attr:function(t,e){var n=v(t),i="transform"===n?te:Ve;return this.attrTween(t,"function"==typeof e?(n.local?We:qe)(n,i,ie(this,"attr."+t,e)):null==e?(n.local?$e:Xe)(n):(n.local?je:Ye)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=v(t);return this.tween(n,(i.local?Qe:Ze)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Zt:Ve;return null==e?this.styleTween(t,function(t,e){var n,i,s;return function(){var r=D(this,t),o=(this.style.removeProperty(t),D(this,t));return r===o?null:r===n&&o===i?s:s=e(n=r,i=o)}}(t,i)).on("end.style."+t,ln(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,s,r;return function(){var o=D(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=D(this,t)),o===l?null:o===i&&l===s?r:(s=l,r=e(i=o,a))}}(t,i,ie(this,"style."+t,e))).each(function(t,e){var n,i,s,r,o="style."+e,a="end."+o;return function(){var l=$t(this,t),h=l.on,u=null==l.value[o]?r||(r=ln(e)):void 0;h===n&&s===u||(i=(n=h).copy()).on(a,s=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,s,r=n+"";return function(){var o=D(this,t);return o===r?null:o===i?s:s=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,un(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ie(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,dn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,s=Yt(this.node(),n).tween,r=0,o=s.length;r<o;++r)if((i=s[r]).name===t)return i.value;return null}return this.each((null==e?ee:ne)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?tn:en)(e,t)):Yt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?nn:sn)(e,t)):Yt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(rn(e,t)):Yt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;$t(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,s=n.size();return new Promise((function(r,o){var a={value:o},l={value:function(){0==--s&&r()}};n.each((function(){var n=$t(this,i),s=n.on;s!==t&&((e=(t=s).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===s&&r()}))},[Symbol.iterator]:mn[Symbol.iterator]};var xn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function En(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}ft.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,s,r=t.__transition,o=!0;if(r){for(s in e=null==e?null:e+"",r)(n=r[s]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]):o=!1;o&&delete t.__transition}}(this,t)}))},ft.prototype.transition=function(t){var e,n;t instanceof gn?(e=t._id,t=t._name):(e=fn(),(n=xn).time=Dt(),t=null==t?null:t+"");for(var i=this._groups,s=i.length,r=0;r<s;++r)for(var o,a=i[r],l=a.length,h=0;h<l;++h)(o=a[h])&&Vt(o,t,e,h,a,n||En(o,e));return new gn(i,this._parents,t,e)};const{abs:Sn,max:Tn,min:_n}=Math;function vn(t){return{type:t}}["w","e"].map(vn),["n","s"].map(vn),["n","w","e","s","nw","ne","sw","se"].map(vn);var An={},Nn={};function yn(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Cn(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var i in t)i in e||n.push(e[i]=i)})),n}function Mn(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function Ln(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var i,s=[],r=t.length,o=0,a=0,l=r<=0,h=!1;function u(){if(l)return Nn;if(h)return h=!1,An;var e,i,s=o;if(34===t.charCodeAt(s)){for(;o++<r&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=r?l=!0:10===(i=t.charCodeAt(o++))?h=!0:13===i&&(h=!0,10===t.charCodeAt(o)&&++o),t.slice(s+1,e-1).replace(/""/g,'"')}for(;o<r;){if(10===(i=t.charCodeAt(e=o++)))h=!0;else if(13===i)h=!0,10===t.charCodeAt(o)&&++o;else if(i!==n)continue;return t.slice(s,e)}return l=!0,t.slice(s,r)}for(10===t.charCodeAt(r-1)&&--r,13===t.charCodeAt(r-1)&&--r;(i=u())!==Nn;){for(var c=[];i!==An&&i!==Nn;)c.push(i),i=u();e&&null==(c=e(c,a++))||s.push(c)}return s}function s(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function r(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?(s=(n=t).getUTCHours(),r=n.getUTCMinutes(),o=n.getUTCSeconds(),a=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":((i=n.getUTCFullYear())<0?"-"+Mn(-i,6):i>9999?"+"+Mn(i,6):Mn(i,4))+"-"+Mn(n.getUTCMonth()+1,2)+"-"+Mn(n.getUTCDate(),2)+(a?"T"+Mn(s,2)+":"+Mn(r,2)+":"+Mn(o,2)+"."+Mn(a,3)+"Z":o?"T"+Mn(s,2)+":"+Mn(r,2)+":"+Mn(o,2)+"Z":r||s?"T"+Mn(s,2)+":"+Mn(r,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var n,i,s,r,o,a}return{parse:function(t,e){var n,s,r=i(t,(function(t,i){if(n)return n(t,i-1);s=t,n=e?function(t,e){var n=yn(t);return function(i,s){return e(n(i),s,t)}}(t,e):yn(t)}));return r.columns=s||[],r},parseRows:i,format:function(e,n){return null==n&&(n=Cn(e)),[n.map(o).join(t)].concat(s(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Cn(t)),s(t,e).join("\n")},formatRows:function(t){return t.map(r).join("\n")},formatRow:r,formatValue:o}}var wn=Ln(","),Rn=wn.parse,kn=(wn.parseRows,wn.format,wn.formatBody,wn.formatRows,wn.formatRow,wn.formatValue,Ln("\t")),In=kn.parse;function Dn(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function bn(t,e){return fetch(t,e).then(Dn)}function On(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=void 0),bn(e,n).then((function(e){return t(e,i)}))}}kn.parseRows,kn.format,kn.formatBody,kn.formatRows,kn.formatRow,kn.formatValue;var Pn=On(Rn);function Fn(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function Un(t,e){return fetch(t,e).then(Fn)}On(In);const zn=t=>t;function Bn(t,e){t&&Gn.hasOwnProperty(t.type)&&Gn[t.type](t,e)}var Hn={Feature:function(t,e){Bn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,s=n.length;++i<s;)Bn(n[i].geometry,e)}},Gn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Vn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)Vn(n[i],e,0)},Polygon:function(t,e){Xn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)Xn(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,s=n.length;++i<s;)Bn(n[i],e)}};function Vn(t,e,n){var i,s=-1,r=t.length-n;for(e.lineStart();++s<r;)i=t[s],e.point(i[0],i[1],i[2]);e.lineEnd()}function Xn(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Vn(t[n],e,1);e.polygonEnd()}function $n(t,e){t&&Hn.hasOwnProperty(t.type)?Hn[t.type](t,e):Bn(t,e)}class Yn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const s=e[i],r=t+s,o=Math.abs(t)<Math.abs(s)?t-(r-s):s-(r-t);o&&(e[n++]=o),t=r}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,s=this._n,r=0;if(s>0){for(r=t[--s];s>0&&(e=r,n=t[--s],r=e+n,i=n-(r-e),!i););s>0&&(i<0&&t[s-1]<0||i>0&&t[s-1]>0)&&(n=2*i,e=r+n,n==e-r&&(r=e))}return r}}var jn=1e-6,qn=Math.PI,Wn=qn/2,Kn=qn/4,Jn=2*qn,Qn=180/qn,Zn=qn/180,ti=Math.abs,ei=Math.atan,ni=Math.atan2,ii=Math.cos,si=(Math.ceil,Math.exp),ri=(Math.floor,Math.hypot,Math.log),oi=Math.pow,ai=Math.sin,li=Math.sign||function(t){return t>0?1:t<0?-1:0},hi=Math.sqrt,ui=Math.tan;function ci(t){return t>1?Wn:t<-1?-Wn:Math.asin(t)}function di(){}var pi,gi,fi,mi,xi=new Yn,Ei=new Yn,Si={point:di,lineStart:di,lineEnd:di,polygonStart:function(){Si.lineStart=Ti,Si.lineEnd=Ai},polygonEnd:function(){Si.lineStart=Si.lineEnd=Si.point=di,xi.add(ti(Ei)),Ei=new Yn},result:function(){var t=xi/2;return xi=new Yn,t}};function Ti(){Si.point=_i}function _i(t,e){Si.point=vi,pi=fi=t,gi=mi=e}function vi(t,e){Ei.add(mi*t-fi*e),fi=t,mi=e}function Ai(){vi(pi,gi)}const Ni=Si;var yi=1/0,Ci=yi,Mi=-yi,Li=Mi;const wi={point:function(t,e){t<yi&&(yi=t),t>Mi&&(Mi=t),e<Ci&&(Ci=e),e>Li&&(Li=e)},lineStart:di,lineEnd:di,polygonStart:di,polygonEnd:di,result:function(){var t=[[yi,Ci],[Mi,Li]];return Mi=Li=-(Ci=yi=1/0),t}};var Ri,ki,Ii,Di,bi=0,Oi=0,Pi=0,Fi=0,Ui=0,zi=0,Bi=0,Hi=0,Gi=0,Vi={point:Xi,lineStart:$i,lineEnd:qi,polygonStart:function(){Vi.lineStart=Wi,Vi.lineEnd=Ki},polygonEnd:function(){Vi.point=Xi,Vi.lineStart=$i,Vi.lineEnd=qi},result:function(){var t=Gi?[Bi/Gi,Hi/Gi]:zi?[Fi/zi,Ui/zi]:Pi?[bi/Pi,Oi/Pi]:[NaN,NaN];return bi=Oi=Pi=Fi=Ui=zi=Bi=Hi=Gi=0,t}};function Xi(t,e){bi+=t,Oi+=e,++Pi}function $i(){Vi.point=Yi}function Yi(t,e){Vi.point=ji,Xi(Ii=t,Di=e)}function ji(t,e){var n=t-Ii,i=e-Di,s=hi(n*n+i*i);Fi+=s*(Ii+t)/2,Ui+=s*(Di+e)/2,zi+=s,Xi(Ii=t,Di=e)}function qi(){Vi.point=Xi}function Wi(){Vi.point=Ji}function Ki(){Qi(Ri,ki)}function Ji(t,e){Vi.point=Qi,Xi(Ri=Ii=t,ki=Di=e)}function Qi(t,e){var n=t-Ii,i=e-Di,s=hi(n*n+i*i);Fi+=s*(Ii+t)/2,Ui+=s*(Di+e)/2,zi+=s,Bi+=(s=Di*t-Ii*e)*(Ii+t),Hi+=s*(Di+e),Gi+=3*s,Xi(Ii=t,Di=e)}const Zi=Vi;function ts(t){this._context=t}ts.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Jn)}},result:di};var es,ns,is,ss,rs,os=new Yn,as={point:di,lineStart:function(){as.point=ls},lineEnd:function(){es&&hs(ns,is),as.point=di},polygonStart:function(){es=!0},polygonEnd:function(){es=null},result:function(){var t=+os;return os=new Yn,t}};function ls(t,e){as.point=hs,ns=ss=t,is=rs=e}function hs(t,e){ss-=t,rs-=e,os.add(hi(ss*ss+rs*rs)),ss=t,rs=e}const us=as;function cs(){this._string=[]}function ds(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function ps(t,e){var n,i,s=4.5;function r(t){return t&&("function"==typeof s&&i.pointRadius(+s.apply(this,arguments)),$n(t,n(i))),i.result()}return r.area=function(t){return $n(t,n(Ni)),Ni.result()},r.measure=function(t){return $n(t,n(us)),us.result()},r.bounds=function(t){return $n(t,n(wi)),wi.result()},r.centroid=function(t){return $n(t,n(Zi)),Zi.result()},r.projection=function(e){return arguments.length?(n=null==e?(t=null,zn):(t=e).stream,r):t},r.context=function(t){return arguments.length?(i=null==t?(e=null,new cs):new ts(e=t),"function"!=typeof s&&i.pointRadius(s),r):e},r.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(i.pointRadius(+t),+t),r):s},r.projection(t).context(e)}function gs(){var t,e=[];return{point:function(e,n,i){t.push([e,n,i])},lineStart:function(){e.push(t=[])},lineEnd:di,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function fs(t,e){return ti(t[0]-e[0])<jn&&ti(t[1]-e[1])<jn}function ms(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function xs(t,e,n,i,s){var r,o,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],o=t[e];if(fs(i,o)){if(!i[2]&&!o[2]){for(s.lineStart(),r=0;r<e;++r)s.point((i=t[r])[0],i[1]);return void s.lineEnd()}o[0]+=2e-6}a.push(n=new ms(i,t,null,!0)),l.push(n.o=new ms(i,null,n,!1)),a.push(n=new ms(o,t,null,!1)),l.push(n.o=new ms(o,null,n,!0))}})),a.length){for(l.sort(e),Es(a),Es(l),r=0,o=l.length;r<o;++r)l[r].e=n=!n;for(var h,u,c=a[0];;){for(var d=c,p=!0;d.v;)if((d=d.n)===c)return;h=d.z,s.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(r=0,o=h.length;r<o;++r)s.point((u=h[r])[0],u[1]);else i(d.x,d.n.x,1,s);d=d.n}else{if(p)for(h=d.p.z,r=h.length-1;r>=0;--r)s.point((u=h[r])[0],u[1]);else i(d.x,d.p.x,-1,s);d=d.p}h=(d=d.o).z,p=!p}while(!d.v);s.lineEnd()}}}function Es(t){if(e=t.length){for(var e,n,i=0,s=t[0];++i<e;)s.n=n=t[i],n.p=s,s=n;s.n=n=t[0],n.p=s}}function Ss(t){return[ni(t[1],t[0]),ci(t[2])]}function Ts(t){var e=t[0],n=t[1],i=ii(n);return[i*ii(e),i*ai(e),ai(n)]}function _s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vs(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function As(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ns(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ys(t){var e=hi(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Cs(t){return ti(t[0])<=qn?t[0]:li(t[0])*((ti(t[0])+qn)%Jn-qn)}function Ms(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function Ls(t,e,n,i){return function(s){var r,o,a,l=e(s),h=gs(),u=e(h),c=!1,d={point:p,lineStart:f,lineEnd:m,polygonStart:function(){d.point=x,d.lineStart=E,d.lineEnd=S,o=[],r=[]},polygonEnd:function(){d.point=p,d.lineStart=f,d.lineEnd=m,o=Ms(o);var t=function(t,e){var n=Cs(e),i=e[1],s=ai(i),r=[ai(n),-ii(n),0],o=0,a=0,l=new Yn;1===s?i=Wn+jn:-1===s&&(i=-Wn-jn);for(var h=0,u=t.length;h<u;++h)if(d=(c=t[h]).length)for(var c,d,p=c[d-1],g=Cs(p),f=p[1]/2+Kn,m=ai(f),x=ii(f),E=0;E<d;++E,g=T,m=v,x=A,p=S){var S=c[E],T=Cs(S),_=S[1]/2+Kn,v=ai(_),A=ii(_),N=T-g,y=N>=0?1:-1,C=y*N,M=C>qn,L=m*v;if(l.add(ni(L*y*ai(C),x*A+L*ii(C))),o+=M?N+y*Jn:N,M^g>=n^T>=n){var w=vs(Ts(p),Ts(S));ys(w);var R=vs(r,w);ys(R);var k=(M^N>=0?-1:1)*ci(R[2]);(i>k||i===k&&(w[0]||w[1]))&&(a+=M^N>=0?1:-1)}}return(o<-jn||o<jn&&l<-1e-12)^1&a}(r,i);o.length?(c||(s.polygonStart(),c=!0),xs(o,Rs,t,n,s)):t&&(c||(s.polygonStart(),c=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),c&&(s.polygonEnd(),c=!1),o=r=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function p(e,n){t(e,n)&&s.point(e,n)}function g(t,e){l.point(t,e)}function f(){d.point=g,l.lineStart()}function m(){d.point=p,l.lineEnd()}function x(t,e){a.push([t,e]),u.point(t,e)}function E(){u.lineStart(),a=[]}function S(){x(a[0][0],a[0][1]),u.lineEnd();var t,e,n,i,l=u.clean(),d=h.result(),p=d.length;if(a.pop(),r.push(a),a=null,p)if(1&l){if((e=(n=d[0]).length-1)>0){for(c||(s.polygonStart(),c=!0),s.lineStart(),t=0;t<e;++t)s.point((i=n[t])[0],i[1]);s.lineEnd()}}else p>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(ws))}return d}}function ws(t){return t.length>1}function Rs(t,e){return((t=t.x)[0]<0?t[1]-Wn-jn:Wn-t[1])-((e=e.x)[0]<0?e[1]-Wn-jn:Wn-e[1])}cs.prototype={_radius:4.5,_circle:ds(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=ds(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const ks=Ls((function(){return!0}),(function(t){var e,n=NaN,i=NaN,s=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,o){var a=r>0?qn:-qn,l=ti(r-n);ti(l-qn)<jn?(t.point(n,i=(i+o)/2>0?Wn:-Wn),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(r,i),e=0):s!==a&&l>=qn&&(ti(n-s)<jn&&(n-=s*jn),ti(r-a)<jn&&(r-=a*jn),i=function(t,e,n,i){var s,r,o=ai(t-n);return ti(o)>jn?ei((ai(e)*(r=ii(i))*ai(n)-ai(i)*(s=ii(e))*ai(t))/(s*r*o)):(e+i)/2}(n,i,r,o),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=r,i=o),s=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var s;if(null==t)s=n*Wn,i.point(-qn,s),i.point(0,s),i.point(qn,s),i.point(qn,0),i.point(qn,-s),i.point(0,-s),i.point(-qn,-s),i.point(-qn,0),i.point(-qn,s);else if(ti(t[0]-e[0])>jn){var r=t[0]<e[0]?qn:-qn;s=n*r/2,i.point(-r,s),i.point(0,s),i.point(r,s)}else i.point(e[0],e[1])}),[-qn,-Wn]);function Is(t,e){(e=Ts(e))[0]-=t,ys(e);var n,i=(n=-e[1])>1?0:n<-1?qn:Math.acos(n);return((-e[2]<0?-i:i)+Jn-jn)%Jn}function Ds(t){var e=ii(t),n=6*Zn,i=e>0,s=ti(e)>jn;function r(t,n){return ii(t)*ii(n)>e}function o(t,n,i){var s=[1,0,0],r=vs(Ts(t),Ts(n)),o=_s(r,r),a=r[0],l=o-a*a;if(!l)return!i&&t;var h=e*o/l,u=-e*a/l,c=vs(s,r),d=Ns(s,h);As(d,Ns(r,u));var p=c,g=_s(d,p),f=_s(p,p),m=g*g-f*(_s(d,d)-1);if(!(m<0)){var x=hi(m),E=Ns(p,(-g-x)/f);if(As(E,d),E=Ss(E),!i)return E;var S,T=t[0],_=n[0],v=t[1],A=n[1];_<T&&(S=T,T=_,_=S);var N=_-T,y=ti(N-qn)<jn;if(!y&&A<v&&(S=v,v=A,A=S),y||N<jn?y?v+A>0^E[1]<(ti(E[0]-T)<jn?v:A):v<=E[1]&&E[1]<=A:N>qn^(T<=E[0]&&E[0]<=_)){var C=Ns(p,(-g+x)/f);return As(C,d),[E,Ss(C)]}}}function a(e,n){var s=i?t:qn-t,r=0;return e<-s?r|=1:e>s&&(r|=2),n<-s?r|=4:n>s&&(r|=8),r}return Ls(r,(function(t){var e,n,l,h,u;return{lineStart:function(){h=l=!1,u=1},point:function(c,d){var p,g=[c,d],f=r(c,d),m=i?f?0:a(c,d):f?a(c+(c<0?qn:-qn),d):0;if(!e&&(h=l=f)&&t.lineStart(),f!==l&&(!(p=o(e,g))||fs(e,p)||fs(g,p))&&(g[2]=1),f!==l)u=0,f?(t.lineStart(),p=o(g,e),t.point(p[0],p[1])):(p=o(e,g),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(s&&e&&i^f){var x;m&n||!(x=o(g,e,!0))||(u=0,i?(t.lineStart(),t.point(x[0][0],x[0][1]),t.point(x[1][0],x[1][1]),t.lineEnd()):(t.point(x[1][0],x[1][1]),t.lineEnd(),t.lineStart(),t.point(x[0][0],x[0][1],3)))}!f||e&&fs(e,g)||t.point(g[0],g[1]),e=g,l=f,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return u|(h&&l)<<1}}}),(function(e,i,s,r){!function(t,e,n,i,s,r){if(n){var o=ii(e),a=ai(e),l=i*n;null==s?(s=e+i*Jn,r=e-l/2):(s=Is(o,s),r=Is(o,r),(i>0?s<r:s>r)&&(s+=i*Jn));for(var h,u=s;i>0?u>r:u<r;u-=l)h=Ss([o,-a*ii(u),-a*ai(u)]),t.point(h[0],h[1])}}(r,t,n,s,e,i)}),i?[0,-t]:[-qn,t-qn])}var bs=1e9,Os=-bs;function Ps(t,e,n,i){function s(s,r){return t<=s&&s<=n&&e<=r&&r<=i}function r(s,r,a,h){var u=0,c=0;if(null==s||(u=o(s,a))!==(c=o(r,a))||l(s,r)<0^a>0)do{h.point(0===u||3===u?t:n,u>1?i:e)}while((u=(u+a+4)%4)!==c);else h.point(r[0],r[1])}function o(i,s){return ti(i[0]-t)<jn?s>0?0:3:ti(i[0]-n)<jn?s>0?2:1:ti(i[1]-e)<jn?s>0?1:0:s>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var l,h,u,c,d,p,g,f,m,x,E,S=o,T=gs(),_={point:v,lineStart:function(){_.point=A,h&&h.push(u=[]),x=!0,m=!1,g=f=NaN},lineEnd:function(){l&&(A(c,d),p&&m&&T.rejoin(),l.push(T.result())),_.point=v,m&&S.lineEnd()},polygonStart:function(){S=T,l=[],h=[],E=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,s=h.length;n<s;++n)for(var r,o,a=h[n],l=1,u=a.length,c=a[0],d=c[0],p=c[1];l<u;++l)r=d,o=p,d=(c=a[l])[0],p=c[1],o<=i?p>i&&(d-r)*(i-o)>(p-o)*(t-r)&&++e:p<=i&&(d-r)*(i-o)<(p-o)*(t-r)&&--e;return e}(),n=E&&e,s=(l=Ms(l)).length;(n||s)&&(o.polygonStart(),n&&(o.lineStart(),r(null,null,1,o),o.lineEnd()),s&&xs(l,a,e,r,o),o.polygonEnd()),S=o,l=h=u=null}};function v(t,e){s(t,e)&&S.point(t,e)}function A(r,o){var a=s(r,o);if(h&&u.push([r,o]),x)c=r,d=o,p=a,x=!1,a&&(S.lineStart(),S.point(r,o));else if(a&&m)S.point(r,o);else{var l=[g=Math.max(Os,Math.min(bs,g)),f=Math.max(Os,Math.min(bs,f))],T=[r=Math.max(Os,Math.min(bs,r)),o=Math.max(Os,Math.min(bs,o))];!function(t,e,n,i,s,r){var o,a=t[0],l=t[1],h=0,u=1,c=e[0]-a,d=e[1]-l;if(o=n-a,c||!(o>0)){if(o/=c,c<0){if(o<h)return;o<u&&(u=o)}else if(c>0){if(o>u)return;o>h&&(h=o)}if(o=s-a,c||!(o<0)){if(o/=c,c<0){if(o>u)return;o>h&&(h=o)}else if(c>0){if(o<h)return;o<u&&(u=o)}if(o=i-l,d||!(o>0)){if(o/=d,d<0){if(o<h)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>h&&(h=o)}if(o=r-l,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>h&&(h=o)}else if(d>0){if(o<h)return;o<u&&(u=o)}return h>0&&(t[0]=a+h*c,t[1]=l+h*d),u<1&&(e[0]=a+u*c,e[1]=l+u*d),!0}}}}}(l,T,t,e,n,i)?a&&(S.lineStart(),S.point(r,o),E=!1):(m||(S.lineStart(),S.point(l[0],l[1])),S.point(T[0],T[1]),a||S.lineEnd(),E=!1)}g=r,f=o,m=a}return _}}function Fs(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Us(t,e){return[ti(t)>qn?t+Math.round(-t/Jn)*Jn:t,e]}function zs(t,e,n){return(t%=Jn)?e||n?Fs(Hs(t),Gs(e,n)):Hs(t):e||n?Gs(e,n):Us}function Bs(t){return function(e,n){return[(e+=t)>qn?e-Jn:e<-qn?e+Jn:e,n]}}function Hs(t){var e=Bs(t);return e.invert=Bs(-t),e}function Gs(t,e){var n=ii(t),i=ai(t),s=ii(e),r=ai(e);function o(t,e){var o=ii(e),a=ii(t)*o,l=ai(t)*o,h=ai(e),u=h*n+a*i;return[ni(l*s-u*r,a*n-h*i),ci(u*s+l*r)]}return o.invert=function(t,e){var o=ii(e),a=ii(t)*o,l=ai(t)*o,h=ai(e),u=h*s-l*r;return[ni(l*s+h*r,a*n+u*i),ci(u*n-a*i)]},o}function Vs(t){return function(e){var n=new Xs;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Xs(){}function $s(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),$n(n,t.stream(wi)),e(wi.result()),null!=i&&t.clipExtent(i),t}function Ys(t,e,n){return $s(t,(function(n){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],r=Math.min(i/(n[1][0]-n[0][0]),s/(n[1][1]-n[0][1])),o=+e[0][0]+(i-r*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(s-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),n)}Us.invert=Us,Xs.prototype={constructor:Xs,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var js=ii(30*Zn);function qs(t,e){return+e?function(t,e){function n(i,s,r,o,a,l,h,u,c,d,p,g,f,m){var x=h-i,E=u-s,S=x*x+E*E;if(S>4*e&&f--){var T=o+d,_=a+p,v=l+g,A=hi(T*T+_*_+v*v),N=ci(v/=A),y=ti(ti(v)-1)<jn||ti(r-c)<jn?(r+c)/2:ni(_,T),C=t(y,N),M=C[0],L=C[1],w=M-i,R=L-s,k=E*w-x*R;(k*k/S>e||ti((x*w+E*R)/S-.5)>.3||o*d+a*p+l*g<js)&&(n(i,s,r,o,a,l,M,L,y,T/=A,_/=A,v,f,m),m.point(M,L),n(M,L,y,T,_,v,h,u,c,d,p,g,f,m))}}return function(e){var i,s,r,o,a,l,h,u,c,d,p,g,f={point:m,lineStart:x,lineEnd:S,polygonStart:function(){e.polygonStart(),f.lineStart=T},polygonEnd:function(){e.polygonEnd(),f.lineStart=x}};function m(n,i){n=t(n,i),e.point(n[0],n[1])}function x(){u=NaN,f.point=E,e.lineStart()}function E(i,s){var r=Ts([i,s]),o=t(i,s);n(u,c,h,d,p,g,u=o[0],c=o[1],h=i,d=r[0],p=r[1],g=r[2],16,e),e.point(u,c)}function S(){f.point=m,e.lineEnd()}function T(){x(),f.point=_,f.lineEnd=v}function _(t,e){E(i=t,e),s=u,r=c,o=d,a=p,l=g,f.point=E}function v(){n(u,c,h,d,p,g,s,r,i,o,a,l,16,e),f.lineEnd=S,S()}return f}}(t,e):function(t){return Vs({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Ws=Vs({point:function(t,e){this.stream.point(t*Zn,e*Zn)}});function Ks(t,e,n,i,s,r){if(!r)return function(t,e,n,i,s){function r(r,o){return[e+t*(r*=i),n-t*(o*=s)]}return r.invert=function(r,o){return[(r-e)/t*i,(n-o)/t*s]},r}(t,e,n,i,s);var o=ii(r),a=ai(r),l=o*t,h=a*t,u=o/t,c=a/t,d=(a*n-o*e)/t,p=(a*e+o*n)/t;function g(t,r){return[l*(t*=i)-h*(r*=s)+e,n-h*t-l*r]}return g.invert=function(t,e){return[i*(u*t-c*e+d),s*(p-c*t-u*e)]},g}function Js(t){var e,n,i,s,r,o,a,l,h,u,c=150,d=480,p=250,g=0,f=0,m=0,x=0,E=0,S=0,T=1,_=1,v=null,A=ks,N=null,y=zn,C=.5;function M(t){return l(t[0]*Zn,t[1]*Zn)}function L(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Qn,t[1]*Qn]}function w(){var t=Ks(c,0,0,T,_,S).apply(null,e(g,f)),i=Ks(c,d-t[0],p-t[1],T,_,S);return n=zs(m,x,E),a=Fs(e,i),l=Fs(n,a),o=qs(a,C),R()}function R(){return h=u=null,M}return M.stream=function(t){return h&&u===t?h:h=Ws(function(t){return Vs({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(A(o(y(u=t)))))},M.preclip=function(t){return arguments.length?(A=t,v=void 0,R()):A},M.postclip=function(t){return arguments.length?(y=t,N=i=s=r=null,R()):y},M.clipAngle=function(t){return arguments.length?(A=+t?Ds(v=t*Zn):(v=null,ks),R()):v*Qn},M.clipExtent=function(t){return arguments.length?(y=null==t?(N=i=s=r=null,zn):Ps(N=+t[0][0],i=+t[0][1],s=+t[1][0],r=+t[1][1]),R()):null==N?null:[[N,i],[s,r]]},M.scale=function(t){return arguments.length?(c=+t,w()):c},M.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],w()):[d,p]},M.center=function(t){return arguments.length?(g=t[0]%360*Zn,f=t[1]%360*Zn,w()):[g*Qn,f*Qn]},M.rotate=function(t){return arguments.length?(m=t[0]%360*Zn,x=t[1]%360*Zn,E=t.length>2?t[2]%360*Zn:0,w()):[m*Qn,x*Qn,E*Qn]},M.angle=function(t){return arguments.length?(S=t%360*Zn,w()):S*Qn},M.reflectX=function(t){return arguments.length?(T=t?-1:1,w()):T<0},M.reflectY=function(t){return arguments.length?(_=t?-1:1,w()):_<0},M.precision=function(t){return arguments.length?(o=qs(a,C=t*t),R()):hi(C)},M.fitExtent=function(t,e){return Ys(M,t,e)},M.fitSize=function(t,e){return function(t,e,n){return Ys(t,[[0,0],e],n)}(M,t,e)},M.fitWidth=function(t,e){return function(t,e,n){return $s(t,(function(n){var i=+e,s=i/(n[1][0]-n[0][0]),r=(i-s*(n[1][0]+n[0][0]))/2,o=-s*n[0][1];t.scale(150*s).translate([r,o])}),n)}(M,t,e)},M.fitHeight=function(t,e){return function(t,e,n){return $s(t,(function(n){var i=+e,s=i/(n[1][1]-n[0][1]),r=-s*n[0][0],o=(i-s*(n[1][1]+n[0][1]))/2;t.scale(150*s).translate([r,o])}),n)}(M,t,e)},function(){return e=t.apply(this,arguments),M.invert=e.invert&&L,w()}}function Qs(t,e){return[t,ri(ui((Wn+e)/2))]}function Zs(t){return ui((Wn+t)/2)}function tr(t,e){var n=ii(t),i=t===e?ai(t):ri(n/ii(e))/ri(Zs(e)/Zs(t)),s=n*oi(Zs(t),i)/i;if(!i)return Qs;function r(t,e){s>0?e<-Wn+jn&&(e=-Wn+jn):e>Wn-jn&&(e=Wn-jn);var n=s/oi(Zs(e),i);return[n*ai(i*t),s-n*ii(i*t)]}return r.invert=function(t,e){var n=s-e,r=li(i)*hi(t*t+n*n),o=ni(t,ti(n))*li(n);return n*i<0&&(o-=qn*li(t)*li(n)),[o/i,2*ei(oi(s/r,1/i))-Wn]},r}function er(t){return"string"==typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],dt)}function nr(t,e,n){this.k=t,this.x=e,this.y=n}Qs.invert=function(t,e){return[t,2*ei(si(e))-Wn]},nr.prototype={constructor:nr,scale:function(t){return 1===t?this:new nr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new nr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new nr(1,0,0),nr.prototype;var ir=n(3379),sr=n.n(ir),rr=n(7795),or=n.n(rr),ar=n(569),lr=n.n(ar),hr=n(3565),ur=n.n(hr),cr=n(9216),dr=n.n(cr),pr=n(4589),gr=n.n(pr),fr=n(5150),mr={};mr.styleTagTransform=gr(),mr.setAttributes=ur(),mr.insert=lr().bind(null,"head"),mr.domAPI=or(),mr.insertStyleElement=dr(),sr()(fr.Z,mr),fr.Z&&fr.Z.locals&&fr.Z.locals;class xr{constructor(){this.handlers={Clock:[],Course:[],Definitions:[],GPS:[],Magvar:[],Mark:[],Observer:[],PointPairCalculator:[],SettingsModel:[],SettingsModelButton:[],SettingsVC:[],SettingsVCButton:[],Simulation:[],Sun:[]}}addHandler(t,e,n){if(!(t in this.handlers))throw`${e} requesting to add handler to unknown channel ${t}`;return this.handlers[t].forEach(((n,i)=>{if(n[0]==e)throw`${e} requesting to add handler to channel ${t} but already present as index ${i}`})),this.handlers[t].push([e,n]),this}removeHandler(t,e){if(!(t in this.handlers))throw`${e} requesting to remove handler from unknown channel ${t}`;let n=this.handlers[t].find((t=>t[0]==e));if(-1==n)throw`${e} requesting to remove handler from channel ${t} but is not present`;return this.handlers[t].splice(n,1),this}notify(t,e){if(!(t in this.handlers))throw`requesting notify on unknown channel ${t}`;return this.handlers[t].forEach(((t,n)=>{t[1](e)})),this}}class Er{constructor(t,e,n,i){void 0===t&&(t=null),void 0===e&&(e=(new Date).getTime()),void 0===n&&(n=1),void 0===i&&(i=!1),this.dispatcher=t,this.startTime=e,this.rate=n,this.now=new Date(e),this.isRunning=!1,i&&this.start()}tick(){this.now.setTime(this.now.getTime()+1e3),null!==this.dispatcher&&this.dispatcher.notify("Clock",this)}start(){let t=this.tick.bind(this);this.isRunning=!0,this.intervalHandler=window.setInterval(t,1e3/this.rate)}stop(){window.clearInterval(this.intervalHandler),this.intervalhandler=null,this.isRunning=!1}resetAndStart(t,e){void 0===t&&(t=(new Date).getTime()),void 0===e&&(e=1),this.startTime=t,this.rate=e,this.now=new Date(t),this.start()}get time(){return this.now.getTime()}get date(){return new Date(this.now)}}class Sr{static defaultLongitude=-122.3;static defaultLatitude=37.4;static defaultTime=(new Date).getTime();static id=0;constructor(t,e,n,i){void 0===t&&(t=null),void 0===e&&(e=Sr.defaultLongitude),void 0===n&&(n=Sr.defaultLatitude),void 0===i&&(i=Sr.defaultTime),this.dispatcher=t,this.longitude=e,this.latitude=n,this.time=i,this.updateCadence=6e4,this.updateDistance=1/60,this.id=Sr.id,this.nextTime=void 0,this.nextLocation=void 0,Sr.id+=1,this.update(),null!==this.dispatcher&&(this.dispatcher.addHandler("Clock",`Sun_${this.id}`,this.clockUpdate.bind(this)),this.dispatcher.addHandler("Observer",`Sun_${this.id}`,this.observerUpdate.bind(this)))}clockUpdate(t){void 0!==this.nextLocation&&(this.longitude=this.nextLocation.longitude,this.latitude=this.nextLocation.latitude,this.nextLocation=void 0),Math.abs(t.time-this.time)>=this.updateCadence&&(this.time=t.time,this.update(),this.notify())}observerUpdate(t){if(void 0!==this.nextTime&&(this.time=this.nextTime,this.nextTime=void 0),Math.sqrt((t.longitude-this.longitude)**2+(t.latitude-this.latitude)**2)>=this.updateDistance){let e=t.latestPosition;this.longitude=e.longitude,this.latitude=e.latitude,this.update(),this.notify()}}update(){return this.currentSolarLocation=this.solarLocation(new Date(this.time),{longitude:this.longitude,latitude:this.latitude}),this}notify(){null!==this.dispatcher&&this.dispatcher.notify("Sun",this)}poke(){this.notify()}get location(){return this.currentSolarLocation}updateDefaultObserverLocation(t){if(void 0===t.longitude)throw Error("undefined longitude");if(void 0===t.latitude)throw Error("undefined latitude");Sr.defaultLongitude=t.longitude,Sr.defaultLatitude=t.latitude}epoch1990DayNumber(t){void 0===t&&(t=new Date);const e=new Date(Date.UTC(1989,12,31,0,0,0));return(t.getTime()-e.getTime())/1e3/60/60/24}j2000DayNumber(t){void 0===t&&(t=new Date);const e=new Date(Date.UTC(2e3,0,1,11,58,55,816));return(t.getTime()-e.getTime())/1e3/60/60/24}jd(t){return void 0===t&&(t=new Date),2451545+this.j2000DayNumber(t)}earthRotationAngle(t){return(.779057273264+1.0027378119113546*this.j2000DayNumber(t))%1*360}localSiderealAngle(t,e){return this.earthRotationAngle(t)+e}solarLocation(t,e){void 0===t&&(t=new Date),void 0===e&&(e={longitude:Sr.defaultLongitude,latitude:Sr.defaultLatitude}),this.longitude=e.longitude,this.latitude=e.latitude,this.time=t.getTime();const n=Math.PI/180,i=180/Math.PI;var s=this.j2000DayNumber(t),r=(280.46+.9856474*s)%360,o=(357.528+.9856003*s)%360,a=r+1.915*Math.sin(o*n)+.02*Math.sin(2*o*n),l=23.439-4e-7*s,h=Math.atan2(Math.cos(l*n)*Math.sin(a*n),Math.cos(a*n))*i,u=Math.asin(Math.sin(l*n)*Math.sin(a*n))*i,c=this.localSiderealAngle(t,this.longitude)-h,d=Math.sin(u*n)*Math.sin(this.latitude*n)+Math.cos(u*n)*Math.cos(this.latitude*n)*Math.cos(c*n),p=Math.asin(d)*i,g=Math.acos((Math.sin(u*n)-Math.sin(this.latitude*n)*Math.sin(p*n))/(Math.cos(this.latitude*n)*Math.cos(p*n)))*i;return Math.sin(c*n)>0&&(g=360-g),{observerLongitude:this.longitude,observerLatitude:this.latitude,date:t,time:this.time,j2000dn:s,solarMeanLongitude:r,meanAnomaly:o,eclipticLongitude:a,obliquityOfEcliptic:l,rightAscention:h,declination:u,elevation:p,azimuth:g}}}function Tr(t,e){let n=null;return n=t<e?-1:e<t?1:0,n}class _r{constructor(t){void 0===t&&(t=null),this.mDispatcher=t,this.mCourses={},this.mBasicSpeed=11112/.3048/3600,this.mSpeed=this.basicSpeed,this.mCourseName="course 1",this.mRunState=!1,this.mCadence=5,this.mSimTime=0,this.mPriorClockTime=void 0,this.mLastIdx=0,this.mReady=!1,this.mLatestPosition={},null!==this.mDispatcher&&this.mDispatcher.addHandler("Clock","Simulation",this.updateClock.bind(this))}setSpeedup(t){this.mSpeed;let e=t*this.mBasicSpeed,n=this.mSpeed*this.mSimTime;this.mSimTime=n/e,this.mSpeed=e}speedInFPS(t){return void 0!==t&&(this.mSpeed=t),this.mSpeed}courseName(t){return void 0!==t&&(this.mCourseName=t),this.mCourseName}cadence(t){return void 0!==t&&(this.mCadence=cadence),this.mCadence}runState(t){return void 0!==t&&(this.mRunState=t),this.mRunState}updateClock(t){if(this.mReady&&this.mRunState){void 0===this.mPriorClockTime&&(this.mPriorClockTime=t.time),this.mSimTime+=(t.time-this.mPriorClockTime)/1e3;let e=this.mSimTime*this.mSpeed;for(;this.mLastIdx+1<this.mCourses[this.mCourseName].length&&!(this.mCourses[this.mCourseName][this.mLastIdx+1].properties.distance>e);)this.mLastIdx+=1;this.mLastIdx+1>=this.mCourses[this.mCourseName].length&&(this.mSimTime=0,this.mLastIdx=0,e=0);let n=this.mCourses[this.mCourseName][this.mLastIdx],i={timestamp:t.time,coords:{heading:n.properties.angle,longitude:n.geometry.coordinates[0],latitude:n.geometry.coordinates[1],speed:.3048*this.mSpeed}};this.mLatestPosition=i,this.mPriorClockTime=t.time,null!==this.mDispatcher&&this.mDispatcher.notify("Simulation",this)}}get latestPosition(){return this.mLatestPosition}loadCoursesSuccess(t){t.features.forEach(((t,e)=>{t.properties.name in this.mCourses||(this.mCourses[t.properties.name]=[]),this.mCourses[t.properties.name].push(t)}));for(let t in this.mCourses)this.mCourses[t].sort(((t,e)=>Tr(t.properties.distance,e.properties.distance)));this.mReady=!0}loadCourses(){Un("static/simulation_points_10m.geojson").then(this.loadCoursesSuccess.bind(this))}}class vr{static defaultTime=(new Date).getTime();constructor(t,e){void 0===t&&(t=null),void 0===e&&(e=vr.defaultTime),this.dispatcher=t,this.time=e,this.lastClock=e,this.updateCadence=864e5,this.cached=null,this.dispatcher.addHandler("Clock",`Sun_${this.id}`,this.clockUpdate.bind(this))}clockUpdate(t){this.lastClock=t.time,Math.abs(t.time-this.time)<this.updateCadence||(this.time=t.time,this.nextTime,this.update(),this.notify())}get magvar(){return null===this.cached&&this.update(),this.cached}update(){this.cached=this.magneticVariation(this.time)}notify(){null!==this.dispatcher&&this.dispatcher.notify("Magvar",this)}getYear(t){return void 0===t&&(t=(new Date).getTime()),(t-16725312e5)/315648e5+2023}magneticVariation(t){var e=13.1516393-.0838181*(this.getYear(t)-2023);return Math.round(100*e)/100}poke(){this.notify()}}class Ar{static defaultMarkName="GGB";constructor(t,e){void 0===t&&(t=null),this.dispatcher=t,this.definitions=e,this.markName=void 0,this.mark=void 0,this.leg=void 0,this.latestSettings=void 0,this.observerLocation={},null!==t&&(this.dispatcher.addHandler("Definitions","Mark",this.onDefinitionsChange.bind(this)),this.dispatcher.addHandler("SettingsModel","Mark",this.onSettingsModelChange.bind(this)))}setFromName(t){if(void 0===t||void 0===this.definitions)return this.markName=void 0,this.mark=void 0,void(this.leg=void 0);let e=t.match(/([0-9]+): ([A-Za-z0-9_.]+)/);null!==e&&this.definitions.hasLocationName(e[2])?(this.markName=e[2],this.leg=Number.parseInt(e[1])):(this.definitions.hasLocationName(t)?this.markName=t:this.markName=void 0,this.leg=void 0),void 0!==this.markName?this.mark=this.definitions.lookup(this.markName):this.mark=void 0}onSettingsModelChange(t){let e=t.diff(this.latestSettings);this.latestSettings=t.settings,(void 0===this.name||e.includes("markSelect"))&&(this.setFromName(t.latestSettings.markSelect),this.notify())}onDefinitionsChange(t){this.definitions=t,void 0!==this.latestSettings&&void 0!==this.latestSettings.markSelect&&this.definitions.hasLocationName(this.latestSettings.markSelect)?this.setFromName(this.latestSettings.markSelect):this.mark=void 0,this.notify()}get name(){return null===this.markName||void 0===this.markName?"<unset>":this.markName}get description(){return null===this.mark||void 0===this.mark?"<unset>":this.mark.description}get longitude(){return null===this.mark||void 0===this.mark?NaN:this.mark.value.longitude}get latitude(){return null===this.mark||void 0===this.mark?NaN:this.mark.value.latitude}get location(){return{longitude:this.longitude,latitude:this.latitude}}notify(){null!==this.dispatcher&&this.dispatcher.notify("Mark",this)}updateObserver(t){this.observerLocation=t.location}}function Nr(t){return"number"==typeof t&&!Number.isNaN(t)}function yr(t,e,n){var i=t.getElementById(e);if(null===i)throw Error(`unknown element ${e}`);i.textContent=n}function Cr(t,e){for(let n in e)yr(t,n,e[n])}function Mr(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);let i=Number(t).toFixed(n),s=e-i.length;for(;s>0;--s)i="0"+i;return i}function Lr(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);let i=Number(t).toFixed(n),s=e-i.length;for(;s>0;--s)i=" "+i;return i}function wr(t){return"number"==typeof t&&(t=new Date(t)),Mr(t.getFullYear(),4)+"-"+Mr(t.getMonth()+1,2)+"-"+Mr(t.getDate(),2)+"T"+Mr(t.getHours(),2)+":"+Mr(t.getMinutes(),2)+":"+Mr(t.getSeconds(),2)}function Rr(t,e){void 0===e&&(e="coarse");var n="+";t<0&&(n="-");var i=Math.abs(t);return{angle:t,sign:n,d:i,string:Mr(i,{veryCoarse:3,coarse:8,fine:10}[e],{veryCoarse:0,coarse:4,fine:6}[e])+"°"}}function kr(t,e){void 0===e&&(e="coarse");var n="+";t<0&&(n="-");var i=Math.abs(t),s=Math.floor(i),r=i=60*(i-s);return{angle:t,sign:n,d:s,minute:r,string:Mr(s,3)+"°"+Mr(r,{coarse:2,fine:7}[e],{coarse:0,fine:4}[e])+"'"}}function Ir(t,e){void 0===e&&(e="coarse");let n="+";t<0&&(n="-");let i=Math.abs(t),s=Math.floor(i);i=60*(i-s);let r=Math.floor(i);i=60*(i-r);let o=i;return{angle:t,sign:n,d:s,minute:r,second:o,string:Mr(s,3)+"°"+Mr(r,2)+"'"+Mr(o,{coarse:2,fine:5}[e],{coarse:0,fine:2}[e])+'"'}}function Dr(t,e,n,i,s){void 0===s&&(s="coarse"),"veryCoarse"==s&&(e="degrees"),"signed"!=n||"True"!=i&&"Magnetic"!=i||(n="shortSuffix");let r={degrees:Rr,degreesMinutes:kr,degreesMinutesSeconds:Ir}[e](t,s),o=r.string;if("shortSuffix"==n){let t="";"EW"==i?o=o+t+{"+":"E","-":"W"}[r.sign]:"NS"==i?o=o+t+{"+":"N","-":"S"}[r.sign]:"SP"==i?o=o+t+{"+":"S","-":"P"}[r.sign]:"True"==i?o=o+t+"T":"Magnetic"==i&&(o=o+t+"M")}else if("longSuffix"==n){let t=" ";"EW"==i?o=o+t+{"+":"East","-":"West"}[r.sign]:"NS"==i?o=o+t+{"+":"North","-":"South"}[r.sign]:"SP"==i?o=o+t+{"+":"Starboard","-":"Port"}[r.sign]:"True"==i?o=o+t+"True":"Magnetic"==i&&(o=o+t+"Magnetic")}else"signed"==n&&(o=r.sign+o);return o}function br(t,e,n,i){void 0===e&&(e="nauticalMiles"),void 0===i&&(i={statuteMiles:2,nauticalMiles:2,meters:0,kilometers:2,yards:0,feet:0}[e]);let s=Lr(function(t,e){return t/{statuteMiles:1609.344,nauticalMiles:1852,meters:1,kilometers:1e3,yards:.3048*3,feet:.3048}[e]}(t,e),n,i);return s+=""+{statuteMiles:"mi",nauticalMiles:"nmi",meters:"m",kilometers:"km",yards:"yds",feet:"ft"}[e],s}function Or(t,e){void 0===e&&(e="both");let n="";return"true"!==e&&"both"!=e||(n+=`${Mr(t.azimuthForwardInTrueDegrees,3,0)}°T`),"both"===e&&(n+="/"),"magnetic"!==e&&"both"!=e||(n+=`${Mr(t.azimuthForwardInMagneticDegrees,3,0)}°M`),n}function Pr(t,e,n){let i=[];for(let s=0;s<n;s++)i.push(t+s*(e-t)/(n-1));return i}class Fr{static id=0;constructor(t,e){void 0===t&&(t=null),void 0===e&&(e=window.location.search),this.dispatcher=t,this.queryString=e,this.runState=!1;const n=new URLSearchParams(this.queryString);this.timeout=15e3,n.has("gpsTimeoutSeconds")&&(this.timeout=1e3*Number.parseFloat(n.get("gpsTimeoutSeconds"))),this.maximumAge=5e3,n.has("gpsMaximumAgeSeconds")&&(this.maximumAge=1e3*Number.parseFloat(n.get("gpsMaximumAgeSeconds"))),this.options={enableHighAccuracy:!0,timeout:this.timeout,maximumAge:this.maximumAge},this.handleId=null,this.latestPosition={},this.latestTimestamp=void 0,this.latestError="no position found",this.latestStatusOK=!1,this.id=Fr.id,Fr.id+=1,null!==this.dispatcher&&this.dispatcher.addHandler("SettingsModel",`GPS_${this.id}`,this.onSettingsModelChange)}clear(){null!==this.handleId&&void 0!==this.handleId&&(navigator.geolocation.clearWatch(this.handleId),this.handleId=null)}start(){this.runState=!0,null!==this.handleId&&void 0!==this.handleId||(this.handleId=navigator.geolocation.watchPosition(this.success.bind(this),this.error.bind(this),this.options))}stop(){this.runState=!1,this.clear()}success(t){this.latestStatusOK=!0,this.latestError=void 0,this.latestTimestamp=(new Date).getTime(),this.latestPosition={timestamp:t.timestamp,coords:{longitude:t.coords.longitude,latitude:t.coords.latitude,altitude:t.coords.altitude,accuracy:t.coords.accuracy,altitudeAccuracy:t.coords.altitudeAccuracy,heading:t.coords.heading,speed:t.coords.speed}},this.notify()}error(t){this.latestStatusOK=!1,this.latestTimestamp=(new Date).getTime();const{code:e}=t;switch(e){case 1:this.latestError="GPS permission denied",console.log(wr(this.latestTimestamp)+": "+this.latestError);break;case 2:this.latestError="GPS position unavailable",console.log(wr(this.latestTimestamp)+": "+this.latestError);break;case 3:this.latestError="GPS timeout",console.log(wr(this.latestTimestamp)+": "+this.latestError)}this.notify()}notify(){null!==this.dispatcher&&this.dispatcher.notify("GPS",this)}onSettingsModelChange(){}}const Ur=1/298.257223563,zr=6356752.314245179,Br=Math.PI/180,Hr=180/Math.PI;function Gr(t,e,n,i){if(void 0===e&&(e=0),void 0===n&&(n=360),void 0===i&&(i=!0),e>n){let t=n;n=e,e=t}let s=n-e;for(;t<e;)t+=s;for(;t>=n;)t-=s;return t!=e||i||(t=n),t}function Vr(t,e,n){let i=e-t+180;return"port"===n?i=Gr(i,-360,0,!1):"starboard"===n?i=Gr(i,0,360,!0):"gate"===n&&(i=Gr(i,-180,180,!1)),i}function Xr(t,e,n,i){void 0===n&&(n=1e-8),void 0===i&&(i=10);const s=Math.atan((1-Ur)*Math.tan(t.latitude*Br)),r=Math.atan((1-Ur)*Math.tan(e.latitude*Br)),o=(e.longitude-t.longitude)*Br;var a=o,l=a,h=0,u=2*n,c=0,d=0,p=0,g=0,f=0,m=0,x=Ur/16*f*(4+Ur*(4-3*f));for(let t=0;t<i&&(h+=1,c=Math.sqrt(Math.pow(Math.cos(r)*Math.sin(a),2)+Math.pow(Math.cos(s)*Math.sin(r)-Math.sin(s)*Math.cos(r)*Math.cos(a),2)),d=Math.sin(s)*Math.sin(r)+Math.cos(s)*Math.cos(r)*Math.cos(a),p=Math.atan2(c,d),m=0,0!=(f=1-(g=Math.cos(s)*Math.cos(r)*Math.sin(a)/c)*g)&&(m=Math.cos(p)-2*Math.sin(s)*Math.sin(r)/f),a=o+(1-(x=Ur/16*f*(4+Ur*(4-3*f))))*Ur*g*(p+x*c*(m+x*d*(2*m*m-1))),!((u=Math.abs(a-l))<=n));t++)l=a;if(u>n)return null;var E=272331606107.5547*f/zr/zr,S=E/1024*(256+E*(E*(74-47*E)-128)),T=zr*(1+E/16384*(4096+E*(E*(320-175*E)-768)))*(p-S*c*(m+1/4*S*(d*(2*m*m-1)-1/6*S*m*(4*c*c-3)*(4*m*m-3)))),_=Math.atan2(Math.cos(r)*Math.sin(a),Math.cos(s)*Math.sin(r)-Math.sin(s)*Math.cos(r)*Math.cos(a)),v=Math.atan2(Math.cos(s)*Math.sin(a),-1*Math.sin(s)*Math.cos(r)+Math.cos(s)*Math.sin(r)*Math.cos(a));return{start:t,stop:e,distanceInMeters:T,azimuthForwardInTrueDegrees:Gr(360+_*Hr,0,360),azimuthBackwardInTrueDegrees:Gr(180+v*Hr,0,360),numSteps:h,convergence:u}}function $r(t,e,n){if(void 0===n&&(n=1e-6),Math.abs(t-e)>n)throw`${t} and ${e} are not close`}class Yr{constructor(t,e,n,i){void 0===t&&(t=null),this.dispatcher=t,void 0===e&&(e=1e3),this.maxRecords=e,void 0===n&&(n=864e5),this.maxAgeMS=n,void 0===i&&(i=50),this.dispatcher=t,this.maxRecords=e,this.maxAgeMS=n,this.minDistanceMeters=i,this.records=[]}prepend(t){for((0==this.records.length||t.calculatedDistanceInMeters>this.minDistanceMeters)&&this.records.unshift(t);this.records.length>1&&!(t.timestamp-this.records[this.records.length-1].timestamp<this.maxAgeMS);)this.records.pop();this.records.length>this.maxRecords&&this.records.pop()}get latestPosition(){return this.records[0]}dump(){let t=[];for(let e=0;e<this.records.length;e++)t.push({...this.records[e]});return t}}class jr{constructor(t){void 0===t&&(t=null),this.dispatcher=t,this.history=new Yr(this.dispatcher),this.latestStatusOK=!1,this.latestObserverName="",this.latestObserverError="",this.latestPosition={},this.magvar=13,this.sunAzimuth=null,null!==this.dispatcher&&(this.dispatcher.addHandler("Sun","ObserverHistory",this.onSunChange.bind(this)),this.dispatcher.addHandler("Magvar","ObserverHistory",this.onMagvarChange.bind(this)),this.dispatcher.addHandler("GPS","Observer",this.onGPSChange.bind(this)),this.dispatcher.addHandler("Simulation","Observer",this.onSimulationChange.bind(this)))}onSunChange(t){this.sunAzimuth=t.location.azimuth}onMagvarChange(t){this.magvar=t.magvar}onGPSChange(t){this.latestObserverName="GPS",t.latestStatusOK?(this.latestStatusOK=!0,this.setPosition(t.latestPosition)):(this.latestStatusOK=!1,this.latestObserverError=t.latestError),null!==this.dispatcher&&this.dispatcher.notify("Observer",this)}onSimulationChange(t){this.latestObserverName="Simulation",this.latestStatusOK=!0,this.setPosition(t.latestPosition),null!==this.dispatcher&&this.dispatcher.notify("Observer",this)}augmentedRecord(t){let e={timestamp:t.timestamp,localTime:wr(t.timestamp),longitude:t.coords.longitude,latitude:t.coords.latitude,providedHeading:t.coords.heading,providedSpeed:t.coords.speed,providedAccuracy:t.coords.accuracy};if(e.magvar=this.magvar,null!==e.magvar&&(e.providedHeadingMagnetic=Gr(e.providedHeading-e.magvar,-180,180)),e.sunAzimuth=this.sunAzimuth,null!==e.sunAzimuth&&(e.providedHeadingRelativeToSun=Gr(e.providedHeading-e.sunAzimuth,-180,180),e.providedHeadingRelativeToSunShadow=Gr(e.providedHeading-e.sunAzimuth+180,-180,180)),this.history.records.length>0){let t=this.history.records[0];var n=Xr(t,e);e.calculatedDistanceInMeters=n.distanceInMeters,e.calculatedDeltaTSeconds=(e.timestamp-t.timestamp)/1e3,e.calculatedSpeedInMetersPerSeconds=e.calculatedDistanceInMeters/e.calculatedDeltaTSeconds,e.calculatedTrackTrue=n.azimuthForwardInTrueDegrees,null!==e.sunAzimuth&&(e.calculatedTrackMagnetic=Gr(e.calculatedTrackTrue-e.magvar,-180,180)),null!==e.sunAzimuth&&(e.calculatedTrackRelativeToSun=Gr(e.calculatedTrackTrue-e.sunAzimuth,-180,180),e.calculatedTrackRelativeToSunShadow=Gr(e.calculatedTrackTrue-e.sunAzimuth+180,-180,180))}return e}setPosition(t){let e=this.augmentedRecord(t);this.latestPosition=e,this.history.prepend(e)}}class qr{constructor(t){void 0===t&&(t=null),this.dispatcher=t,null!==this.dispatcher&&(this.dispatcher.addHandler("Observer","Chart",this.onObserverChange.bind(this)),this.dispatcher.addHandler("Mark","Chart",this.onMarkChange.bind(this)),this.dispatcher.addHandler("Magvar","Chart",this.onMagvarChange.bind(this)),this.dispatcher.addHandler("SettingsModel","Chart",this.onSettingsChange.bind(this)),this.dispatcher.addHandler("SettingsModelButton","Chart",this.onSettingsButton.bind(this)),this.dispatcher.addHandler("Sun","Chart",this.onSunChange.bind(this)),this.dispatcher.addHandler("Course","Chart",this.onCourseChange.bind(this)),this.dispatcher.addHandler("Definitions","Chart",this.onDefinitionsChange.bind(this))),this.up="northTrue",this.border=8,this.width=500,this.height=500,this.followBoat=!0,this.centerXY=[this.width/2,this.height/2],this.chartRotation=0,this.boatToChartRotation=0,this.boatXY=[0,0],this.landTranslation=void 0,this.projectionName="mercator",this.projectionFn=void 0,this.projection1=void 0,this.projectionScale1=void 0,this.projectionTranslation1=void 0,this.projection=void 0,this.defaultScaleFactor=16,this.scaleFactor=1,this.maxScaleFactor=128,this.maxScaleFactorWithStreet=8*this.maxScaleFactor,this.minScaleFactor=1,this.land=void 0,this.streetGridUIName=void 0,this.streetGrid=void 0,this.latestMagvar=void 0,this.latestObserverLL=void 0,this.latestObserverEN=void 0,this.latestMark=void 0,this.sunAzimuth=void 0,this.sunShadowAzimuth=void 0,this.dispatchShowMarkDetails=vt("showMarkDetails"),this.dispatchShowMarkDetails.on("showMarkDetails",this.showMarkDetails.bind(this)),this.selectedMarkRadius=8,this.courseRoundingRadius=10,this.courseMarkRadius=5,this.otherMarkRadius=3,this.course=void 0,this.definitions=void 0,this.debugCourse=!0,this.init()}init(){var t,e,n,i,s;"mercator"==this.projectionName?this.projectionFn=function(t){var e,n,i,s=function(t){return Js((function(){return t}))()}(t),r=s.center,o=s.scale,a=s.translate,l=s.clipExtent,h=null;function u(){var r=qn*o(),a=s(function(t){function e(e){return(e=t(e[0]*Zn,e[1]*Zn))[0]*=Qn,e[1]*=Qn,e}return t=zs(t[0]*Zn,t[1]*Zn,t.length>2?t[2]*Zn:0),e.invert=function(e){return(e=t.invert(e[0]*Zn,e[1]*Zn))[0]*=Qn,e[1]*=Qn,e},e}(s.rotate()).invert([0,0]));return l(null==h?[[a[0]-r,a[1]-r],[a[0]+r,a[1]+r]]:t===Qs?[[Math.max(a[0]-r,h),e],[Math.min(a[0]+r,n),i]]:[[h,Math.max(a[1]-r,e)],[n,Math.min(a[1]+r,i)]])}return s.scale=function(t){return arguments.length?(o(t),u()):o()},s.translate=function(t){return arguments.length?(a(t),u()):a()},s.center=function(t){return arguments.length?(r(t),u()):r()},s.clipExtent=function(t){return arguments.length?(null==t?h=e=n=i=null:(h=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),u()):null==h?null:[[h,e],[n,i]]},u()}(Qs).scale(961/Jn):"lcc"==this.projectionName&&(this.projectionFn=(t=tr,e=0,n=qn/3,i=Js(t),s=i(e,n),s.parallels=function(t){return arguments.length?i(e=t[0]*Zn,n=t[1]*Zn):[e*Qn,n*Qn]},s).scale(109.5).parallels([30,30]).parallels([38.43333333333333,37.06666666666667]).rotate([120.5,0])),void 0===this.land&&Un("static/Land_4326.geojson").then(this.setLand.bind(this)).then(this.drawAll.bind(this))}setLand(t){this.land=t,this.resetProjection(),this.scale(this.defaultScaleFactor)}setStreetGridFromUIName(t){if(t!==this.streetGridUIName){if(this.streetGridUIName=t,void 0===t||"none"===t)return this.streetGrid=void 0,void this.drawStreetGrid();Un({richmond:"static/richmond_streets_1e5.geojson",berkeley:"static/berkeley_streets_1e5.geojson",corinthian:"static/corinthian_streets_1e5.geojson","st francis":"static/st_francis_streets_1e5.geojson","south beach":"static/south_beach_streets_1e5.geojson",encinal:"static/encinal_streets_1e5.geojson","balboa park":"static/balboa_park_streets_1e5.geojson","half moon bay":"static/half_moon_bay_streets_1e5.geojson","oyster point":"static/oyster_point_streets_1e5.geojson",sequoia:"static/sequoia_streets_1e5.geojson",midpen:"static/midpen_trails_1e5.geojson",sjc:"static/sjc_streets_1e5.geojson"}[t]).then(this.setStreetGrid.bind(this))}}setStreetGrid(t){this.streetGrid=t,this.drawStreetGrid()}resetProjection(){this.scaleFactor=1,this.projection1=this.projectionFn.angle(this.angle).fitSize([this.width,this.height],this.land),this.projectionScale1=this.projection1.scale(),this.projectionTranslation1=this.projection1.translate(),this.projection=this.projection1}onWindowResize(){let t=document.getElementById("chartDiv"),e=[.8*window.innerWidth,.8*window.innerHeight],n=(t.clientWidth,t.clientHeight,e[0]);return n>e[0]&&(n=e[0]),n>e[1]&&(n=e[1]),this.width=n-2*this.border,this.height=n-2*this.border,this.centerXY=[this.width/2,this.height/2],this.resize(),this}resize(){return er("#chartSvg").attr("width",this.width).attr("height",this.height),er("#chartBackgroundRect").attr("x",0).attr("y",0).attr("width",this.width).attr("height",this.height),this.drawAll(),this}drawAll(){return this.drawLand(),this.drawOtherMarks(),this.drawMark(),this.drawMarkLine(),this.drawStreetGrid(),this.drawCourse(),this}drawLand(){if(void 0!==this.land){let t=ps().projection(this.projection);er("#landSVGG").selectAll("path.land").remove(),er("#landSVGG").selectAll("path.land").data(this.land.features).enter().append("path").attr("class","land").attr("d",t).attr("clip-path","url(#chartLandClipPath)")}else console.log("have not loaded land");return this}drawStreetGrid(){if(er("#streetGridSVGG").selectAll("path.streetGrid").remove(),void 0!==this.streetGrid){let t=ps().projection(this.projection);er("#streetGridSVGG").selectAll("path.streetGrid").data(this.streetGrid.features).enter().append("path").attr("class","streetGrid").attr("d",t).attr("clip-path","url(#chartLandClipPath)")}return this}safeObserverLocation(){let t=-122.422142,e=37.826229;return void 0!==this.latestObserverLL&&(t=this.latestObserverLL.longitude),void 0!==this.latestObserverLL&&(e=this.latestObserverLL.latitude),[t,e]}drawMark(){if(void 0!==this.latestMark&&void 0!==this.latestMark.longitude&&void 0!==this.latestMark.latitude&&!Number.isNaN(this.latestMark.latitude)&&!Number.isNaN(this.latestMark.longitude))if(void 0!==this.projection){let t=this.projection([this.latestMark.longitude,this.latestMark.latitude]),e=[{name:this.latestMark.name,cx:t[0],cy:t[1],longitude:this.latestMark.longitude,latitude:this.latestMark.latitude,description:this.latestMark.description}];er("#markSVGG").selectAll("circle.currentMark").remove(),er("#markSVGG").selectAll("text.currentMark").remove(),er("#markSVGG").selectAll("circle.currentMark").data(e,(t=>t.Name)).enter().append("circle").attr("class","currentMark").attr("cx",(t=>t.cx)).attr("cy",(t=>t.cy)).attr("r",this.selectedMarkRadius).attr("name",(t=>t.name)).on("click",(t=>this.dispatchShowMarkDetails.call("showMarkDetails",this,t))),er("#markSVGG").selectAll("text.currentMark").data(e,(t=>t.Name)).enter().append("text").attr("class","currentMark").attr("x",(t=>t.cx)).attr("y",(t=>t.cy)).text((t=>t.name)).on("click",(t=>this.dispatchShowMarkDetails.call("showMarkDetails",this,t)))}else console.log("lack projection to draw mark")}makeRoundings(){return this.course.roundings.map(((t,e)=>{let n={...t},i=this.projection([t.longitude,t.latitude]);return n.x=i[0],n.y=i[1],n}))}computeCourseRadiiForRoundings(t){let e={};for(let n=0;n<t.length;n++){let i=0;void 0!==t[n].turn&&(i=this.courseRoundingRadius,t[n].name in e&&(i+=e[t[n].name])),t[n].radius=i,e[t[n].name]=i}return t}computeLegs(t){function e(t,e){let n=Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2);return n<.1&&(n=.1),n}let n=[];for(let i=0;i<t.length-1;i++){let s={i,fromName:t[i].name,toName:t[i+1].name,fromXY:[t[i].x,t[i].y],toXY:[t[i+1].x,t[i+1].y],azimuthEllipsoid:t[i].azimuthForwardInTrueDegrees,distanceXYMeters:t[i].distanceInMeters,azimuthXY:Gr(90-180/Math.PI*Math.atan2(t[i+1].y-t[i].y,-1*(t[i+1].x-t[i].x)),0,360),distanceXY:e(t[i],t[i+1])};s.tangentDegrees=180/Math.PI*to(t[i].x,t[i].y,t[i].radius,t[i].turn,t[i+1].x,t[i+1].y,t[i+1].radius,t[i+1].turn),n.push(s)}for(let e=0;e<t.length-1;e++){if(t[e].entryAzimuth=void 0,t[e].entryPoint=[t[e].x,t[e]+1],t[e].exitAzimuth=void 0,t[e].exitPoint=[t[e].x,t[e]+1],e>0&&void 0!==n[e-1].tangentDegrees){let i=n[e-1].azimuthXY+n[e-1].tangentDegrees;t[e].turn>0?i=n[e-1].azimuthXY+90-n[e-1].tangentDegrees:t[e].turn<0&&(i=n[e-1].azimuthXY-90+n[e-1].tangentDegrees),t[e].entryAzimuth=Gr(i,0,360),t[e].entryPoint=[t[e].x+t[e].radius*Kr(t[e].entryAzimuth),t[e].y+t[e].radius*Wr(t[e].entryAzimuth)]}if(void 0!==n[e].tangentDegrees){let i=n[e].azimuthXY+n[e].tangentDegrees;t[e].turn>0?i=n[e].azimuthXY+90-n[e].tangentDegrees:t[e].turn<0&&(i=n[e].azimuthXY-90+n[e].tangentDegrees),t[e].exitAzimuth=Gr(i,0,360)}t[e].exitPoint=[t[e].x+t[e].radius*Kr(t[e].exitAzimuth),t[e].y+t[e].radius*Wr(t[e].exitAzimuth)]}let i=t.length-1;i>=0&&(t[i].entryAzimuth=void 0,t[i].entryPoint=[t[i].x,t[i].y]);for(let e=0;e<n.length;e++)n[e].startPoint=t[e].exitPoint,n[e].stopPoint=t[e+1].entryPoint;return{roundings:t,legs:n}}drawCourse2(){if(void 0!==this.course&&void 0!==this.projection){let t=Pr(120,240,this.course.length()),e=this.makeRoundings();e=this.computeCourseRadiiForRoundings(e);let n=this.computeLegs(e);console.log(n);let i=[];for(let t=0;t<n.legs.length;t++){let e={...n.legs[t]};e.type="leg",e.i=t,e.pathDef=`M ${e.startPoint[0]} ${e.startPoint[1]} L ${e.stopPoint[0]} ${e.stopPoint[1]}`,i.push(e);let s={...n.roundings[t+1]};void 0!==s.entryAzimuth&&void 0!==s.exitAzimuth&&(s.type="rounding",s.i=t,s.pathDef=Zr(Jr(s.x,s.y,s.radius,s.entryAzimuth,s.exitAzimuth,s.turn),!1),i.push(s))}er("#courseSVGG").selectAll(".courseSegment").remove(),er("#courseSVGG").selectAll("path.courseSegment").data(i).enter().append("path").attr("class","courseSegment").attr("d",(t=>t.pathDef)).attr("style",(e=>`stroke: hsl(${t[e.i]}, 100%, 50%)`)).attr("debug.type",(t=>t.type)).attr("debug.leg",(t=>t.i)),er("#courseSVGG").selectAll("circle.courseMark").remove(),er("#courseSVGG").selectAll("circle.courseMark").data(n.roundings).enter().append("circle").attr("class","courseMark").attr("r",this.courseMarkRadius).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("style",((e,n)=>`fill: hsl(${t[n]}, 100%, 50%)`)).attr("name",(t=>t.name)).attr("description",(t=>t.description)).on("click",(t=>this.dispatchShowMarkDetails.call("showMarkDetails",this,t)))}}drawCourse(){if(void 0!==this.course&&void 0!==this.projection){let t,e,n,i=Pr(120,240,this.course.length()),s={},r={},o=[],a=0,l=this.makeRoundings();l=this.computeCourseRadiiForRoundings(l);let h=this.computeLegs(l);console.log(h);for(let i=0;i<this.course.length();i++){let l,h;i>0&&(l=o[o.length-1],h=this.course.roundings[i-1]);let u=this.course.roundings[i];if(u.name in s||(s[u.name]=this.projection([u.longitude,u.latitude])),0==i)continue;let c=Math.sqrt((s[u.name][1]-s[h.name][1])**2+(s[u.name][0]-s[h.name][0])**2);c<.1&&(c=.1);let d=Math.atan2(s[h.name][1]-s[u.name][1],s[u.name][0]-s[h.name][0]),p=Gr(90-180/Math.PI*d,0,360);a=0,void 0!==u.turn&&(a=this.courseRoundingRadius,u.name in r&&(a+=r[u.name]));let g=0,f=0;void 0!==h&&(g=r[h.name],f=h.turn);let m=to(s[h.name][0],s[h.name][1],g,f,s[u.name][0],s[u.name][1],a,u.turn),x=180/Math.PI*m;n=e;let E=p,S=p;f>0?E=p-90+x:f<0&&(E=p+90-x),e=u.halfAzimuth,u.turn>0?S=p-90-x:u.turn<0&&(S=p+90+x),e=Gr(e,0,360),E=Gr(E,0,360),S=Gr(S,0,360);let T=[s[h.name][0],s[h.name][1]];void 0!==f&&(T=[s[h.name][0]+a*Kr(E),s[h.name][1]+a*Wr(E)]);let _=[s[u.name][0],s[u.name][1]];void 0!==u.turn&&(_=[s[u.name][0]+a*Kr(S),s[u.name][1]+a*Wr(S)],t=[s[u.name][0]+a*Kr(e),s[u.name][1]+a*Wr(e)]);let v="";void 0!==l?v=Zr(Jr(s[h.name][0],s[h.name][1],r[h.name],n,E,h.turn),!1):v+=`M ${T[0]} ${T[1]} `,v+=`L ${_[0]} ${_[1]} `,void 0!==u.turn&&(v+=Zr(Jr(s[u.name][0],s[u.name][1],a,S,e,u.turn),!0)),o.push({i,priorName:h.name,name:u.name,description:u.description,pathDef:v,radius:a,x:s[u.name][0],y:s[u.name][1],priorX:s[h.name][0],priorY:s[h.name][1],priorHalfAzimuth:n,priorRoundingTurn:h.turn,halfAzimuth:e,fromAzimuth:u.fromAzimuth,toAzimuth:u.toAzimuth,turn:u.turn,halfwayPoint:t,basicAngle:d,basicAzimuth:p,tangent:m,tangentDegrees:x,exitAzimuth:E,entryAzimuth:S,exitPoint:T,entryPoint:_}),r[u.name]=a}er("#courseSVGG").selectAll(".courseSegment").remove(),er("#courseSVGG").selectAll("path.courseSegment").data(o).enter().append("path").attr("class","courseSegment").attr("d",(t=>t.pathDef)).attr("style",(t=>`stroke: hsl(${i[t.i]}, 100%, 50%)`)).attr("debug.leg",(t=>t.i)).attr("debug.priorName",(t=>t.priorName)).attr("debug.name",(t=>t.name)).attr("debug.description",(t=>t.description)).attr("debug.priorX",(t=>t.priorX)).attr("debug.priorY",(t=>t.priorY)).attr("debug.x",(t=>t.x)).attr("debug.y",(t=>t.y)).attr("debug.radius",(t=>t.radius)).attr("debug.fromAzimuth",(t=>t.fromAzimuth)).attr("debug.turn",(t=>t.turn)).attr("debug.toAzimuth",(t=>t.toAzimuth)).attr("debug.basicAngle",(t=>t.basicAngle)).attr("debug.basicAzimuth",(t=>t.basicAzimuth)).attr("debug.tangent",(t=>t.tangent)).attr("debug.tangentDegrees",(t=>t.tangentDegrees)).attr("debug.priorHalfAzimuth",(t=>t.priorHalfAzimuth)).attr("debug.priorRoundingTurn",(t=>t.priorRoundingTurn)).attr("debug.halfAzimuth",(t=>t.halfAzimuth)).attr("debug.exitAzimuth",(t=>t.exitAzimuth)).attr("debug.exitPoint",(t=>t.exitPoint)).attr("debug.entryAzimuth",(t=>t.entryAzimuth)).attr("debug.entryPoint",(t=>t.entryPoint)).attr("debug.halfwayPoint",(t=>t.halfwayPoint)),this.debugCourse&&er("#courseSVGG").selectAll("circle.courseSegment").data(o).enter().append("circle").attr("class","courseSegment").attr("cx",(t=>t.x+t.radius*Kr(t.halfAzimuth))).attr("cy",(t=>t.y+t.radius*Wr(t.halfAzimuth))).attr("r",(t=>2)).attr("stroke","red").attr("fill","none").attr("halfAzimuth",(t=>t.halfAzimuth)).attr("fromAzimuth",(t=>t.fromAzimuth)).attr("toAzimuth",(t=>t.toAzimuth)),er("#courseSVGG").selectAll("circle.courseMark").remove();let u=this.course.roundings.map((t=>({name:t.name,description:t.description,longitude:t.longitude,latitude:t.latitude,x:s[t.name][0],y:s[t.name][1]})));er("#courseSVGG").selectAll("circle.courseMark").data(u).enter().append("circle").attr("class","courseMark").attr("r",this.courseMarkRadius).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("style",((t,e)=>`fill: hsl(${i[e]}, 100%, 50%)`)).attr("name",(t=>t.name)).attr("description",(t=>t.description)).on("click",(t=>this.dispatchShowMarkDetails.call("showMarkDetails",this,t)))}}showMarkDetails(t){let e=t.target.__data__,n=`${e.name}`;void 0!==e.description&&""!==e.description&&(n+=`: ${e.description}`),alert(n)}drawMarkLine(){if(void 0!==this.latestMark&&void 0!==this.latestMark.longitude&&void 0!==this.latestMark.latitude&&!Number.isNaN(this.latestMark.latitude)&&!Number.isNaN(this.latestMark.longitude)){let t=this.safeObserverLocation();if(void 0===this.projection||void 0===t[0]||Number.isNaN(t[0])||void 0===t[1]||Number.isNaN(t[1]))console.log("lack projection to draw mark");else{let e=this.projection(t),n=this.projection([this.latestMark.longitude,this.latestMark.latitude]),i=Math.atan2(n[1]-e[1],n[0]-e[0]),s=Math.sqrt(this.width**2+this.height**2),r=e[0]+s*Math.cos(i),o=e[1]+s*Math.sin(i),a=[{name:`${this.latestMark.Name} ${t.longitude} ${t.latitude}`,x1:e[0],y1:e[1],x2:r,y2:o}];er("#markSVGG").selectAll("line.currentMark").remove(),er("#markSVGG").selectAll("line.currentMark").data(a,(t=>t.name)).enter().append("line").attr("class","currentMark").attr("x1",(t=>t.x1)).attr("y1",(t=>t.y1)).attr("x2",(t=>t.x2)).attr("y2",(t=>t.y2))}}}drawOtherMarks(){if(void 0!==this.definitions&&void 0!==this.projection){let t={};this.definitions.getDefinitionNames("MDLLocation").forEach(((e,n)=>{let i=this.definitions.lookup(e);t[e]={name:e,i:n,latitude:i.value.latitude,longitude:i.value.longitude,description:i.description,NE:this.projection([i.value.longitude,i.value.latitude])}})),void 0!==this.latestMark&&delete t[this.latestMark.name],void 0!==this.course&&this.course.roundings.forEach((e=>delete t[e.name]));let e=this.definitions.getDefinitionNames("MDLLocation").filter((e=>e in t)),n=er("#otherMarksSVGG");n.selectAll("circle.otherMarks").remove(),n.selectAll("text.otherMarkNames").remove();let i=e.map((e=>t[e])).reverse();function s(t,e){return t[e]}n.selectAll("circle.otherMarks").data(i).enter().append("circle").attr("class","otherMarks").attr("name",(t=>s(t,"name"))).attr("cx",(t=>t.NE[0])).attr("cy",(t=>t.NE[1])).attr("r",this.otherMarkRadius).attr("description",(t=>t.description)).attr("latitude",(t=>t.latitude)).attr("longitude",(t=>t.longitude)).on("click",(t=>this.dispatchShowMarkDetails.call("showMarkDetails",this,t)))}}drawSunLines(){if(void 0!==this.sunAzimuth)if(void 0!==this.projection){let t=this.safeObserverLocation(),e=this.projection(t),n=Math.PI/180*(90-this.sunAzimuth),i=Math.sqrt(this.width**2+this.height**2),s=[{cls:"sun",x1:e[0],y1:e[1],x2:e[0]+i*Math.cos(n),y2:e[1]-i*Math.sin(n)},{cls:"shadow",x1:e[0],y1:e[1],x2:e[0]-i*Math.cos(n),y2:e[1]+i*Math.sin(n)}];er("#sunLinesSVGG").selectAll("line").remove(),er("#sunLinesSVGG").selectAll("line").data(s,(t=>t.cls)).enter().append("line").attr("class",(t=>t.cls)).attr("x1",(t=>t.x1)).attr("y1",(t=>t.y1)).attr("x2",(t=>t.x2)).attr("y2",(t=>t.y2))}else console.log("lack projection to draw mark")}onObserverChange(t){if(void 0!==t&&void 0!==t.latestPosition){this.latestObserverLL=t.latestPosition;let e=this.latestObserverLL.providedHeading;null==e&&(e=360*Math.random()),"track"==this.up?(this.chartRotation=-1*e,this.boatToChartRotation=0-this.chartRotation):"northTrue"==this.up?(this.chartRotation=0,this.boatToChartRotation=e):"northMagnetic"==this.up?(this.chartRotation=-1*this.latestMagvar,this.boatToChartRotation=e):"sun"==this.up?(void 0!==this.sunAzimuth?this.chartRotation=-1*this.sunAzimuth:this.chartRotation=-180,this.boatToChartRotation=e):"sunShadow"==this.up&&(void 0!==this.sunShadowAzimuth?this.chartRotation=-1*this.sunShadowAzimuth:this.chartRotation=0,this.boatToChartRotation=e),this.adjust(),this.drawSunLines(),this.drawMarkLine()}else console.log("ignoring Chart.onObserverChange for bad observer")}onMarkChange(t){void 0!==t&&(this.latestMark=t,this.drawOtherMarks(),this.drawMark(),this.drawMarkLine())}onCourseChange(t){this.course=t,this.drawOtherMarks(),this.drawCourse()}onDefinitionsChange(t){this.definitions=t,this.drawAll()}adjust(t,e,n,i){if(void 0===t&&(t=this.chartRotation),void 0===e&&(e=this.boatToChartRotation),void 0===n||void 0===i){let t=this.safeObserverLocation();n=t[0],i=t[1]}this.boatXY[0],this.boatXY[1];let s=this.projection([n,i]);this.followBoat||(this.boatXY[0]+=s[0],this.boatXY[1]+=s[1],void 0!==this.latestObserverEN&&(this.boatXY[0]-=this.latestObserverEN[0],this.boatXY[1]-=this.latestObserverEN[1])),this.latestObserverEN=s,er("#chartLocationSVGG").attr("transform",`translate(${this.centerXY[0]+this.boatXY[0]},${this.centerXY[1]+this.boatXY[1]}) rotate(${t})`),er("#boatSVGG").attr("transform",`rotate(${e}) scale(0.5)`);let r=er("#landItemsSVGG"),o=er("#extraLandItemsSVGG");if(void 0===this.landTranslation)this.landTranslation=[this.boatXY[0]-this.latestObserverEN[0],this.boatXY[1]-this.latestObserverEN[1]];else{let t=[this.landTranslation[0],this.landTranslation[1]];this.landTranslation[0]+=this.boatXY[0]-this.latestObserverEN[0]-t[0],this.landTranslation[1]+=this.boatXY[1]-this.latestObserverEN[1]-t[1]}let a=(Math.sqrt(2)-1)*this.width,l=(Math.sqrt(2)-1)*this.height;er("#chartLandClipPathRect").attr("x",-1*(this.centerXY[0]+this.landTranslation[0]+a/2)+1).attr("y",-1*(this.centerXY[1]+this.landTranslation[1]+l/2)+1).attr("width",this.width+a).attr("height",this.height+l),r.attr("transform",`translate(${this.centerXY[0]}, ${this.centerXY[1]}) rotate(${t}) translate(${this.landTranslation[0]}, ${this.landTranslation[1]})`),o.attr("transform",`translate(${this.centerXY[0]}, ${this.centerXY[1]}) rotate(${t}) translate(${this.landTranslation[0]}, ${this.landTranslation[1]})`)}centerBoat(){this.boatXY=[0,0],this.adjust()}centerCourse(){if(void 0!==this.course&&null!==this.course){let t=this.course.center();if(void 0!==t&&void 0!==this.projection){let e=this.projection(t),n=this.projection(this.safeObserverLocation());this.boatXY=[n[0]-e[0],n[1]-e[1]],this.adjust()}}}centerMark(){if(void 0!==this.latestMark&&null!==this.latestMark&&Nr(this.latestMark.latitude)&&Nr(this.latestMark.longitude)){let t=[this.latestMark.longitude,this.latestMark.latitude];if(void 0!==this.projection){let e=this.projection(t),n=this.projection(this.safeObserverLocation());this.boatXY=[n[0]-e[0],n[1]-e[1]],this.adjust()}}}onMagvarChange(t){this.latestMagvar=t.magvar,er("#magneticCompassSVGG").attr("transform",`translate(0, 0) rotate(${t.magvar})`)}scale(t){if(void 0!==t){if((t=this.clipScaleFactor(t))!=this.scaleFactor){let e=t/this.scaleFactor;this.scaleFactor=t,void 0!==this.projection1&&(this.projection=this.projection1.translate([this.scaleFactor*this.projectionTranslation1[0],this.scaleFactor*this.projectionTranslation1[1]]).scale(this.scaleFactor*this.projectionScale1),this.boatXY[0]*=e,this.boatXY[1]*=e,void 0!==this.latestObserverEN&&(this.latestObserverEN[0]*=e,this.latestObserverEN[1]*=e),void 0!==this.landTranslation&&(this.landTranslation[0]*=e,this.landTranslation[1]*=e),this.adjust(),this.drawAll())}this.scaleFactor=t}}clipScaleFactor(t){return void 0===this.streetGrid?t>this.maxScaleFactor&&(t=this.maxScaleFactor):t>this.maxScaleFactorWithStreet&&(t=this.maxScaleFactorWithStreet),t<this.minScaleFactor&&(t=this.minScaleFactor),t}scaleUp(){this.scale(1.5*this.scaleFactor)}scaleDown(){this.scale(this.scaleFactor/1.5)}onSettingsChange(t){let e=t.settings;e.up!=this.up&&(this.up=e.up),e.debugStreetGrid!==this.streetGridUIName&&this.setStreetGridFromUIName(e.debugStreetGrid)}onSettingsButton(t){"zoomIn"==t.activeButton&&this.scaleUp(),"zoomOut"==t.activeButton&&this.scaleDown(),"centerBoat"==t.activeButton&&this.centerBoat(),"toggleFollowBoat"==t.activeButton&&(this.followBoat=!this.followBoat),"centerCourse"==t.activeButton&&(this.followBoat=!1,this.centerCourse()),"centerMark"==t.activeButton&&(this.followBoat=!1,this.centerMark())}onSunChange(t){this.sunAzimuth=t.location.azimuth,this.sunAzimuth>180?this.sunShadowAzimuth=this.sunAzimuth+180:this.sunShadowAzimuth=this.sunAzimuth-180,this.drawSunLines()}bezierCircularArcPoints(t,e,n,i,s,r,o){return Jr(t,e,n,i,s,r,o)}bezierArcToPathD(t,e){return Zr(t,e)}}function Wr(t){return t=90-t,-1*Math.sin(t*Math.PI/180)}function Kr(t){return t=90-t,Math.cos(t*Math.PI/180)}function Jr(t,e,n,i,s,r,o,a){let l=[];void 0===r&&(r=1),void 0===o&&(o=!1),void 0===a&&(a=90),r>=0&&s<i&&(s+=360),r<0&&s>i&&(s-=360),!0!==o&&(i=-1*(90-i),s=-1*(90-s));let h=s-i,u=Math.ceil(Math.abs(1*h/a)),c=h/u;for(let s=0;s<u;s++){let r=[i+c*s,i+c*(s+1)],o=Qr(t,e,n,r[0],r[1]);l.push(o)}return l}function Qr(t,e,n,i,s){let r=i*Math.PI/180,o=s*Math.PI/180-r,a=4/3*Math.tan(o/4),l=new Array(4);l[0]=[n,0],l[1]=[n,n*a],l[2]=[n*(Math.cos(o)+a*Math.sin(o)),n*(Math.sin(o)-a*Math.cos(o))],l[3]=[n*Math.cos(o),n*Math.sin(o)];let h=Math.cos(r),u=Math.sin(r);return l=l.map((n=>[t+n[0]*h-n[1]*u,e+n[0]*u+n[1]*h])),l}function Zr(t,e){void 0===e&&(e=!1);let n="";for(let i=0;i<t.length;i++){let s=t[i];e||(n=`M ${s[0][0]} ${s[0][1]} `,e=!0),n+=`C ${s[1][0]} ${s[1][1]}, ${s[2][0]} ${s[2][1]}, ${s[3][0]} ${s[3][1]} `}return n}function to(t,e,n,i,s,r,o,a){let l=Math.sqrt((s-t)**2+(r-e)**2),h=0;if(void 0===n&&(n=0),void 0===o&&(o=0),0===n&&0===o)h=0;else if(0===n)h=Math.asin(o/l);else if(0===o)h=Math.asin(n/l);else{let t=n-Math.sign(i)*Math.sign(a)*o;h=Math.asin(t/l)}return h}const eo=["simulationOrGPS","up","debugStreetGrid","angleFormat","angleSign","distanceUnits","azimuthUnits","courseSelect","markSelect"],no=["expandLegal","collapseLegal","legalIAgree","expandDocumentation","collapseDocumentation","expandSettings","collapseSettings","expandDebugSettings","collapseDebugSettings","zoomIn","zoomOut","centerBoat","toggleFollowBoat","centerCourse","centerMark","expandChart","collapseChart","saveCurrentLocation","expandMarkInput","collapseMarkInput","calculateMarkPositions","clearMarkDefinitionsTable","expandCourseTable","collapseCourseTable","expandAstroChart","collapseAstroChart","download","expandCredits","collapseCredits"];class io{constructor(t){void 0===t&&(t=null),this.dispatcher=t,this.latestSettings=void 0,this.activeButton=void 0}init(){for(let t=0;t<eo.length;t++)document.getElementById(`${eo[t]}`).onchange=this.onchange.bind(this);for(let t=0;t<no.length;t++)document.getElementById(`${no[t]}`).onclick=this.onclick.bind(this,no[t]);let t=this.getLocal();console.log("prior settings are:"),console.log(t)}setLocal(){localStorage.setItem("settings",JSON.stringify(this.latestSettings))}getLocal(){let t=localStorage.getItem("settings");if(void 0!==t){let e=JSON.parse(t);return this.latestSettings=e,this.setSettings(e),e}}clearLocal(){localStorage.removeItem("settings")}poke(){this.getSettings(),this.notify()}getSettings(){let t={};for(let e in eo){let n=eo[e],i=document.getElementById(n),s=i.tagName;if("SELECT"!=s)throw`unknown tag type ${s}`;t[n]=i.value}return this.latestSettings=t,this.latestSettings}setSettings(t){for(let e in eo){let n=eo[e];if(n in t){let e=document.getElementById(n),i=e.tagName;if("SELECT"!=i)throw`unknown tag type ${i}`;e.value=t[n]}}return this.latestSettings=t,this.latestSettings}get settings(){let t={};for(let e in eo){let n=eo[e];t[n]=this.latestSettings[n]}return t}onchange(){this.getSettings(),this.setLocal(),this.notify()}onclick(t){this.activeButton=t,this.notifyButton(),this.activeButton=void 0}notify(){null!==this.dispatcher&&this.dispatcher.notify("SettingsVC",this)}notifyButton(){null!==this.dispatcher&&this.dispatcher.notify("SettingsVCButton",this)}}class so{static id=0;constructor(t,e){void 0===t&&(t=null),this.dispatcher=t,this.latestSettings={},this.id=so.id,so.id+=1,this.settingsNames=eo,this.activeButton=void 0,null!==this.dispatcher&&(this.dispatcher.addHandler("SettingsVC",`SettingsModel_${this.id}`,this.settingsVCUpdate.bind(this)),this.dispatcher.addHandler("SettingsVCButton",`SettingsModel_${this.id}`,this.buttonUpdate.bind(this)))}settingsVCUpdate(t){this.settingsUpdate(t.settings)}settingsUpdate(t){let e=0;for(let n in this.settingsNames){let i=this.settingsNames[n];void 0!==t[i]&&t[i]!=this.latestSettings[i]&&(this.latestSettings[i]=t[i],e+=1)}e>0&&this.notify()}buttonUpdate(t){this.activeButton=t.activeButton,this.notifyButton(),this.activeButton=void 0}notify(){null!==this.dispatcher&&this.dispatcher.notify("SettingsModel",this)}notifyButton(){null!==this.dispatcher&&this.dispatcher.notify("SettingsModelButton",this)}diff(t,e){void 0===t&&(t={}),void 0===e&&(e=this.latestSettings);let n=[];for(let i in this.settingsNames){let s=this.settingsNames[i];void 0!==t[s]&&t[s]==e[s]||n.push(s)}return n}get settings(){let t={};for(let e in this.settingsNames){let n=this.settingsNames[e];t[n]=this.latestSettings[n]}return t}}class ro{static id=0;constructor(t){void 0===t&&(t=null),this.dispatcher=t,this.solarLocation={},this.magvar=void 0,this.observerLocation={},this.markLocation={},this.clockTime=void 0,this.cachedResult={},this.id=ro.id,ro.id+=1,null!==this.dispatcher&&(this.dispatcher.addHandler("Sun",`PointPairCalculator_${this.id}`,this.updateSun.bind(this)),this.dispatcher.addHandler("Magvar",`PointPairCalculator_${this.id}`,this.updateMagvar.bind(this)),this.dispatcher.addHandler("Observer",`PointPairCalculator_${this.id}`,this.updateObserver.bind(this)),this.dispatcher.addHandler("Mark",`PointPairCalculator_${this.id}`,this.updateMark.bind(this)),this.dispatcher.addHandler("Clock",`PointPairCalculator_${this.id}`,this.updateClock.bind(this)))}updateSun(t){this.solarLocation=t.solarLocation(),this.notify()}updateMagvar(t){this.magvar=t.magvar,this.notify()}updateObserver(t){t.latestStatusOK?this.observerLocation=t.latestPosition:this.observerLocation={},this.notify()}updateMark(t){this.markLocation=t.location,this.notify()}updateClock(t){this.clockTime=t.time}computeMarkFromObserver(){if(Nr(this.markLocation.longitude)&&Nr(this.markLocation.latitude)&&Nr(this.observerLocation.longitude)&&Nr(this.observerLocation.latitude)){let t=Xr(this.observerLocation,this.markLocation);Nr(this.magvar)&&(t.azimuthForwardInMagneticDegrees=Gr(t.azimuthForwardInTrueDegrees-this.magvar),t.azimuthBackwardInMagneticDegrees=Gr(t.azimuthBackwardInTrueDegrees-this.magvar)),Nr(this.solarLocation.azimuth)&&(t.azimuthForwardRelativeToSunDegrees=Gr(t.azimuthForwardInTrueDegrees-this.solarLocation.azimuth,-180,180),t.azimuthForwardRelativeToShadowDegrees=Gr(t.azimuthForwardInTrueDegrees-this.solarLocation.azimuth+180,-180,180),t.azimuthBackwardRelativeToSunDegrees=Gr(t.azimuthBackwardInTrueDegrees-this.solarLocation.azimuth,-180,180),t.azimuthBackwardRelativeToShadowDegrees=Gr(t.azimuthBackwardInTrueDegrees-this.solarLocation.azimuth+180,-180,180)),Nr(this.observerLocation.providedHeading)&&(t.azimuthForwardRelativeToHeading=Gr(t.azimuthForwardInTrueDegrees-this.observerLocation.providedHeading,-180,180),t.azimuthBackwardRelativeToHeading=Gr(t.azimuthBackwardInTrueDegrees-this.observerLocation.providedHeading,-180,180)),Nr(this.observerLocation.calculatedTrackTrue)&&(t.azimuthForwardRelativeToCalculatedTrack=Gr(t.azimuthForwardInTrueDegrees-this.observerLocation.calculatedTrackTrue,-180,180),t.azimuthBackwardRelativeToCalculatedTrack=Gr(t.azimuthBackwardInTrueDegrees-this.observerLocation.calculatedTrackTrue,-180,180)),this.cachedResult=t,this.cachedResult.cachedTime=this.clockTime}else this.cachedResult={};return this.cachedResult}get markFromObserver(){return(!Nr(this.cachedResult.cachedTime)||this.clockTime-this.cachedResult.cachedTime>500)&&this.computeMarkFromObserver(),this.cachedResult}notify(){null!==this.dispatcher&&this.dispatcher.notify("PointPairCalculator",this)}}var oo=n(7938);const ao=["悋Ꜫ脳맭䅼㯧瞆","奤.Ū\b\t\t","\t\t\t","\t\b\t\b\t\t\t\n\t\n\v\t\v","\f\t\f\r\t\r\t\t","\t\t\t\t","\t\t\t","\t\t\t\t","\t\t\t",'\t\t \t !\t!"\t"#',"\t#$\t$%\t%&\t&'\t'(\t()\t)","*\t*+\t+,\t,-\t-","_\nb\n\f","e\vi\n\f","l\v","\b","\b\t\t\n\n\v\v\f","\f\r\r","\n\r","\n\f\v","\n\r","","","","¬\n","","¸\n","","¿\n",""," ",' !!!!!Ö\n!""',"######ß\n#$$$","$$$$$$$$$$í","\n$%%%%%%%%%","%%ù\n%&&&&&&&","&&&&&&ć\n&''","'''''''''","'''''''''","''Ğ\n'((((((","((((((((((","((((((((((","((((((((((","((((((((((","(((((Œ\n()))Ŗ\n",")\f))ř\v)**++++","+++ţ\n+++,,--",".\t\v\r\b","\t\n\v\f\r","!#%')+",'-/13579;= ?!A"C#E$',"G%I&K'M(O)Q*S+U,W-Y.\v\f\f","2;00ff²²)",")‴‴$$‵‵C\\c|",'002;C\\aac|\v\v""Ƌ',"","\t","\v\r","","","","","!","#%'",")+","-/","13","57","9;=","?A","CE","GI","KM","OQS","UW","Y^","fm","\to\vq\rs","uw","y{","}","","!","#%","')+","- /¢","1¤3«","5·7¾","9À;Æ","=Í?ÏAÕ","C×EÞ","GìIø","KĆMĝ","OőQœ","SŚUŢWŦ","YŨ[\\1","\\_1]_%^[","^]_c`b\n","a`beca","cdd","ecfj#gi\n","hgiljh","jkk","ljmn?n\b","op(p\nqrB","r\fst.t","uv*v","wx+xyz`","z{|,|","}~1~","-","/","\t","","","\t\t","","","","\t",""," ",'\t"',"\t$\t","&V","(O","*P",", ¡U¡.","¢£G£0","¤¥Y¥2","¦§r§¨q","¨©t©¬vª","¬r«¦«","ª¬4­","®u®¯v¯°","c°±t±²","d²³q³´c","´µtµ¸f","¶¸u·­","·¶¸6","¹ºiº»c»","¼v¼¿g½¿","i¾¹¾½","¿8ÀÁ","uÁÂvÂÃ","cÃÄtÄÅv","Å:ÆÇh","ÇÈkÈÉpÉ","ÊkÊËuËÌ","jÌ<ÍÎ","]Î>ÏÐ_","Ð@ÑÒv","ÒÖqÓÔ/Ô","Ö@ÕÑÕ","ÓÖB×","Ø=ØDÙÚ","pÚÛoÛß","kÜÝpÝßo","ÞÙÞÜ","ßFàá{","áâcâãtã","ífäå{åæ","cæçtçè","fèíuéê{","êëfëíu","ìàìä","ìéíH","îïhïðqð","ñqñùvòó","hóôgôõ","gõùvö÷h","÷ùvøî","øòøö","ùJúûo","ûügüývý","þgþćtÿĀ","oĀāgāĂ","vĂăgăĄt","Ąćuąćo","ĆúĆÿ","ĆąćL","ĈĉmĉĊkĊ","ċnċČqČč","očĎgĎď","vďĐgĐĞt","đĒmĒēk","ēĔnĔĕqĕ","ĖoĖėgėĘ","vĘęgęĚ","tĚĞuěĜm","ĜĞoĝĈ","ĝđĝě","ĞNğĠk","ĠŒhġĢgĢ","ģnģĤuĤŒ","gĥĦkĦħ","hħĨgĨĩn","ĩĪuĪŒg","īĬvĬĭjĭ","ĮgĮŒpįİ","hİıqıŒ","tĲĳyĳĴj","ĴĵkĵĶn","ĶŒgķĸfĸ","ŒqĹĺfĺĻ","qĻļpļŒ","gĽľcľŒu","ĿŀhŀŁt","ŁłqłŒoŃ","ńkńŅoŅņ","rņŇqŇň","tňŒvŉŊw","ŊŋuŋŒg","ŌōwōŎuŎ","ŏkŏŐpŐŒ","iőğőġ","őĥőī","őįőĲ","őķőĹ","őĽőĿ","őŃőŉ","őŌŒP","œŗ\t\bŔŖ\t\t","ŕŔŖř","ŗŕŗŘ","ŘRřŗ","Śś\fśT","Ŝţ\t\nŝŞ^Ş","ţ\fşŠ^Šš","šţ\fŢŜ","ŢŝŢş","ţŤŤť","\b+ťVŦŧ\n","ŧXŨũ\v","ũZ^cj","«·¾ÕÞìøĆĝőŗŢ","\b"].join(""),lo=(new oo.atn.ATNDeserializer).deserialize(ao),ho=lo.decisionToState.map(((t,e)=>new oo.dfa.DFA(t,e)));class uo extends oo.Lexer{static grammarFileName="definitions3.g4";static channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];static modeNames=["DEFAULT_MODE"];static literalNames=[null,null,null,"'='","'&'","'@'","','","'('","')'","'^'","'*'","'/'","'+'","'-'",null,null,null,null,null,"'T'","'M'","'N'","'S'","'E'","'W'",null,null,null,"'start'","'finish'","'['","']'",null,"';'",null,null,null,null,null,null,null,"'\n'"];static symbolicNames=[null,"LINE_COMMENT","DESCRIPTION","EQUALS","AMP","AT","COMMA","OPEN_PAREN","CLOSE_PAREN","POWER","TIMES","DIVIDED_BY","PLUS","MINUS","UNSIGNED_FLOAT","UNSIGNED_INT","DEGREE_SYMBOL","MINUTE_SYMBOL","SECONDS_SYMBOL","TRUE","MAGNETIC","NORTH","SOUTH","EAST","WEST","PORT","STARBOARD","GATE","START","FINISH","OPEN_BRACKET","CLOSE_BRACKET","TO","SEMICOLON","NAUTICAL_MILES","YARDS","FEET","METERS","KILOMETERS","RESERVED_WORDS","NAME","NEWLINE","WHITESPACE","TEXT","ERROR_CHAR"];static ruleNames=["LINE_COMMENT","DESCRIPTION","EQUALS","AMP","AT","COMMA","OPEN_PAREN","CLOSE_PAREN","POWER","TIMES","DIVIDED_BY","PLUS","MINUS","UNSIGNED_FLOAT","UNSIGNED_INT","DEGREE_SYMBOL","MINUTE_SYMBOL","SECONDS_SYMBOL","TRUE","MAGNETIC","NORTH","SOUTH","EAST","WEST","PORT","STARBOARD","GATE","START","FINISH","OPEN_BRACKET","CLOSE_BRACKET","TO","SEMICOLON","NAUTICAL_MILES","YARDS","FEET","METERS","KILOMETERS","RESERVED_WORDS","NAME","NEWLINE","WHITESPACE","TEXT","ERROR_CHAR"];constructor(t){super(t),this._interp=new oo.atn.LexerATNSimulator(this,lo,ho,new oo.d)}get atn(){return lo}}uo.EOF=oo.Token.EOF,uo.LINE_COMMENT=1,uo.DESCRIPTION=2,uo.EQUALS=3,uo.AMP=4,uo.AT=5,uo.COMMA=6,uo.OPEN_PAREN=7,uo.CLOSE_PAREN=8,uo.POWER=9,uo.TIMES=10,uo.DIVIDED_BY=11,uo.PLUS=12,uo.MINUS=13,uo.UNSIGNED_FLOAT=14,uo.UNSIGNED_INT=15,uo.DEGREE_SYMBOL=16,uo.MINUTE_SYMBOL=17,uo.SECONDS_SYMBOL=18,uo.TRUE=19,uo.MAGNETIC=20,uo.NORTH=21,uo.SOUTH=22,uo.EAST=23,uo.WEST=24,uo.PORT=25,uo.STARBOARD=26,uo.GATE=27,uo.START=28,uo.FINISH=29,uo.OPEN_BRACKET=30,uo.CLOSE_BRACKET=31,uo.TO=32,uo.SEMICOLON=33,uo.NAUTICAL_MILES=34,uo.YARDS=35,uo.FEET=36,uo.METERS=37,uo.KILOMETERS=38,uo.RESERVED_WORDS=39,uo.NAME=40,uo.NEWLINE=41,uo.WHITESPACE=42,uo.TEXT=43,uo.ERROR_CHAR=44;class co extends oo.tree.ParseTreeListener{enterFile(t){}exitFile(t){}enterDefinitionList(t){}exitDefinitionList(t){}enterCOMMENT(t){}exitCOMMENT(t){}enterDEFINITION(t){}exitDEFINITION(t){}enterDEFINITION_WITH_DESC(t){}exitDEFINITION_WITH_DESC(t){}enterDefinition(t){}exitDefinition(t){}enterValueDefinition(t){}exitValueDefinition(t){}enterCourseDefinition(t){}exitCourseDefinition(t){}enterRoundingList(t){}exitRoundingList(t){}enterRounding(t){}exitRounding(t){}enterEXPR_LATITUDE(t){}exitEXPR_LATITUDE(t){}enterEXPR_ANGLE_TRUE(t){}exitEXPR_ANGLE_TRUE(t){}enterEXPR_ANGLE_DMS(t){}exitEXPR_ANGLE_DMS(t){}enterEXPR_DISTANCE(t){}exitEXPR_DISTANCE(t){}enterEXPR_ANGLE_D(t){}exitEXPR_ANGLE_D(t){}enterEXPR_PARENS(t){}exitEXPR_PARENS(t){}enterEXPR_ADDITION(t){}exitEXPR_ADDITION(t){}enterEXPR_SUBTRACTION(t){}exitEXPR_SUBTRACTION(t){}enterEXPR_RELATIVE_LOCATION(t){}exitEXPR_RELATIVE_LOCATION(t){}enterEXPR_REFERENCE(t){}exitEXPR_REFERENCE(t){}enterEXPR_POWER(t){}exitEXPR_POWER(t){}enterEXPR_ANGLE_DM(t){}exitEXPR_ANGLE_DM(t){}enterEXPR_UNARY_MINUS(t){}exitEXPR_UNARY_MINUS(t){}enterEXPR_NUMBER(t){}exitEXPR_NUMBER(t){}enterEXPR_SIMPLE_LOCATION(t){}exitEXPR_SIMPLE_LOCATION(t){}enterEXPR_COURSE_LEG(t){}exitEXPR_COURSE_LEG(t){}enterEXPR_LONGITUDE(t){}exitEXPR_LONGITUDE(t){}enterEXPR_COURSE_ROUNDING(t){}exitEXPR_COURSE_ROUNDING(t){}enterEXPR_FUNCTION_EVAL(t){}exitEXPR_FUNCTION_EVAL(t){}enterEXPR_OFFSET(t){}exitEXPR_OFFSET(t){}enterEXPR_ANGLE_MAGNETIC(t){}exitEXPR_ANGLE_MAGNETIC(t){}enterEXPR_MULTIPLICATION(t){}exitEXPR_MULTIPLICATION(t){}enterEXPR_DIVISION(t){}exitEXPR_DIVISION(t){}enterFLOAT(t){}exitFLOAT(t){}enterINT(t){}exitINT(t){}enterDistanceUnit(t){}exitDistanceUnit(t){}enterRoundingDirection(t){}exitRoundingDirection(t){}}const po=["悋Ꜫ脳맭䅼㯧瞆","奤.Â\t\t","\t\t\t\t","\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f","\r\t\r\n\f"," \v","&\n\f)\v",",\n0\n\r","15\n\f","8\v","?\nC\n","","\b\b\bO\n\b\b","\b\b\bT\n\b\f\b\bW\v\b\t\t\t","\t\t\n\n\n\n\n\n","\n\n\n\ng\n\n\n\n\n\n","\nm\n\n\n\n\n\n\n\n\nu\n\n","\n\n\n\n\n\n\n\n","\n\n\n\n\n\n\n\n\f\n\n","\v\n\n\n\n\n\n\n\n\n\n","\n\n\n\n\n\n\n\n","\n\n\n\n\n\n\n\n\n","\n\n\n\n\n\n\n\n\n","\n\n\n\n\n\n\n\n\n","\n\n\nµ\n\n\f\n\n¸\v\n\v","\v\v¼\n\v\f\f\r\r","\r\b\n\f","","$(Û","+",">\bB\nD","\fHN","X","»½","¿","+"," ","!",' !""',"#'\b$&+","%$&)'%","'((,)'","*,+#","+*,6-/\f",".0+/.01","1/12","23354-","586467","786","9?:?\b;<\b","<==?>9",">:>;?","@C\nAC\fB@","BAC\t","DE*EFFG\n","G\vHI*IJ","JK\bK\rLO\b\b","MO\tNLNM","OUPQ\fQR",'"RT\tSPTW',"USUV","VWUXY*","YZ Z[\r[\\!","\\]^\b\n^","\v_`\t`a\nab\n","bcdd","\negfe","fgghhi\v","ijjkm","lklm","mnno\vop","pq\vqrr","suts","tuuvvw\v","wxxy\vyz","z{\v{||","}*~*","\t\n","#\n","","","","","\n","]_c","fl","t}","~¶","\f\b","µ\n\f\f",'"µ\n\r\f\v',"\vµ","\n\v\f\n\f","µ\n\v\f\t","\rµ\n\n\f\b","µ\n","\t \f ¡","¡µ\n\b¢£\f£¤","¤µ\n¥¦","\f¦§§µ","\n¨©\f©µ","ª«\f«µ","¬­\f­µ","\f®¯\f¯µ\t","°±\f±µ\t","²³\f\r³µ\r´","´´","´´","´´","´¢´¥","´¨´ª","´¬´®","´°´²","µ¸¶´","¶··","¸¶¹¼","º¼»¹","»º¼","½¾\t¾","¿À\tÀ","'+16>BNUflt´","¶»"].join(""),go=(new oo.atn.ATNDeserializer).deserialize(po),fo=go.decisionToState.map(((t,e)=>new oo.dfa.DFA(t,e))),mo=new oo.d;class xo extends oo.Parser{static grammarFileName="definitions3.g4";static literalNames=[null,null,null,"'='","'&'","'@'","','","'('","')'","'^'","'*'","'/'","'+'","'-'",null,null,null,null,null,"'T'","'M'","'N'","'S'","'E'","'W'",null,null,null,"'start'","'finish'","'['","']'",null,"';'",null,null,null,null,null,null,null,"'\n'"];static symbolicNames=[null,"LINE_COMMENT","DESCRIPTION","EQUALS","AMP","AT","COMMA","OPEN_PAREN","CLOSE_PAREN","POWER","TIMES","DIVIDED_BY","PLUS","MINUS","UNSIGNED_FLOAT","UNSIGNED_INT","DEGREE_SYMBOL","MINUTE_SYMBOL","SECONDS_SYMBOL","TRUE","MAGNETIC","NORTH","SOUTH","EAST","WEST","PORT","STARBOARD","GATE","START","FINISH","OPEN_BRACKET","CLOSE_BRACKET","TO","SEMICOLON","NAUTICAL_MILES","YARDS","FEET","METERS","KILOMETERS","RESERVED_WORDS","NAME","NEWLINE","WHITESPACE","TEXT","ERROR_CHAR"];static ruleNames=["file","definitionList","definitionListElement","definition","valueDefinition","courseDefinition","roundingList","rounding","expression","unsignedNumber","distanceUnit","roundingDirection"];constructor(t){super(t),this._interp=new oo.atn.ParserATNSimulator(this,go,fo,mo),this.ruleNames=xo.ruleNames,this.literalNames=xo.literalNames,this.symbolicNames=xo.symbolicNames}get atn(){return go}sempred(t,e,n){switch(e){case 1:return this.definitionList_sempred(t,n);case 6:return this.roundingList_sempred(t,n);case 8:return this.expression_sempred(t,n);default:throw"No predicate with index:"+e}}definitionList_sempred(t,e){switch(e){case 0:return this.precpred(this._ctx,1);default:throw"No predicate with index:"+e}}roundingList_sempred(t,e){switch(e){case 1:return this.precpred(this._ctx,1);default:throw"No predicate with index:"+e}}expression_sempred(t,e){switch(e){case 2:return this.precpred(this._ctx,12);case 3:return this.precpred(this._ctx,10);case 4:return this.precpred(this._ctx,9);case 5:return this.precpred(this._ctx,8);case 6:return this.precpred(this._ctx,7);case 7:return this.precpred(this._ctx,6);case 8:return this.precpred(this._ctx,5);case 9:return this.precpred(this._ctx,3);case 10:return this.precpred(this._ctx,2);case 11:return this.precpred(this._ctx,17);case 12:return this.precpred(this._ctx,16);case 13:return this.precpred(this._ctx,15);case 14:return this.precpred(this._ctx,14);case 15:return this.precpred(this._ctx,13);case 16:return this.precpred(this._ctx,11);default:throw"No predicate with index:"+e}}file(){let t=new Eo(this,this._ctx,this.state);this.enterRule(t,0,xo.RULE_file);var e=0;try{for(this.enterOuterAlt(t,1),this.state=24,this.definitionList(0),this.state=28,this._errHandler.sync(this),e=this._input.LA(1);e===xo.NEWLINE;)this.state=25,this.match(xo.NEWLINE),this.state=30,this._errHandler.sync(this),e=this._input.LA(1);this.state=31,this.match(xo.EOF)}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}definitionList(t){void 0===t&&(t=0);const e=this._ctx,n=this.state;let i=new So(this,this._ctx,n),s=i;this.enterRecursionRule(i,2,xo.RULE_definitionList,t);var r=0;try{switch(this.enterOuterAlt(i,1),this.state=41,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,2,this._ctx)){case 1:this.state=37,this._errHandler.sync(this);for(var o=this._interp.adaptivePredict(this._input,1,this._ctx);2!=o&&o!=oo.atn.ATN.INVALID_ALT_NUMBER;)1===o&&(this.state=34,this.match(xo.NEWLINE)),this.state=39,this._errHandler.sync(this),o=this._interp.adaptivePredict(this._input,1,this._ctx);break;case 2:this.state=40,this.definitionListElement()}for(this._ctx.stop=this._input.LT(-1),this.state=52,this._errHandler.sync(this),o=this._interp.adaptivePredict(this._input,4,this._ctx);2!=o&&o!=oo.atn.ATN.INVALID_ALT_NUMBER;){if(1===o){if(null!==this._parseListeners&&this.triggerExitRuleEvent(),s=i,i=new So(this,e,n),this.pushNewRecursionContext(i,2,xo.RULE_definitionList),this.state=43,!this.precpred(this._ctx,1))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 1)");this.state=45,this._errHandler.sync(this),r=this._input.LA(1);do{this.state=44,this.match(xo.NEWLINE),this.state=47,this._errHandler.sync(this),r=this._input.LA(1)}while(r===xo.NEWLINE);this.state=49,this.definitionListElement()}this.state=54,this._errHandler.sync(this),o=this._interp.adaptivePredict(this._input,4,this._ctx)}}catch(t){if(!(t instanceof oo.error.RecognitionException))throw t;i.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.unrollRecursionContexts(e)}return i}definitionListElement(){let t=new To(this,this._ctx,this.state);this.enterRule(t,4,xo.RULE_definitionListElement);try{switch(this.state=60,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,5,this._ctx)){case 1:t=new Ao(this,t),this.enterOuterAlt(t,1),this.state=55,this.match(xo.LINE_COMMENT);break;case 2:t=new _o(this,t),this.enterOuterAlt(t,2),this.state=56,this.definition();break;case 3:t=new vo(this,t),this.enterOuterAlt(t,3),this.state=57,this.definition(),this.state=58,this.match(xo.DESCRIPTION)}}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}definition(){let t=new No(this,this._ctx,this.state);this.enterRule(t,6,xo.RULE_definition);try{switch(this.state=64,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,6,this._ctx)){case 1:this.enterOuterAlt(t,1),this.state=62,this.valueDefinition();break;case 2:this.enterOuterAlt(t,2),this.state=63,this.courseDefinition()}}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}valueDefinition(){let t=new yo(this,this._ctx,this.state);this.enterRule(t,8,xo.RULE_valueDefinition);try{this.enterOuterAlt(t,1),this.state=66,this.match(xo.NAME),this.state=67,this.match(xo.EQUALS),this.state=68,this.expression(0)}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}courseDefinition(){let t=new Co(this,this._ctx,this.state);this.enterRule(t,10,xo.RULE_courseDefinition);try{this.enterOuterAlt(t,1),this.state=70,this.match(xo.NAME),this.state=71,this.match(xo.EQUALS),this.state=72,this.roundingList(0)}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}roundingList(t){void 0===t&&(t=0);const e=this._ctx,n=this.state;let i=new Mo(this,this._ctx,n),s=i;this.enterRecursionRule(i,12,xo.RULE_roundingList,t);try{switch(this.enterOuterAlt(i,1),this.state=76,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,7,this._ctx)){case 1:break;case 2:this.state=75,this.rounding()}this._ctx.stop=this._input.LT(-1),this.state=83,this._errHandler.sync(this);for(var r=this._interp.adaptivePredict(this._input,8,this._ctx);2!=r&&r!=oo.atn.ATN.INVALID_ALT_NUMBER;){if(1===r){if(null!==this._parseListeners&&this.triggerExitRuleEvent(),s=i,i=new Mo(this,e,n),this.pushNewRecursionContext(i,12,xo.RULE_roundingList),this.state=78,!this.precpred(this._ctx,1))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 1)");this.state=79,this.match(xo.TO),this.state=80,this.rounding()}this.state=85,this._errHandler.sync(this),r=this._interp.adaptivePredict(this._input,8,this._ctx)}}catch(t){if(!(t instanceof oo.error.RecognitionException))throw t;i.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.unrollRecursionContexts(e)}return i}rounding(){let t=new Lo(this,this._ctx,this.state);this.enterRule(t,14,xo.RULE_rounding);try{this.enterOuterAlt(t,1),this.state=86,this.match(xo.NAME),this.state=87,this.match(xo.OPEN_BRACKET),this.state=88,this.roundingDirection(),this.state=89,this.match(xo.CLOSE_BRACKET)}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}expression(t){void 0===t&&(t=0);const e=this._ctx,n=this.state;let i=new wo(this,this._ctx,n),s=i;const r=16;this.enterRecursionRule(i,16,xo.RULE_expression,t);var o=0;try{switch(this.enterOuterAlt(i,1),this.state=137,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,14,this._ctx)){case 1:i=new Vo(this,i),this._ctx=i,s=i,this.state=92,this.unsignedNumber();break;case 2:i=new Oo(this,i),this._ctx=i,s=i,this.state=93,this.match(xo.OPEN_PAREN),this.state=94,this.expression(0),this.state=95,this.match(xo.CLOSE_PAREN);break;case 3:i=new Go(this,i),this._ctx=i,s=i,this.state=97,this.match(xo.MINUS),this.state=98,this.expression(21);break;case 4:i=new bo(this,i),this._ctx=i,s=i,this.state=100,this._errHandler.sync(this),(o=this._input.LA(1))===xo.MINUS&&(this.state=99,this.match(xo.MINUS)),this.state=102,this.unsignedNumber(),this.state=103,this.match(xo.DEGREE_SYMBOL);break;case 5:i=new Ho(this,i),this._ctx=i,s=i,this.state=106,this._errHandler.sync(this),(o=this._input.LA(1))===xo.MINUS&&(this.state=105,this.match(xo.MINUS)),this.state=108,this.unsignedNumber(),this.state=109,this.match(xo.DEGREE_SYMBOL),this.state=110,this.unsignedNumber(),this.state=111,this.match(xo.MINUTE_SYMBOL);break;case 6:i=new Io(this,i),this._ctx=i,s=i,this.state=114,this._errHandler.sync(this),(o=this._input.LA(1))===xo.MINUS&&(this.state=113,this.match(xo.MINUS)),this.state=116,this.unsignedNumber(),this.state=117,this.match(xo.DEGREE_SYMBOL),this.state=118,this.unsignedNumber(),this.state=119,this.match(xo.MINUTE_SYMBOL),this.state=120,this.unsignedNumber(),this.state=121,this.match(xo.SECONDS_SYMBOL);break;case 7:i=new zo(this,i),this._ctx=i,s=i,this.state=123,this.match(xo.NAME);break;case 8:if(i=new qo(this,i),this._ctx=i,s=i,this.state=124,this.match(xo.NAME),this.state=125,this.match(xo.OPEN_PAREN),this.state=134,this._errHandler.sync(this),0==(-32&(o=this._input.LA(1)))&&0!=(1<<o&(1<<xo.OPEN_PAREN|1<<xo.MINUS|1<<xo.UNSIGNED_FLOAT|1<<xo.UNSIGNED_INT))||o===xo.NAME)for(this.state=126,this.expression(0),this.state=131,this._errHandler.sync(this),o=this._input.LA(1);o===xo.SEMICOLON;)this.state=127,this.match(xo.SEMICOLON),this.state=128,this.expression(0),this.state=133,this._errHandler.sync(this),o=this._input.LA(1);this.state=136,this.match(xo.CLOSE_PAREN)}this._ctx.stop=this._input.LT(-1),this.state=180,this._errHandler.sync(this);for(var a=this._interp.adaptivePredict(this._input,16,this._ctx);2!=a&&a!=oo.atn.ATN.INVALID_ALT_NUMBER;){if(1===a)switch(null!==this._parseListeners&&this.triggerExitRuleEvent(),s=i,this.state=178,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,15,this._ctx)){case 1:if(i=new Xo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=139,!this.precpred(this._ctx,12))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 12)");this.state=140,this.match(xo.COMMA),this.state=141,this.expression(13);break;case 2:if(i=new $o(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=142,!this.precpred(this._ctx,10))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 10)");this.state=143,this.match(xo.TO),this.state=144,this.expression(11);break;case 3:if(i=new Bo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=145,!this.precpred(this._ctx,9))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 9)");this.state=146,this.match(xo.POWER),this.state=147,this.expression(9);break;case 4:if(i=new Jo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=148,!this.precpred(this._ctx,8))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 8)");this.state=149,this.match(xo.TIMES),this.state=150,this.expression(9);break;case 5:if(i=new Qo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=151,!this.precpred(this._ctx,7))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 7)");this.state=152,this.match(xo.DIVIDED_BY),this.state=153,this.expression(8);break;case 6:if(i=new Po(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=154,!this.precpred(this._ctx,6))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 6)");this.state=155,this.match(xo.PLUS),this.state=156,this.expression(7);break;case 7:if(i=new Fo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=157,!this.precpred(this._ctx,5))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 5)");this.state=158,this.match(xo.MINUS),this.state=159,this.expression(6);break;case 8:if(i=new Wo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=160,!this.precpred(this._ctx,3))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 3)");this.state=161,this.match(xo.AT),this.state=162,this.expression(4);break;case 9:if(i=new Uo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=163,!this.precpred(this._ctx,2))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 2)");this.state=164,this.match(xo.AMP),this.state=165,this.expression(3);break;case 10:if(i=new ko(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=166,!this.precpred(this._ctx,17))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 17)");this.state=167,this.match(xo.TRUE);break;case 11:if(i=new Ko(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=168,!this.precpred(this._ctx,16))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 16)");this.state=169,this.match(xo.MAGNETIC);break;case 12:if(i=new Do(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=170,!this.precpred(this._ctx,15))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 15)");this.state=171,this.distanceUnit();break;case 13:if(i=new Yo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=172,!this.precpred(this._ctx,14))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 14)");this.state=173,(o=this._input.LA(1))!==xo.EAST&&o!==xo.WEST?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume());break;case 14:if(i=new Ro(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=174,!this.precpred(this._ctx,13))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 13)");this.state=175,(o=this._input.LA(1))!==xo.NORTH&&o!==xo.SOUTH?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume());break;case 15:if(i=new jo(this,new wo(this,e,n)),this.pushNewRecursionContext(i,r,xo.RULE_expression),this.state=176,!this.precpred(this._ctx,11))throw new oo.error.FailedPredicateException(this,"this.precpred(this._ctx, 11)");this.state=177,this.roundingDirection()}this.state=182,this._errHandler.sync(this),a=this._interp.adaptivePredict(this._input,16,this._ctx)}}catch(t){if(!(t instanceof oo.error.RecognitionException))throw t;i.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.unrollRecursionContexts(e)}return i}unsignedNumber(){let t=new Zo(this,this._ctx,this.state);this.enterRule(t,18,xo.RULE_unsignedNumber);try{switch(this.state=185,this._errHandler.sync(this),this._input.LA(1)){case xo.UNSIGNED_FLOAT:t=new ta(this,t),this.enterOuterAlt(t,1),this.state=183,this.match(xo.UNSIGNED_FLOAT);break;case xo.UNSIGNED_INT:t=new ea(this,t),this.enterOuterAlt(t,2),this.state=184,this.match(xo.UNSIGNED_INT);break;default:throw new oo.error.NoViableAltException(this)}}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}distanceUnit(){let t=new na(this,this._ctx,this.state);this.enterRule(t,20,xo.RULE_distanceUnit);var e=0;try{this.enterOuterAlt(t,1),this.state=187,0!=((e=this._input.LA(1))-34&-32)||0==(1<<e-34&(1<<xo.NAUTICAL_MILES-34|1<<xo.YARDS-34|1<<xo.FEET-34|1<<xo.METERS-34|1<<xo.KILOMETERS-34))?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}roundingDirection(){let t=new ia(this,this._ctx,this.state);this.enterRule(t,22,xo.RULE_roundingDirection);var e=0;try{this.enterOuterAlt(t,1),this.state=189,0!=(-32&(e=this._input.LA(1)))||0==(1<<e&(1<<xo.PORT|1<<xo.STARBOARD|1<<xo.GATE|1<<xo.START|1<<xo.FINISH))?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof oo.error.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}}xo.EOF=oo.Token.EOF,xo.LINE_COMMENT=1,xo.DESCRIPTION=2,xo.EQUALS=3,xo.AMP=4,xo.AT=5,xo.COMMA=6,xo.OPEN_PAREN=7,xo.CLOSE_PAREN=8,xo.POWER=9,xo.TIMES=10,xo.DIVIDED_BY=11,xo.PLUS=12,xo.MINUS=13,xo.UNSIGNED_FLOAT=14,xo.UNSIGNED_INT=15,xo.DEGREE_SYMBOL=16,xo.MINUTE_SYMBOL=17,xo.SECONDS_SYMBOL=18,xo.TRUE=19,xo.MAGNETIC=20,xo.NORTH=21,xo.SOUTH=22,xo.EAST=23,xo.WEST=24,xo.PORT=25,xo.STARBOARD=26,xo.GATE=27,xo.START=28,xo.FINISH=29,xo.OPEN_BRACKET=30,xo.CLOSE_BRACKET=31,xo.TO=32,xo.SEMICOLON=33,xo.NAUTICAL_MILES=34,xo.YARDS=35,xo.FEET=36,xo.METERS=37,xo.KILOMETERS=38,xo.RESERVED_WORDS=39,xo.NAME=40,xo.NEWLINE=41,xo.WHITESPACE=42,xo.TEXT=43,xo.ERROR_CHAR=44,xo.RULE_file=0,xo.RULE_definitionList=1,xo.RULE_definitionListElement=2,xo.RULE_definition=3,xo.RULE_valueDefinition=4,xo.RULE_courseDefinition=5,xo.RULE_roundingList=6,xo.RULE_rounding=7,xo.RULE_expression=8,xo.RULE_unsignedNumber=9,xo.RULE_distanceUnit=10,xo.RULE_roundingDirection=11;class Eo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_file}definitionList(){return this.getTypedRuleContext(So,0)}EOF(){return this.getToken(xo.EOF,0)}NEWLINE=function(t){return void 0===t&&(t=null),null===t?this.getTokens(xo.NEWLINE):this.getToken(xo.NEWLINE,t)};enterRule(t){t instanceof co&&t.enterFile(this)}exitRule(t){t instanceof co&&t.exitFile(this)}}class So extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_definitionList}NEWLINE=function(t){return void 0===t&&(t=null),null===t?this.getTokens(xo.NEWLINE):this.getToken(xo.NEWLINE,t)};definitionListElement(){return this.getTypedRuleContext(To,0)}definitionList(){return this.getTypedRuleContext(So,0)}enterRule(t){t instanceof co&&t.enterDefinitionList(this)}exitRule(t){t instanceof co&&t.exitDefinitionList(this)}}class To extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_definitionListElement}copyFrom(t){super.copyFrom(t)}}class _o extends To{constructor(t,e){super(t),super.copyFrom(e)}definition(){return this.getTypedRuleContext(No,0)}enterRule(t){t instanceof co&&t.enterDEFINITION(this)}exitRule(t){t instanceof co&&t.exitDEFINITION(this)}}xo.DEFINITIONContext=_o;class vo extends To{constructor(t,e){super(t),super.copyFrom(e)}definition(){return this.getTypedRuleContext(No,0)}DESCRIPTION(){return this.getToken(xo.DESCRIPTION,0)}enterRule(t){t instanceof co&&t.enterDEFINITION_WITH_DESC(this)}exitRule(t){t instanceof co&&t.exitDEFINITION_WITH_DESC(this)}}xo.DEFINITION_WITH_DESCContext=vo;class Ao extends To{constructor(t,e){super(t),super.copyFrom(e)}LINE_COMMENT(){return this.getToken(xo.LINE_COMMENT,0)}enterRule(t){t instanceof co&&t.enterCOMMENT(this)}exitRule(t){t instanceof co&&t.exitCOMMENT(this)}}xo.COMMENTContext=Ao;class No extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_definition}valueDefinition(){return this.getTypedRuleContext(yo,0)}courseDefinition(){return this.getTypedRuleContext(Co,0)}enterRule(t){t instanceof co&&t.enterDefinition(this)}exitRule(t){t instanceof co&&t.exitDefinition(this)}}class yo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_valueDefinition}NAME(){return this.getToken(xo.NAME,0)}EQUALS(){return this.getToken(xo.EQUALS,0)}expression(){return this.getTypedRuleContext(wo,0)}enterRule(t){t instanceof co&&t.enterValueDefinition(this)}exitRule(t){t instanceof co&&t.exitValueDefinition(this)}}class Co extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_courseDefinition}NAME(){return this.getToken(xo.NAME,0)}EQUALS(){return this.getToken(xo.EQUALS,0)}roundingList(){return this.getTypedRuleContext(Mo,0)}enterRule(t){t instanceof co&&t.enterCourseDefinition(this)}exitRule(t){t instanceof co&&t.exitCourseDefinition(this)}}class Mo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_roundingList}rounding(){return this.getTypedRuleContext(Lo,0)}roundingList(){return this.getTypedRuleContext(Mo,0)}TO(){return this.getToken(xo.TO,0)}enterRule(t){t instanceof co&&t.enterRoundingList(this)}exitRule(t){t instanceof co&&t.exitRoundingList(this)}}class Lo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_rounding}NAME(){return this.getToken(xo.NAME,0)}OPEN_BRACKET(){return this.getToken(xo.OPEN_BRACKET,0)}roundingDirection(){return this.getTypedRuleContext(ia,0)}CLOSE_BRACKET(){return this.getToken(xo.CLOSE_BRACKET,0)}enterRule(t){t instanceof co&&t.enterRounding(this)}exitRule(t){t instanceof co&&t.exitRounding(this)}}class wo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_expression}copyFrom(t){super.copyFrom(t)}}class Ro extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}NORTH(){return this.getToken(xo.NORTH,0)}SOUTH(){return this.getToken(xo.SOUTH,0)}enterRule(t){t instanceof co&&t.enterEXPR_LATITUDE(this)}exitRule(t){t instanceof co&&t.exitEXPR_LATITUDE(this)}}xo.EXPR_LATITUDEContext=Ro;class ko extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}TRUE(){return this.getToken(xo.TRUE,0)}enterRule(t){t instanceof co&&t.enterEXPR_ANGLE_TRUE(this)}exitRule(t){t instanceof co&&t.exitEXPR_ANGLE_TRUE(this)}}xo.EXPR_ANGLE_TRUEContext=ko;class Io extends wo{constructor(t,e){super(t),super.copyFrom(e)}unsignedNumber=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(Zo):this.getTypedRuleContext(Zo,t)};DEGREE_SYMBOL(){return this.getToken(xo.DEGREE_SYMBOL,0)}MINUTE_SYMBOL(){return this.getToken(xo.MINUTE_SYMBOL,0)}SECONDS_SYMBOL(){return this.getToken(xo.SECONDS_SYMBOL,0)}MINUS(){return this.getToken(xo.MINUS,0)}enterRule(t){t instanceof co&&t.enterEXPR_ANGLE_DMS(this)}exitRule(t){t instanceof co&&t.exitEXPR_ANGLE_DMS(this)}}xo.EXPR_ANGLE_DMSContext=Io;class Do extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}distanceUnit(){return this.getTypedRuleContext(na,0)}enterRule(t){t instanceof co&&t.enterEXPR_DISTANCE(this)}exitRule(t){t instanceof co&&t.exitEXPR_DISTANCE(this)}}xo.EXPR_DISTANCEContext=Do;class bo extends wo{constructor(t,e){super(t),super.copyFrom(e)}unsignedNumber(){return this.getTypedRuleContext(Zo,0)}DEGREE_SYMBOL(){return this.getToken(xo.DEGREE_SYMBOL,0)}MINUS(){return this.getToken(xo.MINUS,0)}enterRule(t){t instanceof co&&t.enterEXPR_ANGLE_D(this)}exitRule(t){t instanceof co&&t.exitEXPR_ANGLE_D(this)}}xo.EXPR_ANGLE_DContext=bo;class Oo extends wo{constructor(t,e){super(t),super.copyFrom(e)}OPEN_PAREN(){return this.getToken(xo.OPEN_PAREN,0)}expression(){return this.getTypedRuleContext(wo,0)}CLOSE_PAREN(){return this.getToken(xo.CLOSE_PAREN,0)}enterRule(t){t instanceof co&&t.enterEXPR_PARENS(this)}exitRule(t){t instanceof co&&t.exitEXPR_PARENS(this)}}xo.EXPR_PARENSContext=Oo;class Po extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};PLUS(){return this.getToken(xo.PLUS,0)}enterRule(t){t instanceof co&&t.enterEXPR_ADDITION(this)}exitRule(t){t instanceof co&&t.exitEXPR_ADDITION(this)}}xo.EXPR_ADDITIONContext=Po;class Fo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};MINUS(){return this.getToken(xo.MINUS,0)}enterRule(t){t instanceof co&&t.enterEXPR_SUBTRACTION(this)}exitRule(t){t instanceof co&&t.exitEXPR_SUBTRACTION(this)}}xo.EXPR_SUBTRACTIONContext=Fo;class Uo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};AMP(){return this.getToken(xo.AMP,0)}enterRule(t){t instanceof co&&t.enterEXPR_RELATIVE_LOCATION(this)}exitRule(t){t instanceof co&&t.exitEXPR_RELATIVE_LOCATION(this)}}xo.EXPR_RELATIVE_LOCATIONContext=Uo;class zo extends wo{constructor(t,e){super(t),super.copyFrom(e)}NAME(){return this.getToken(xo.NAME,0)}enterRule(t){t instanceof co&&t.enterEXPR_REFERENCE(this)}exitRule(t){t instanceof co&&t.exitEXPR_REFERENCE(this)}}xo.EXPR_REFERENCEContext=zo;class Bo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};POWER(){return this.getToken(xo.POWER,0)}enterRule(t){t instanceof co&&t.enterEXPR_POWER(this)}exitRule(t){t instanceof co&&t.exitEXPR_POWER(this)}}xo.EXPR_POWERContext=Bo;class Ho extends wo{constructor(t,e){super(t),super.copyFrom(e)}unsignedNumber=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(Zo):this.getTypedRuleContext(Zo,t)};DEGREE_SYMBOL(){return this.getToken(xo.DEGREE_SYMBOL,0)}MINUTE_SYMBOL(){return this.getToken(xo.MINUTE_SYMBOL,0)}MINUS(){return this.getToken(xo.MINUS,0)}enterRule(t){t instanceof co&&t.enterEXPR_ANGLE_DM(this)}exitRule(t){t instanceof co&&t.exitEXPR_ANGLE_DM(this)}}xo.EXPR_ANGLE_DMContext=Ho;class Go extends wo{constructor(t,e){super(t),super.copyFrom(e)}MINUS(){return this.getToken(xo.MINUS,0)}expression(){return this.getTypedRuleContext(wo,0)}enterRule(t){t instanceof co&&t.enterEXPR_UNARY_MINUS(this)}exitRule(t){t instanceof co&&t.exitEXPR_UNARY_MINUS(this)}}xo.EXPR_UNARY_MINUSContext=Go;class Vo extends wo{constructor(t,e){super(t),super.copyFrom(e)}unsignedNumber(){return this.getTypedRuleContext(Zo,0)}enterRule(t){t instanceof co&&t.enterEXPR_NUMBER(this)}exitRule(t){t instanceof co&&t.exitEXPR_NUMBER(this)}}xo.EXPR_NUMBERContext=Vo;class Xo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};COMMA(){return this.getToken(xo.COMMA,0)}enterRule(t){t instanceof co&&t.enterEXPR_SIMPLE_LOCATION(this)}exitRule(t){t instanceof co&&t.exitEXPR_SIMPLE_LOCATION(this)}}xo.EXPR_SIMPLE_LOCATIONContext=Xo;class $o extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};TO(){return this.getToken(xo.TO,0)}enterRule(t){t instanceof co&&t.enterEXPR_COURSE_LEG(this)}exitRule(t){t instanceof co&&t.exitEXPR_COURSE_LEG(this)}}xo.EXPR_COURSE_LEGContext=$o;class Yo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}EAST(){return this.getToken(xo.EAST,0)}WEST(){return this.getToken(xo.WEST,0)}enterRule(t){t instanceof co&&t.enterEXPR_LONGITUDE(this)}exitRule(t){t instanceof co&&t.exitEXPR_LONGITUDE(this)}}xo.EXPR_LONGITUDEContext=Yo;class jo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}roundingDirection(){return this.getTypedRuleContext(ia,0)}enterRule(t){t instanceof co&&t.enterEXPR_COURSE_ROUNDING(this)}exitRule(t){t instanceof co&&t.exitEXPR_COURSE_ROUNDING(this)}}xo.EXPR_COURSE_ROUNDINGContext=jo;class qo extends wo{constructor(t,e){super(t),super.copyFrom(e)}NAME(){return this.getToken(xo.NAME,0)}OPEN_PAREN(){return this.getToken(xo.OPEN_PAREN,0)}CLOSE_PAREN(){return this.getToken(xo.CLOSE_PAREN,0)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};SEMICOLON=function(t){return void 0===t&&(t=null),null===t?this.getTokens(xo.SEMICOLON):this.getToken(xo.SEMICOLON,t)};enterRule(t){t instanceof co&&t.enterEXPR_FUNCTION_EVAL(this)}exitRule(t){t instanceof co&&t.exitEXPR_FUNCTION_EVAL(this)}}xo.EXPR_FUNCTION_EVALContext=qo;class Wo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};AT(){return this.getToken(xo.AT,0)}enterRule(t){t instanceof co&&t.enterEXPR_OFFSET(this)}exitRule(t){t instanceof co&&t.exitEXPR_OFFSET(this)}}xo.EXPR_OFFSETContext=Wo;class Ko extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression(){return this.getTypedRuleContext(wo,0)}MAGNETIC(){return this.getToken(xo.MAGNETIC,0)}enterRule(t){t instanceof co&&t.enterEXPR_ANGLE_MAGNETIC(this)}exitRule(t){t instanceof co&&t.exitEXPR_ANGLE_MAGNETIC(this)}}xo.EXPR_ANGLE_MAGNETICContext=Ko;class Jo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};TIMES(){return this.getToken(xo.TIMES,0)}enterRule(t){t instanceof co&&t.enterEXPR_MULTIPLICATION(this)}exitRule(t){t instanceof co&&t.exitEXPR_MULTIPLICATION(this)}}xo.EXPR_MULTIPLICATIONContext=Jo;class Qo extends wo{constructor(t,e){super(t),super.copyFrom(e)}expression=function(t){return void 0===t&&(t=null),null===t?this.getTypedRuleContexts(wo):this.getTypedRuleContext(wo,t)};DIVIDED_BY(){return this.getToken(xo.DIVIDED_BY,0)}enterRule(t){t instanceof co&&t.enterEXPR_DIVISION(this)}exitRule(t){t instanceof co&&t.exitEXPR_DIVISION(this)}}xo.EXPR_DIVISIONContext=Qo;class Zo extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_unsignedNumber}copyFrom(t){super.copyFrom(t)}}class ta extends Zo{constructor(t,e){super(t),super.copyFrom(e)}UNSIGNED_FLOAT(){return this.getToken(xo.UNSIGNED_FLOAT,0)}enterRule(t){t instanceof co&&t.enterFLOAT(this)}exitRule(t){t instanceof co&&t.exitFLOAT(this)}}xo.FLOATContext=ta;class ea extends Zo{constructor(t,e){super(t),super.copyFrom(e)}UNSIGNED_INT(){return this.getToken(xo.UNSIGNED_INT,0)}enterRule(t){t instanceof co&&t.enterINT(this)}exitRule(t){t instanceof co&&t.exitINT(this)}}xo.INTContext=ea;class na extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_distanceUnit}NAUTICAL_MILES(){return this.getToken(xo.NAUTICAL_MILES,0)}YARDS(){return this.getToken(xo.YARDS,0)}FEET(){return this.getToken(xo.FEET,0)}METERS(){return this.getToken(xo.METERS,0)}KILOMETERS(){return this.getToken(xo.KILOMETERS,0)}enterRule(t){t instanceof co&&t.enterDistanceUnit(this)}exitRule(t){t instanceof co&&t.exitDistanceUnit(this)}}class ia extends oo.ParserRuleContext{constructor(t,e,n){void 0===e&&(e=null),null==n&&(n=-1),super(e,n),this.parser=t,this.ruleIndex=xo.RULE_roundingDirection}START(){return this.getToken(xo.START,0)}STARBOARD(){return this.getToken(xo.STARBOARD,0)}GATE(){return this.getToken(xo.GATE,0)}PORT(){return this.getToken(xo.PORT,0)}FINISH(){return this.getToken(xo.FINISH,0)}enterRule(t){t instanceof co&&t.enterRoundingDirection(this)}exitRule(t){t instanceof co&&t.exitRoundingDirection(this)}}xo.FileContext=Eo,xo.DefinitionListContext=So,xo.DefinitionListElementContext=To,xo.DefinitionContext=No,xo.ValueDefinitionContext=yo,xo.CourseDefinitionContext=Co,xo.RoundingListContext=Mo,xo.RoundingContext=Lo,xo.ExpressionContext=wo,xo.UnsignedNumberContext=Zo,xo.DistanceUnitContext=na,xo.RoundingDirectionContext=ia;class sa{constructor(t,e){this.ctx=t,this.message=e}}function ra(t,e){if(!(e instanceof da||e instanceof Ea))throw new sa(t,"Expecting number or distance")}function oa(t,e){if(!(e instanceof da||e instanceof pa))throw new sa(t,"Expecting number or angle")}function aa(t,e){if(!(e instanceof xa))throw new sa(t,"Expecting location")}function la(t,e){if(!(e instanceof Ta))throw new sa(t,"Expecting offset")}const ha={pi:(t,e,n)=>{if(0!=n.length)throw`pi() takes no arguments, not ${n.length}`;return new da(Math.PI)},abs:(t,e,n)=>{if(1!=n.length)throw`abs() takes one number or angle or latitude or longitude ${n.length}`;return ra(t,n[0]),new da(Math.abs(n[0].getValue()))},sqrt:(t,e,n)=>{if(1!=n.length)throw`sin() takes one number or distance, not ${n.length}`;return ra(t,n[0]),new da(Math.sqrt(n[0].getValue()))},log:(t,e,n)=>{if(1!=n.length)throw`log() takes one number or distance, not ${n.length}`;return ra(t,n[0]),new da(Math.log(n[0].getValue()))},log10:(t,e,n)=>{if(1!=n.length)throw`log10() takes one number or distance, not ${n.length}`;return ra(t,n[0]),new da(Math.log10(n[0].getValue()))},exp:(t,e,n)=>{if(1!=n.length)throw`exp() takes one number or distance, not ${n.length}`;return ra(t,n[0]),new da(Math.exp(n[0].getValue()))},sin:(t,e,n)=>{if(1!=n.length)throw`sin() takes one number or angle, not ${n.length}`;return oa(t,n[0]),new da(Math.sin(Math.PI/180*n[0].getValue()))},cos:(t,e,n)=>{if(1!=n.length)throw`cos() takes one number or angle, not ${n.length}`;return oa(t,n[0]),new da(Math.cos(Math.PI/180*n[0].getValue()))},tan:(t,e,n)=>{if(1!=n.length)throw`tan() takes one number or angle, not ${n.length}`;return oa(t,n[0]),new da(Math.tan(Math.PI/180*n[0].getValue()))},asin:(t,e,n)=>{if(1!=n.length)throw`asin() takes one number, not ${n.length}`;return ra(t,n[0]),new pa(180/Math.PI*Math.asin(n[0].getValue()))},acos:(t,e,n)=>{if(1!=n.length)throw`acos() takes one number, not ${n.length}`;return ra(t,n[0]),new pa(180/Math.PI*Math.acos(n[0].getValue()))},atan:(t,e,n)=>{if(1!=n.length)throw`atan() takes one number, not ${n.length}`;return ra(t,n[0]),new pa(180/Math.PI*Math.atan(n[0].getValue()))},atan2:(t,e,n)=>{if(2!=n.length)throw`atan2() takes two numbers or distances, not ${n.length} -- did you perhaps use a comma and pass in a location?`;return ra(t,n[0]),ra(t,n[1]),new pa(180/Math.PI*Math.atan2(n[0].getValue(),n[1].getValue()))},distance:(t,e,n)=>{if(1!=n.length)throw`distance() takes one offset, not ${n.length}`;return la(t,n[0]),new Ea(n[0].distance.distanceInMeters,new Sa(n[0].distance.displayUnitName))},azimuth:(t,e,n)=>{if(1!=n.length)throw`azimuth() takes one offset, not ${n.length}`;return la(t,n[0]),new ga(n[0].azimuth.degrees,n[0].isMagnetic)},longitude:(t,e,n)=>{if(1!=n.length)throw`longitude() takes one location, not ${n.length}`;return aa(t,n[0]),new pa(n[0].longitude)},latitude:(t,e,n)=>{if(1!=n.length)throw`latitude() takes one location, not ${n.length}`;return aa(t,n[0]),new pa(n[0].latitude)},length:(t,e,n)=>{if(0===n.length)return new Ea(0,"meters");if(1===n.length&&"MDLCourse"===n[0].type){let t=0;for(let i=0;i<n[0].roundings.roundings.length-1;i++){let s=e.lookup(n[0].roundings.roundings[i].name),r=e.lookup(n[0].roundings.roundings[i+1].name);t+=Xr(s.value,r.value).distanceInMeters}return new Ea(t,new Sa("meters"))}{for(let e=0;e<n.length;e++)aa(t,n[e]);let e=0;for(let t=0;t<n.length-1;t++)e+=Xr(n[t],n[t+1]).distanceInMeters;return new Ea(e,new Sa("meters"))}}};class ua{constructor(t,e){void 0===e&&(e=[]),this.type="MarkDefinitionsList",this.definitions=e,this.map={},this.definitions.forEach(((t,e)=>{t instanceof Ca&&(this.map[t.name]=t)})),"MagneticVariation"in this.map||(Math.round(t,2),this.push(new Ca(new ca("MagneticVariation"),new da(t),"! interpolated from USGS WMM 2020-2025 for Alcatraz, good for around 1/3 degree in SFBay")))}push(t){this.definitions.push(t),t instanceof Ca&&(this.map[t.name]=t)}hasName(t,e){if(t instanceof ca&&(t=t.name),t in this.map){let n=this.map[t];if(void 0===e||n.value.type===e)return!0}return!1}hasCourseName(t){return this.hasName(t,"MDLCourse")}hasLocationName(t){return this.hasName(t,"MDLLocation")}lookup(t){if(t instanceof ca&&(t=t.name),t in this.map)return this.map[t];throw`Undefined reference to ${t} `}getDefinitionNames(t){let e=[];for(let n=0;n<this.definitions.length;n++)if("MDLDefinition"===this.definitions[n].type){let i=this.definitions[n];if(void 0===t||i.value.type===t){let t=i.name;e.includes(t)||e.push(t)}}return e}get length(){return this.map.length}keys(){return Object.keys(this.map)}}class ca{constructor(t){this.type="MDLName",this.name=t}}class da{constructor(t){this.type="MDLNumber",this.value=t}getValue(){return this.value}}class pa{constructor(t,e,n,i){void 0===t&&(t=0),t instanceof da&&(t=t.value),void 0===e&&(e=0),e instanceof da&&(e=e.value),void 0===n&&(n=0),n instanceof da&&(n=n.value),this.type="MDLAngle";let s=t<0;t=Math.abs(t),e=Math.abs(e);let r=((n=Math.abs(n))/60+e)/60+t;void 0===i||!0!==i&&"-"!=i||(r*=-1),s&&(r*=-1),this.degrees=r}getValue(){return this.degrees}}class ga{constructor(t,e){this.type="MDLAzimuth",t instanceof da?this.degrees=t.value:t instanceof pa?this.degrees=t.degrees:Nr(t)&&(this.degrees=t),this.isMagnetic=e}getValue(){return this.degrees}}class fa{constructor(t){if(this.type="MDLLongitude",!Nr(t))throw`Bad longitude ${t}`;this.longitude=t}getValue(){return this.longitiude}}class ma{constructor(t){if(this.type="MDLLatitude",!Nr(t))throw`Bad latitude ${t}`;this.latitude=t}getValue(){return this.latitude}}class xa{constructor(t,e){if(!(t instanceof fa))throw`Bad longitude ${t}`;if(!(e instanceof ma))throw`Bad latitude ${e}`;this.type="MDLLocation",this.longitude=t.longitude,this.latitude=e.latitude}}class Ea{constructor(t,e){if(this.type="MDLDistance",t instanceof da)this.distanceInMeters=t.value;else{if(!Nr(t))throw`unprocessed type ${t.toString()}`;this.distanceInMeters=t}if(!(e instanceof Sa))throw`unprocessed type ${e.toString()}`;this.displayUnitName=e.unitName}getValue(){return this.distanceInMeters}}class Sa{constructor(t){if(!["nauticalMiles","yards","feet","meters","kilometers"].includes(t))throw`unknown distance unit ${t}`;this.type="MDLDistanceUnit",this.unitName=t}}class Ta{constructor(t,e){this.type="MDLOffset",this.distance=t,this.azimuth=e}}class _a{constructor(){this.type="MDLRoundingList",this.roundings=[]}appendRoundings(t){t.forEach((t=>this.roundings.push(t)))}prependRoundings(t){t.forEach((t=>this.roundings.unshift(t)))}}class va{constructor(t,e){this.type="MDLRounding",this.name=t,this.direction=e}}class Aa{constructor(t){if(this.type="MDLRoundingDirection",!["start","finish","starboard","port","gate"].includes(t))throw`unknown roundingDirection ${t}`;this.direction=t}}class Na{constructor(t,e,n){this.type="MDLCourse",this.name=t,this.roundings=e,this.extra=n}}class ya{constructor(t){this.type="MDLComment",this.comment=t}}class Ca{constructor(t,e,n,i,s,r){this.type="MDLDefinition",this.name=t.name,this.value=e,this.description=n,void 0===i&&(i=!1),this.isFn=i,this.fnArgs=s,this.fnArgTypes=r}}class Ma extends co{constructor(t){super(),this.definitionsList=t,this.contextStack=[]}exitCOMMENT(t){let e=t.LINE_COMMENT().getText();this.definitionsList.push(new ya(e))}exitDEFINITION(t){let e=this.contextStack.pop();if(!(e instanceof Ca))throw"bad definition!";this.definitionsList.push(e)}exitDEFINITION_WITH_DESC(t){let e=t.DESCRIPTION().getText(),n=this.contextStack.pop();this.definitionsList.push(new Ca(n,n.value,e))}exitFLOAT(t){let e=t.UNSIGNED_FLOAT().getText(),n=Number.parseFloat(e);this.contextStack.push(new da(n))}exitINT(t){let e=t.UNSIGNED_INT().getText(),n=Number.parseInt(e);this.contextStack.push(new da(n))}exitEXPR_NUMBER(t){let e=this.contextStack.pop();if(!(e instanceof da))throw new this.SyntaxError(t,"expected number");this.contextStack.push(e)}exitEXPR_ANGLE_D(t){let e=null!==t.MINUS(),n=this.contextStack.pop();this.contextStack.push(new pa(n,0,0,e))}exitEXPR_ANGLE_DM(t){let e=null!==t.MINUS(),n=this.contextStack.pop(),i=this.contextStack.pop();this.contextStack.push(new pa(i,n,0,e))}exitEXPR_ANGLE_DMS(t){let e=null!==t.MINUS(),n=this.contextStack.pop(),i=this.contextStack.pop(),s=this.contextStack.pop();this.contextStack.push(new pa(s,i,n,e))}exitEXPR_ANGLE_TRUE(t){let e=this.contextStack.pop(),n=0;if(e instanceof da)n=e.value;else{if(!(e instanceof pa))throw new this.SyntaxError(t,"Angle is unexpected type");n=e.degrees}this.contextStack.push(new ga(new da(n),!1))}exitEXPR_ANGLE_MAGNETIC(t){let e=this.contextStack.pop(),n=0;if(e instanceof da)n=e.value;else{if(!(e instanceof pa))throw new this.SyntaxError(t,"Angle is unexpected type");n=e.degrees}let i=this.definitionsList.lookup("MagneticVariation"),s=0;if(i.value instanceof da)s=i.value.value;else{if(!(i.value instanceof pa))throw new this.SyntaxError(t,"Magvar is unexpected type");s=i.value.degrees}n+=s,this.contextStack.push(new ga(new da(n),!1))}exitDistanceUnit(t){let e=null!==t.NAUTICAL_MILES(),n=null!==t.YARDS(),i=null!==t.FEET(),s=null!==t.METERS(),r=null!==t.KILOMETERS();e?this.contextStack.push(new Sa("nauticalMiles")):n?this.contextStack.push(new Sa("yards")):i?this.contextStack.push(new Sa("feet")):s?this.contextStack.push(new Sa("meters")):r&&this.contextStack.push(new Sa("kilometers"))}exitEXPR_DISTANCE(t){let e=this.contextStack.pop(),n=(i=this.contextStack.pop().value,s=e.unitName,i*{statuteMiles:1609.344,nauticalMiles:1852,meters:1,kilometers:1e3,yards:.3048*3,feet:.3048}[s]);var i,s;this.contextStack.push(new Ea(new da(n),e))}exitEXPR_LONGITUDE(t){let e,n=this.contextStack.pop(),i=null!==t.EAST();if("MDLNumber"===n.type)e=new fa((i?1:-1)*n.value);else{if("MDLAngle"!==n.type)throw"bad type for longitude";e=new fa((i?1:-1)*n.degrees)}this.contextStack.push(e)}exitEXPR_LATITUDE(t){let e,n=this.contextStack.pop(),i=null!==t.NORTH();if("MDLNumber"===n.type)e=new ma((i?1:-1)*n.value);else{if("MDLAngle"!==n.type)throw"bad type for latitude";e=new ma((i?1:-1)*n.degrees)}this.contextStack.push(e)}exitEXPR_UNARY_MINUS(t){let e=this.contextStack.pop();if(e instanceof da)e.value*=-1;else if(e instanceof pa)e.degrees*=-1;else if(e instanceof ga)e.degrees*=-1;else if(e instanceof Ea)e.value*=-1;else if(e instanceof fa)e.longitude*=-1;else if(e instanceof ma)e.latitude*=-1;else{if(!(e instanceof xa))throw new this.SyntaxError(t,`uniary minus only operates on numbers, angles, and distances, not ${e.type}`);e.longitude*=-1,e.latitude*=-1}this.contextStack.push(e)}extractValue(t){if("MDLNumber"===t.type)return t.value;if("MDLAngle"===t.type)return t.degrees;if("MDLAzimuth"===t.type)return t.degrees;if("MDLDistance"===t.type)return t.distanceInMeters;if("MDLLongitude"===t.type)return t.longitude;if("MDLLatitude"===t.type)return t.latitude;if("MDLLocation"===t.type)return[t.longitude,t.latitude];throw"unhandled type {$v.type} for extractValue"}factory(t,e){return"MDLNumber"===t?new da(e):"MDLAngle"===t?new pa(e):"MDLAzimuth"===t?new ga(e,!1):"MDLDistance"===t?new Ea(e,new Sa("meters")):"MDLLongitude"===t?new fa(e):"MDLLatitude"===t?new ma(e):"MDLLocation"===t?new xa(e[0],e[1]):"MDLOffset"===t?new Ta(e[0],e[1]):void 0}apply(t,e,n,i,s){let r=[t.type,e.type].sort().toString();if(r in i){let s=n(this.extractValue(t),this.extractValue(e));return this.factory(i[r],s)}throw`Cannot perform ${s} for ${t.type}, ${e.type}`}exitEXPR_SIMPLE_LOCATION(t){let e,n,i=this.contextStack.pop(),s=this.contextStack.pop(),r=[s.type,i.type].sort().toString();if(["MDLAngle,MDLAngle","MDLNumber,MDLNumber","MDLAngle,MDLNumber"].includes(r))e=this.extractValue(s),n=this.extractValue(i);else if("MDLLatitude"===s.type&&["MDLNumber","MDLAngle","MDLLongitude"].includes(i.type))n=this.extractValue(i),e=this.extractValue(s);else{if("MDLLongitude"!==s.type||!["MDLNumber","MDLAngle","MDLLatitude"].includes(i.type))throw`Cannot make location from ${s.type} ${i.type}`;n=this.extractValue(s),e=this.extractValue(i)}let o=new xa(new fa(n),new ma(e));this.contextStack.push(o)}exitEXPR_OFFSET(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if(!["MDLDistance","MDLNumber"].includes(i.type)||!["MDLAzimuth","MDLAngle","MDLNumber"].includes(n.type))throw`Cannot make offset from ${i.type} @ ${n.type}`;{let t=this.extractValue(i),s=new Sa("MDLDistance"===i.type?i.displayUnitName:"meters"),r=this.extractValue(n),o="MDLAzimuth"===n.type&&n.isMagnetic;e=new Ta(new Ea(t,s),new ga(r,o))}this.contextStack.push(e)}exitEXPR_RELATIVE_LOCATION(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if("MDLLocation"!==i.type||"MDLOffset"!==n.type)throw`Not applicable for ${i.type}, ${n.type}`;{let t=function(t,e,n,i,s){void 0===i&&(i=1e-6),void 0===s&&(s=10);let r={start:{longitude:t.longitude,latitude:t.latitude},distanceInMeters:e,azimuthForwardInTrueDegrees:n,tol:i,maxSteps:s},o=Math.cos(n*Math.PI/180),a=Math.atan((1-Ur)*Math.tan(t.latitude*Math.PI/180)),l=Math.atan2(Math.tan(a),o),h=Math.asin(Math.cos(a)*Math.sin(n*Math.PI/180)),u=272331606107.5547*(1-Math.sin(h)*Math.sin(h))/zr/zr,c=1+u/16384*(4096+u*(u*(320-175*u)-768)),d=u/1024*(256+u*(u*(74-47*u)-128));var p=e/zr/c,g=p,f=0,m=2*i;for(let t=0;t<s;t++){f=Math.cos(2*l+p);let t=Math.sin(p),n=Math.cos(p);if(p=e/zr/c+d*t*(f+1/4*d*(n*(2*f*f-1)-1/6*d*f*(4*t*t-3)*(4*f*f-3))),(m=Math.abs(p-g))<=i)break;g=p}if(r.convergence=m,m>i)return r;let x=Math.atan2(Math.sin(a)*Math.cos(p)+Math.cos(a)*Math.sin(p)*o,(1-Ur)*Math.sqrt(Math.sin(h)*Math.sin(h)+Math.pow(Math.sin(a)*Math.sin(p)-Math.cos(a)*Math.cos(p)*o,2))),E=Math.atan2(Math.sin(p)*Math.sin(n*Math.PI/180),Math.cos(a)*Math.cos(p)-Math.sin(a)*Math.sin(p)*o),S=Math.cos(h)*Math.cos(h),T=Ur/16*S*(4+Ur*(4-3*S)),_=180*(E-(1-T)*Ur*Math.sin(h)*(p+T*Math.sin(p)*(f+T*Math.cos(p*(2*f*f-1)))))/Math.PI+t.longitude,v=Gr(180+180*Math.atan2(Math.sin(h),-1*Math.sin(a)*Math.sin(p)+Math.cos(a)*Math.cos(p)*o)/Math.PI,0,360);return r.stop={longitude:Gr(_,-180,180),latitude:Gr(180*x/Math.PI,-90,90)},r.azimuthBackwardInTrueDegrees=v,r}(i,n.distance.distanceInMeters,n.azimuth.degrees);e=new xa(new fa(t.stop.longitude),new ma(t.stop.latitude))}this.contextStack.push(e)}exitEXPR_REFERENCE(t){let e=t.NAME().getText(),n=this.definitionsList.lookup(e);this.contextStack.push(n.value)}exitEXPR_ADDITION(t){let e=this.contextStack.pop(),n=this.contextStack.pop(),i=this.apply(n,e,((t,e)=>t+e),{"MDLNumber,MDLNumber":"MDLNumber","MDLAngle,MDLAngle":"MDLAngle","MDLDistance,MDLDistance":"MDLDistance","MDLLongitude,MDLLongitude":"MDLLongitude","MDLLatitude,MDLLatitude":"MDLLatitude","MDLAngle,MDLNumber":"MDLAngle","MDLAngle,MDLAzimuth":"MDLAzimuth","MDLAzimuth,MDLNumber":"MDLAzimuth","MDLDistance,MDLNumber":"MDLDistance","MDLLongitude,MDLNumber":"MDLLongitude","MDLLatitude,MDLNumber":"MDLLatitude","MDLLongitude,MDLAngle":"MDLLongitude","MDLLatitude,MDLAngle":"MDLLatitude"},"+");this.contextStack.push(i)}exitEXPR_SUBTRACTION(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if("MDLLocation"===i.type&&"MDLLocation"===n.type){let t=Xr(n,i);e=new Ta(new Ea(t.distanceInMeters,new Sa("meters")),new ga(t.azimuthForwardInTrueDegrees,!1))}else{let t={"MDLNumber,MDLNumber":"MDLNumber","MDLAngle,MDLAngle":"MDLAngle","MDLAzimuth,MDLAzimuth":"MDLAngle","MDLDistance,MDLDistance":"MDLDistance","MDLLongitude,MDLLongitude":"MDLLongitude","MDLLatitude,MDLLatitude":"MDLLatitude","MDLAngle,MDLNumber":"MDLAngle","MDLAngle,MDLAzimuth":"MDLAzimuth","MDLAzimuth,MDLNumber":"MDLAzimuth","MDLDistance,MDLNumber":"MDLDistance","MDLLongitude,MDLNumber":"MDLLongitude","MDLLatitude,MDLNumber":"MDLLatitude","MDLLongitude,MDLAngle":"MDLLongitude","MDLLatitude,MDLAngle":"MDLLatitude"};e=this.apply(i,n,((t,e)=>t-e),t,"-")}this.contextStack.push(e)}exitEXPR_MULTIPLICATION(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if("MDLOffset"===i.type&&"MDLNumber"===n.type)e=new Ta(new Ea(i.distanceInMeters*n.value,new Sa("meters")),new ga(i.azimuth,i.isMagnetic));else if("MDLOffset"===n.type&&"MDLNumber"===i.type)e=new Ta(new Ea(n.distanceInMeters*i.value,"meters"),new ga(n.azimuth,n.isMagnetic));else{let t={"MDLNumber,MDLNumber":"MDLNumber","MDLAngle,MDLNumber":"MDLAngle","MDLAzimuth,MDLNumber":"MDLAzimuth","MDLDistance,MDLNumber":"MDLDistance","MDLLongitude,MDLNumber":"MDLLongitude","MDLLatitude,MDLNumber":"MDLLatitude"};e=this.apply(i,n,((t,e)=>t*e),t,"*")}this.contextStack.push(e)}exitEXPR_DIVISION(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if("MDLOffset"===i.type&&"MDLNumber"===n.type)e=new Ta(new Ea(i.distanceInMeters/n.value,new Sa("meters")),new ga(i.azimuth,i.isMagnetic));else if("MDLOffset"===n.type&&"MDLNumber"===i.type)e=new Ta(new Ea(n.distanceInMeters/i.value,new Sa("meters")),new ga(n.azimuth,n.isMagnetic));else{let t={"MDLNumber,MDLNumber":"MDLNumber","MDLAngle,MDLNumber":"MDLAngle","MDLAzimuth,MDLNumber":"MDLAzimuth","MDLDistance,MDLNumber":"MDLDistance","MDLLongitude,MDLNumber":"MDLLongitude","MDLLatitude,MDLNumber":"MDLLatitude"};e=this.apply(i,n,((t,e)=>t/e),t,"/")}this.contextStack.push(e)}exitEXPR_POWER(t){let e,n=this.contextStack.pop(),i=this.contextStack.pop();if("MDLNumber"!==n.type)throw`Not applicable for ${i.type}, ${n.type}`;if("MDLOffset"===i.type&&"MDLNumber"===n.type)e=new Ta(new Ea(i.distanceInMeters**n.value,new Sa("meters")),new ga(i.azimuth,i.isMagnetic));else{let t={"MDLNumber,MDLNumber":"MDLNumber","MDLAngle,MDLNumber":"MDLAngle","MDLAzimuth,MDLNumber":"MDLAzimuth","MDLDistance,MDLNumber":"MDLDistance","MDLLongitude,MDLNumber":"MDLLongitude","MDLLatitude,MDLNumber":"MDLLatitude"};e=this.apply(i,n,((t,e)=>t**e),t,"^")}this.contextStack.push(e)}exitValueDefinition(t){let e=new ca(t.NAME().getText()),n=this.contextStack.pop(),i=new Ca(e,n);this.contextStack.push(i)}exitEXPR_COURSE_ROUNDING(t){let e=this.contextStack.pop();if("MDLRounding"!==e.type)throw`expected MDLRounding, received ${e.type}`;this.contextStack.push(e)}exitRounding(t){let e=this.contextStack.pop(),n=new ca(t.NAME().getText()),i=new va(n,e);this.contextStack.push(i)}exitRoundingDirection(t){if(null!==t.START())this.contextStack.push(new Aa("start"));else if(null!==t.FINISH())this.contextStack.push(new Aa("finish"));else if(null!==t.STARBOARD())this.contextStack.push(new Aa("starboard"));else if(null!==t.PORT())this.contextStack.push(new Aa("port"));else{if(null===t.GATE())throw"unexpected roundingDirection";this.contextStack.push(new Aa("gate"))}}enterRoundingList(t){this.contextStack.push(new _a)}exitRoundingList(t){let e=[];for(;;){let t=this.contextStack.pop();if("MDLRounding"!==t.type){if("MDLRoundingList"===t.type){t.appendRoundings(e),this.contextStack.push(t);break}throw`unexpected type ${t.type} while building rounding list`}e.push(t)}}exitEXPR_FUNCTION_EVAL(t){let e=t.NAME().getText();if(!(e in ha))throw`unknown function ${e}`;{let n=Math.floor((t.children.length-2)/2),i=[];for(let t=0;t<n;t++)i.unshift(this.contextStack.pop());let s=ha[e].apply(void 0,[t,this.definitionsList,i]);this.contextStack.push(s)}}exitCourseDefinition(t){let e=this.contextStack.pop(),n=t.NAME().getText(),i=new Na(new ca(n),e),s=new Ca(new ca(n),i);this.contextStack.push(s)}}function La(t,e){let n=(new Date).getTime();const i=new oo.InputStream(t),s=new uo(i),r=new oo.CommonTokenStream(s),o=new xo(r);let a=(new Date).getTime();o.buildParseTrees=!0;const l=o.file();let h=(new Date).getTime(),u=new ua(e);const c=new Ma(u);oo.tree.ParseTreeWalker.DEFAULT.walk(c,l);let d=(new Date).getTime();return{definitions:u,tree:l,"t1-t0":(a-n)/1e3,"t2-t1":(h-a)/1e3,"t3-t2":(d-h)/1e3,"t3-t0":(d-n)/1e3}}function wa(t){return void 0===t&&(t=new Date),t instanceof Date&&(t=t.getTime()),(t-new Date(Date.UTC(2e3,0,1,11,58,55,816)).getTime())/1e3/60/60/24}class Ra{constructor(t,e,n){void 0===t&&(t=null),this.dispatcher=t,this.observer=e,this.clock=n,null!==t&&(this.dispatcher.addHandler("Clock","AstroCoordinateConverter",this.updateClock.bind(this)),this.dispatcher.addHandler("Observer","AstroCoordinateConverter",this.updateObserver.bind(this)))}updateObserver(t){return void 0!==t&&(this.observer=t),this.observer}updateClock(t){return void 0!==t&&(this.clock=t),this.clock}epoch1990DayNumber(t){void 0===t&&(t=new Date);const e=new Date(Date.UTC(1989,12,31,0,0,0));return(t.getTime()-e.getTime())/1e3/60/60/24}earthRotationAngle(t){return(.779057273264+1.0027378119113546*wa(t))%1*360}localSiderealAngle(t,e){return this.earthRotationAngle(t)+e}RADecToAzimuthElevation(t,e,n){let i=Math.PI/180,s=180/Math.PI;void 0===n&&(n=new Date(this.clock.time));var r=this.observer.latestPosition;if(void 0===r||void 0===r.longitude||void 0===r.latitude)return[NaN,NaN];var o=this.localSiderealAngle(n,r.longitude)-t,a=Math.sin(e*i)*Math.sin(r.latitude*i)+Math.cos(e*i)*Math.cos(r.latitude*i)*Math.cos(o*i),l=Math.asin(a)*s,h=Math.acos((Math.sin(e*i)-Math.sin(r.latitude*i)*Math.sin(l*i))/(Math.cos(r.latitude*i)*Math.cos(l*i)))*s;return Math.sin(o*i)>0&&(h=360-h),{azimuth:h,elevation:l}}}class ka{constructor(t,e,n,i,s){this.width=600,this.height=600,this.margin=20,this.stars=void 0,this.now=void 0,this.directionElevation=-3,this.maxMagnitude=4,this.sizeMagnitudeZero=5,this.divId=t,void 0===e&&(e=null),this.dispatcher=e,this.converter=n,this.observer=i,this.mark=void 0,this.markAzimuth=0,this.clock=s,er(`#${t}`).append("svg").attr("class","AstroChart").attr("width",this.width).attr("height",this.height),er(`#${t}`).select("svg").append("g").attr("class","AstroChart").attr("width",this.width).attr("height",this.height),null!==e&&(e.addHandler("Clock","AstroChart",this.updateTime.bind(this)),e.addHandler("Observer","AstroChart",this.updateObserver.bind(this)),e.addHandler("Mark","AstroChart",this.updateMark.bind(this))),this.projection=new Ia(this.width,this.height,this.margin),Pn("static/stars.csv").then(this.setStars.bind(this))}updateTime(t){(void 0===this.now||t.time-this.now>6e4)&&(this.now=t.time,this.drawAll())}updateObserver(t){this.observer=t,this.updateAzimuth(),void 0===this.starsDrawn&&this.drawAll()}updateMark(t){void 0!==t&&null!=t&&(this.mark=t,this.updateAzimuth())}updateAzimuth(){if(void 0!==this.observer&&void 0!==this.mark){let t=Xr(this.observer.latestPosition,this.mark.location);(void 0===this.markAzimuth||Math.abs(t.azimuthForwardInTrueDegrees-this.markAzimuth)>1)&&(this.markAzimuth=t.azimuthForwardInTrueDegrees,this.rotate(this.markAzimuth))}}setStars(t){this.stars=t,this.drawAll()}drawAll(){this.drawBackground(),this.drawDirections(),this.drawGrid(),this.drawStars()}drawBackground(){let t=[{center:this.projection.center(),r:this.projection.radius(0),fill:"#444",stroke:"none"}],e=`#${this.divId} svg g`;er(e).selectAll("circle.astroChartBackground").remove(),er(e).selectAll("circle.astroChartBackground").data(t).enter().append("circle").attr("class","astroChartBackground").attr("cx",(t=>t.center[0])).attr("cy",(t=>t.center[1])).attr("r",(t=>t.r)).attr("fill",(t=>t.fill)).attr("stroke",(t=>t.stroke))}drawDirections(){let t=[{name:"N",azimuthElevationPair:[0,this.directionElevation]},{name:"NE",azimuthElevationPair:[45,this.directionElevation]},{name:"E",azimuthElevationPair:[90,this.directionElevation]},{name:"SE",azimuthElevationPair:[135,this.directionElevation]},{name:"S",azimuthElevationPair:[180,this.directionElevation]},{name:"SW",azimuthElevationPair:[225,this.directionElevation]},{name:"W",azimuthElevationPair:[270,this.directionElevation]},{name:"NW",azimuthElevationPair:[315,this.directionElevation]}].map((t=>{let e={...t},n=this.projection.forward(t.azimuthElevationPair);return e.x=n[0],e.y=n[1],e})),e=`#${this.divId} svg g`;er(e).selectAll("text.direction").remove(),er(e).selectAll("text.direction").data(t).enter().append("text").attr("class","direction").attr("text-anchor","middle").attr("transform",(t=>`translate(${t.x}, ${t.y}) rotate(${-1*t.azimuthElevationPair[0]})`)).attr("x",0).attr("y",0).text((t=>t.name))}drawGrid(){let t=`#${this.divId} svg g`,e=[0,15,30,45,60,75].map((t=>({elevation:t,r:this.projection.radius(t),center:this.projection.center()})));er(t).selectAll("circle.gridAE").remove(),er(t).selectAll("circle.gridAE").data(e).enter().append("circle").attr("class","gridAE").attr("cx",(t=>t.center[0])).attr("cy",(t=>t.center[1])).attr("r",(t=>t.r));let n=[0,45,90,135,180,225,270,315].map((t=>({azimuth:t,zenith:this.projection.forward([t,90]),ground:this.projection.forward([t,0])})));er(t).selectAll("path.gridAE").remove(),er(t).selectAll("path.gridAE").data(n).enter().append("path").attr("class","gridAE").attr("d",(t=>`M ${t.zenith[0]} ${t.zenith[1]} L ${t.ground[0]} ${t.ground[1]}`))}drawStars(){if(void 0===this.stars)return;let t=`#${this.divId} svg g`;console.log(`selecting ${t}`);let e=this.stars.filter((t=>t.Vmag<=this.maxMagnitude)).map((t=>{let e={...t},n=this.converter.RADecToAzimuthElevation(t.RAdeg,t.DEdeg,this.now);return e.azimuth=n.azimuth,e.elevation=n.elevation,e}));this.starsWithAE=e;let n=e.filter((t=>t.elevation>0));n.length<200&&console.log("somehow filtered out far too many stars???"),this.upStarsWithAE=n;let i=n.map((t=>{let e=this.projection.forward([t.azimuth,t.elevation]);return t.x=e[0],t.y=e[1],t}));this.latestStars=i,er(t).selectAll("circle.star").remove(),er(t).selectAll("circle.star").data(i).enter().append("circle").attr("class","star").attr("r",(t=>this.sizeMagnitudeZero-t.Vmag)).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),this.starsDrawn=!0}rotate(t){void 0===t||Number.isNaN(t)?console.log("tried to rotate astro chart to NaN"):er(`#${this.divId} svg g`).attr("transform",`translate(${this.width/2}, ${this.height/2}) rotate(${t}) translate(${this.width/2*-1}, ${this.height/2*-1}) `)}}class Ia{constructor(t,e,n){this.resize(t,e,n),this.orientation(0)}resize(t,e,n){this.width=t,this.height=e,this.margin=n,this.r=t/2-n,this.r<this.height/2-n&&(this.r=this.height/2-n),this.cx=this.width/2,this.cy=this.height/2}orientation(t){this.bottomAzimuth=t}forward(t){let e=t[0]-this.bottomAzimuth,n=this.radius(t[1]);return[this.cx+n*Math.sin(e/180*Math.PI),this.cy+n*Math.cos(e/180*Math.PI)]}center(){return[this.cx,this.cy]}radius(t){return(90-t)/90*this.r}}class Da{constructor(t,e,n){void 0===t&&(t=null),this.dispatcher=t,null!==this.dispatcher&&(this.dispatcher.addHandler("SettingsModel","Course",this.onSettingsChange.bind(this)),this.dispatcher.addHandler("Definitions","Course",this.onDefinitionsChange.bind(this))),this.definitions=e,this.name=n,this.description=void 0,this.latestSettings=void 0,this.magvar=void 0,this.calculatedDistanceInMeters=void 0,this.nominalDistanceNmi=void 0,this.radioChannel=void 0,this.roundings=[],this.internalPrepCourseFromName(this.name)}internalClear(){this.description=void 0,this.latestSettings=void 0,this.magvar=void 0,this.nominalDistanceNmi=void 0,this.radioChannel=void 0,this.roundings=[]}internalPrepCourseFromName(t){if(void 0!==t&&(this.name=t),void 0===this.definitions||void 0===this.name)return void this.internalClear();if(""===this.name)return;if(!this.definitions.hasCourseName(this.name))return void this.internalClear();this.magvar=this.definitions.lookup("MagneticVariation").value.value;let e=this.definitions.lookup(this.name);this.description=e.description;let n=e.value.roundings.roundings;this.roundings=n.map(((t,e)=>{let i=t.name.name;if(!this.definitions.hasLocationName(i))throw`Unknown mark name ${i} for course ${this.name}`;let s,r=this.definitions.lookup(i);if(e+1<n.length){let t=n[e+1].name.name;if(!this.definitions.hasLocationName(t))throw`Unknown mark name ${t} for course ${this.name}`;let i=this.definitions.lookup(t);s=Xr(r.value,i.value)}let o={num:e,direction:t.direction.direction,name:i,option:`${e}: ${i}`,longitude:r.value.longitude,latitude:r.value.latitude,description:r.description};return void 0!==s&&(o.distanceInMeters=s.distanceInMeters,o.distanceInNmi=s.distanceInMeters/1852,o.azimuthForwardInTrueDegrees=s.azimuthForwardInTrueDegrees,o.azimuthForwardInMagneticDegrees=Gr(s.azimuthForwardInTrueDegrees-this.magvar,0,360),o.nextMarkAzimuthBackwardInTrueDegrees=s.azimuthBackwardInTrueDegrees),o})),this.calculatedDistanceInMeters=this.roundings[0].distanceInMeters;for(let t=1;t<this.roundings.length-1;t++){let e=Gr(this.roundings[t-1].nextMarkAzimuthBackwardInTrueDegrees,0,360),n=this.roundings[t].azimuthForwardInTrueDegrees,i=Gr(n-e,-180,180),s=this.roundings[t].direction;this.roundings[t].fromAzimuth=e,this.roundings[t].toAzimuth=n,this.roundings[t].halfAzimuth=Gr(e+i/2+180,0,360),this.roundings[t].turn=Vr(e,n,s),this.calculatedDistanceInMeters+=this.roundings[t].distanceInMeters}}onSettingsChange(t){let e=t.diff(this.latestSettings);this.latestSettings=t.settings,(void 0===this.name||e.includes("courseSelect"))&&(this.name=t.latestSettings.courseSelect,this.internalPrepCourseFromName(this.name),this.notify())}onDefinitionsChange(t){this.definitions=t,this.definitions.hasCourseName(this.name)?this.internalPrepCourseFromName(this.name):this.internalClear(),this.notify()}rounding(t){return t<this.roundings.length?this.roundings[t]:{}}firstMarkName(){return this.roundings.length>1?this.roundings[0].name:void 0}options(){return this.roundings.length>1?this.roundings.map((t=>t.option)):void 0!==this.definitions?this.definitions.getDefinitionNames("MDLLocation"):[]}length(){return this.roundings.length}boundingBox(){let t;this.roundings.length>1&&(t=[[this.roundings[0].longitude,this.roundings[0].latitude],[this.roundings[0].longitude,this.roundings[0].latitude]]);for(let e=1;e<this.roundings.length;e++)this.roundings[e].longitude<t[0][0]&&(t[0][0]=this.roundings[e].longitude),this.roundings[e].latitude<t[0][1]&&(t[0][1]=this.roundings[e].latitude),this.roundings[e].longitude>t[1][0]&&(t[1][0]=this.roundings[e].longitude),this.roundings[e].latitude>t[1][1]&&(t[1][1]=this.roundings[e].latitude);return t}center(){let t;if(this.roundings.length>1){let e=this.boundingBox();t=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}return t}notify(){null!==this.dispatcher&&this.dispatcher.notify("Course",this)}}class ba{constructor(t){void 0===t&&(t=null),this.dispatcher=t,null!==this.dispatcher&&(this.dispatcher.addHandler("Course","CourseTable",this.onCourseChange.bind(this)),this.dispatcher.addHandler("SettingsModel","CourseTable",this.onSettingsChange.bind(this))),this.div=er("#courseTableDiv"),this.course=void 0,this.latestSettings=void 0}onCourseChange(t){this.course=t,this.draw()}onSettingsChange(t){let e=t.diff(this.latestSettings);this.latestSettings=t.settings,(e.includes("azimuthUnits")||e.includes("distanceUnits"))&&this.draw()}draw(){if(this.div.selectAll("p.courseTableSummary").remove(),this.div.selectAll("p.courseTableDescription").remove(),this.div.select("table").remove(),void 0!==this.course&&null!==this.course&&void 0!==this.course.name&&null!==this.course.name&&""!==this.course.name&&this.course.length()>0&&void 0!==this.latestSettings){let t=Pr(120,240,this.course.length()),e=this.div.append("p");e.attr("class","courseTableSummary");let n="Course: "+this.course.name+", calculated distance: "+br(this.course.calculatedDistanceInMeters,this.latestSettings.distanceUnits);if(e.text(n),void 0!==this.course.description&&null!==this.course.description&&""!==this.course.description){let t=this.div.append("p");t.attr("class","courseTableDescription"),t.text(this.course.description)}let i=this.div.append("table");i.attr("class","courseTable"),i.append("thead").append("tr").selectAll("td").data(["Num","Mark","Direction","Description","To Next Mark"]).enter().append("th").attr("class","courseTableHeader").text((t=>t)),i.append("tbody").selectAll("tr.courseRounding").data(this.course.roundings).enter().append(((e,n,i)=>{let s=document.createElement("tr");s.setAttribute("class","courseRounding");let r=[];for(let e=0;e<5;e++)r.push(document.createElement("td")),r[e].setAttribute("style",`outline-color: hsl(${t[n]}, 100%, 50%)`);r[0].textContent=n.toString(),r[0].setAttribute("class","courseRoundingNumber"),r[1].textContent=e.name,r[1].setAttribute("class","courseRoundingMarkName"),r[2].textContent=e.direction,r[2].setAttribute("class","courseRoundingDirection"),void 0!==e.description&&(r[3].textContent=e.description.replace(/! */,""),r[3].setAttribute("class","courseRoundingMarkDirection"));let o="           ";void 0!==e.turn&&(o=`turn ${Lr(e.turn,4,0)}° `),void 0!==e.azimuthForwardInTrueDegrees&&(o+=Or(e,this.latestSettings.azimuthUnits),o+=", ",o+=br(e.distanceInMeters,this.latestSettings.distanceUnits)),r[4].textContent=o,r[4].setAttribute("class","courseRoundingToNextMark");for(let t=0;t<5;t++)s.appendChild(r[t]);return s}))}}onCourseChange(t){this.course=t,this.draw()}}const Oa={Mercury:{value:{a:.38709927,e:.20563593,I:7.00497902,L:252.2503235,pi:77.45779628,Omega:48.33076593,Period_days:87.969257,JD_of_perihelion:2459506.203011958},rate_per_century:{a:37e-8,e:1906e-8,I:-.00594749,L:149472.67411175,pi:.16047689,Omega:-.12534081}},Venus:{value:{a:.72333566,e:.00677672,I:3.39467605,L:181.9790995,pi:131.60246718,Omega:76.67984255,Period_days:224.70079922,JD_of_perihelion:2459463.376383431},rate_per_century:{a:39e-7,e:-4107e-8,I:-7889e-7,L:58517.81538729,pi:.00268329,Omega:-.27769418}},"EM Bary":{value:{a:1.00000261,e:.01671123,I:-1531e-8,L:100.46457166,pi:102.93768193,Omega:0,Period_days:365.25636,JD_of_perihelion:2459550.384186967},rate_per_century:{a:562e-8,e:-4392e-8,I:-.01294668,L:35999.37244981,pi:.32327364,Omega:0}},Mars:{value:{a:1.52371034,e:.0933941,I:1.84969142,L:-4.55343205,pi:-23.94362959,Omega:49.55953891,Period_days:686.98,JD_of_perihelion:2459749.073792195},rate_per_century:{a:1847e-8,e:7882e-8,I:-.00813131,L:19140.30268499,pi:.44441088,Omega:-.29257343}},Jupiter:{value:{a:5.202887,e:.04838624,I:1.30439695,L:34.39644051,pi:14.72847983,Omega:100.47390909,Period_days:4332.589,JD_of_perihelion:2459978.095317125},rate_per_century:{a:-11607e-8,e:-13253e-8,I:-.00183714,L:3034.74612775,pi:.21252668,Omega:.20469106}},Saturn:{value:{a:9.53667594,e:.05386179,I:2.48599187,L:49.95424423,pi:92.59887831,Omega:113.66242448,Period_days:10755.698,JD_of_perihelion:2463558.540466904},rate_per_century:{a:-.0012506,e:-50991e-8,I:.00193609,L:1222.49362201,pi:-.41897216,Omega:-.28867794}},Uranus:{value:{a:19.18916464,e:.04725744,I:.77263783,L:313.23810451,pi:170.9542763,Omega:74.01692503,Period_days:30685.4,JD_of_perihelion:2470109.143172772},rate_per_century:{a:-.00196176,e:-4397e-8,I:-.00242939,L:428.48202785,pi:.40805281,Omega:.04240589}},Neptune:{value:{a:30.06992276,e:.00859048,I:1.77004347,L:-55.12002969,pi:44.96476227,Omega:131.78422574,Period_days:60189,JD_of_perihelion:2468452.211759133},rate_per_century:{a:26291e-8,e:5105e-8,I:35372e-8,L:218.45945325,pi:-.32241464,Omega:-.00508664}}},Pa=new Date("2000-01-01 12:00:00Z").getTime();function Fa(t){return void 0===t&&(t=new Date),(t.getTime()-Pa)/1e3/60/60/24/365.25/100}function Ua(t,e,n){void 0===n&&(n=new Date);let i=Fa(n),s=Oa[t].value[e];return Oa[t].rate_per_century.includes(e)&&(s+=Oa[t].rate_per_century[e]*i),s}function za(t){return Math.cos(t*Math.PI/180)}function Ba(t){return Math.sin(t*Math.PI/180)}function Ha(t,e){let n=180/Math.PI*e,i=t-n*Ba(t),s=1,r=1;for(;Math.abs(s)>1e-6;){if(s=(t-(i-n*Ba(i)))/(1-n*za(i)),i+=s,r>100)throw`solveKepler(${t}, ${e}) failed after ${r} iterations`;r+=1}return i}class Ga{constructor(t,e){this.name=t,this.ephemAsof=e,void 0===this.ephemAsof&&(this.ephemAsof=new Date),this.a=Ua(t,"a",this.asof),this.e=Ua(t,"e",this.asof),this.I=Ua(t,"I",this.asof),this.L=Ua(t,"L",this.asof),this.pi=Ua(t,"pi",this.asof),this.Omega=Ua(t,"Omega",this.asof),this.Period_days=Ua(t,"Period_days",this.asof),this.JD_of_perihelion=Ua(t,"JD_of_perihelion",this.asof)}computeEq(t){void 0===t&&(t=new Date);let e=Fa(t),n=this.pi-this.Omega;var i;void 0===(i=t)&&(i=new Date),wa(i),this.JD_of_perihelion,this.Period_days;let s=this.L-this.pi;s%=180;let r=Ha(s,this.e),o=this.a*(za(r)-this.e),a=this.a*Math.sqrt(1-this.e**2)*Ba(r),l=(za(n)*za(this.Omega)-Ba(n)*Ba(this.Omega)*za(this.I))*o+(-1*Ba(n)*za(this.Omega)-za(n)*Ba(this.Omega)*za(this.I))*a,h=(za(n)*za(this.Omega)+Ba(n)*za(this.Omega)*za(this.I))*o+(-1*Ba(n)*Ba(this.Omega)-za(n)*za(this.Omega)*za(this.I))*a,u=Ba(n)*Ba(this.I)*o+za(n)*Ba(this.I)*a,c=23.43928,d=l,p=za(c)*h-Ba(c)*u,g=Ba(c)*h+za(c)*u;return{name:this.name,asof:t,T:e,xecl:l,yecl:h,zecl:u,xeq:d,yeq:p,zeq:g}}}const Va=new Date("2023-10-01T01:02:03").getTime();if((new Date).getTime()<Va)window.globals={main:new class{constructor(){this.dispatcher=new xr,this.clock=new Er(this.dispatcher),this.sun=new Sr(this.dispatcher),this.simulation=new _r(this.dispatcher),this.simulation.loadCourses(),this.magneticModel=new vr(this.dispatcher),this.mark=new Ar(this.dispatcher),this.gps=new Fr(this.dispatcher),this.observer=new jr(this.dispatcher),this.chart=new qr(this.dispatcher),this.settingsVC=new io(this.dispatcher),this.settingsModel=new so(this.dispatcher),this.pointPairCalculator=new ro(this.dispatcher),this.astroCoordinateConverter=new Ra(this.dispatcher,this.observer,this.clock),this.parseMDLText=La,this.definitions=void 0,this.latestSettings=this.settingsVC.getSettings(),this.latestMagvar=0,this.courseConstructor=Da,this.course=new Da(this.dispatcher),this.courseTable=new ba(this.dispatcher),this.astroChart=new ka("astroChartDiv",this.dispatcher,this.astroCoordinateConverter,this.observer,this.clock),this.Planet=Ga,this.solveKepler=Ha,this.legalIAgree=!1,this.dispatcher.addHandler("Clock","Main",this.updateClock.bind(this)),this.dispatcher.addHandler("Sun","Main",this.updateSun.bind(this)),this.dispatcher.addHandler("Magvar","Main",this.updateMagvar.bind(this)),this.dispatcher.addHandler("Observer","Main",this.updateObserver.bind(this)),this.dispatcher.addHandler("SettingsModel","Main",this.updateSettings.bind(this)),this.dispatcher.addHandler("SettingsModelButton","Main",this.onSettingsButton.bind(this)),this.dispatcher.addHandler("Mark","Main",this.updateMark.bind(this)),this.dispatcher.addHandler("PointPairCalculator","Main",this.updatePointPairCalculator.bind(this)),this.dispatcher.addHandler("Definitions","Main",this.onDefinitionsChange.bind(this)),this.dispatcher.addHandler("Course","Main",this.onCourseChange.bind(this)),window.onresize=this.onWindowResize.bind(this)}updateSun(t){let e=t.solarLocation();Cr(document,{sunElevation:Number(e.elevation).toFixed(0),sunAzimuth:Number(e.azimuth).toFixed(0)})}updateClock(t){t.time}updateMagvar(t){this.latestMagvar=t.magvar,Cr(document,{magvar:Mr(t.magvar)})}updateObserver(t){let e={observerName:t.latestObserverName};if(t.latestStatusOK){let s=t.latestPosition;if(e.observerError="ok at "+wr(s.timestamp),e.observerLatitude=Dr(s.latitude,this.latestSettings.angleFormat,this.latestSettings.angleSign,"NS","fine"),e.observerLongitude=Dr(s.longitude,this.latestSettings.angleFormat,this.latestSettings.angleSign,"EW","fine"),Nr(s.providedHeading)){let t={azimuthForwardInTrueDegrees:s.providedHeading,azimuthForwardInMagneticDegrees:Gr(s.providedHeadingMagnetic,0,360,!0)};e.providedHeading=Or(t,this.latestSettings.azimuthUnits)}Nr(s.providedSpeed)?e.providedSpeed=(n=s.providedSpeed,void 0===(i=this.latestSettings.distanceUnits)&&(i="nauticalMiles"),function(t,e){return void 0===e&&(e="nauticalMiles"),Mr(t*{"m/s":1,"km/h":3.6,knots:3600/1852,mph:1097.28/5280}[e],0,1)+" "+e}(n,{nauticalMiles:"knots",meters:"m/s",kilometers:"km/h",statuteMiles:"statute miles / hour",feet:"statute miles / hour",yards:"statute miles / hour"}[i])):e.providedSpeed="?"}else e.observerError=t.latestObserverError,e.observerLatitude="",e.observerLongitude="";var n,i;Cr(document,e)}updateCourse(t){}updateMark(t){let e=this.mark.location;if(null===e.longitude||null===e.latitude||void 0===e.longitude||void 0===e.latitude||Number.isNaN(e.longitude)||Number.isNaN(e.latitude)){let e={markName:t.name,markDescription:t.description,markLongitude:"<undefined>",markLatitude:"<undefined>"};Cr(document,e)}else{let n={markName:t.name,markDescription:t.description,markLongitude:Dr(e.longitude,this.latestSettings.angleFormat,this.latestSettings.angleSign,"EW","fine"),markLatitude:Dr(e.latitude,this.latestSettings.angleFormat,this.latestSettings.angleSign,"NS","fine")};Cr(document,n)}}updatePointPairCalculator(t){let e=this.settingsModel.settings,n=t.markFromObserver,i={};Nr(n.distanceInMeters)?i.distance=br(n.distanceInMeters,e.distanceUnits):i.distance="?";let s=["azimuthForwardRelativeToHeading","azimuthForwardRelativeToSunDegrees","azimuthForwardRelativeToShadowDegrees"],r={azimuthForwardRelativeToHeading:"SP",azimuthForwardRelativeToSunDegrees:"SP",azimuthForwardRelativeToShadowDegrees:"SP"};i.azimuthForward=Or(n,this.latestSettings.azimuthUnits);for(let t=0;t<s.length;t++)Nr(n[s[t]])?i[s[t]]=Dr(n[s[t]],e.angleFormat,e.angleSign,r[s[t]],"veryCoarse"):i[s[t]]="?";Cr(document,i)}onWindowResize(){this.chart.onWindowResize()}initialUpdates(){var t;this.settingsVC.init(),this.settingsModel.settingsVCUpdate(this.settingsVC),this.updateClock(this.clock),this.sun.poke(),this.magneticModel.poke(),this.chart.onWindowResize(),this.calculateMarkPositions(),this.mark.setFromName(this.settingsVC.settings.markSelect),this.dispatcher.notify("Course",this.course),er("#compileInfo").text(`Last built 2023-07-27T21:24:26. This "pre-alpha" software is time-limited, and this version will reach end of life ${t=Va,"number"==typeof t&&(t=new Date(t)),Mr(t.getFullYear(),4)+"-"+Mr(t.getMonth()+1,2)+"-"+Mr(t.getDate(),2)}.`)}start(){this.clock.resetAndStart(),"gps"==this.latestSettings.simulationOrGPS?(console.log(`starting gps because simulationOrGPS is ${this.latestSettings.simulationOrGPS}`),this.gps.start()):"simulation_20x"==this.latestSettings.simulationOrGPS?(console.log("starting simulation at 20x"),this.simulation.setSpeedup(20),this.simulation.runState(!0)):"simulation_1x"==this.latestSettings.simulationOrGPS?(console.log("starting simulation at 1x"),this.simulation.setSpeedup(1),this.simulation.runState(!0)):"stop"==this.latestSettings.simulationOrGPS&&(console.log("stopping"),this.simulation.runState(!1)),this.initialUpdates()}stop(){this.clock.stop(),this.simulation.runState(!1),this.gps.stop()}updateSettings(t){let e=t.settings,n=t.diff(this.latestSettings);this.latestSettings=e,n.includes("simulationOrGPS")&&(this.stop(),this.start())}toggleDisplay(t,e){document.getElementById(t).setAttribute("class","displayed"),document.getElementById(e).setAttribute("class","hidden")}onSettingsButton(t){"legalIAgree"==t.activeButton&&(this.legalIAgree=!0,this.toggleDisplay("collapsedLegal","expandedLegal")),this.legalIAgree&&("expandLegal"==t.activeButton&&this.toggleDisplay("expandedLegal","collapsedLegal"),"collapseLegal"==t.activeButton&&this.toggleDisplay("collapsedLegal","expandedLegal"),"expandSettings"==t.activeButton&&this.toggleDisplay("expandedSettings","collapsedSettings"),"collapseSettings"==t.activeButton&&this.toggleDisplay("collapsedSettings","expandedSettings"),"expandDebugSettings"==t.activeButton&&this.toggleDisplay("expandedDebugSettings","collapsedDebugSettings"),"collapseDebugSettings"==t.activeButton&&this.toggleDisplay("collapsedDebugSettings","expandedDebugSettings"),"expandChart"==t.activeButton&&this.toggleDisplay("expandedChart","collapsedChart"),"collapseChart"==t.activeButton&&this.toggleDisplay("collapsedChart","expandedChart"),"expandMarkInput"==t.activeButton&&this.toggleDisplay("expandedMarkInput","collapsedMarkInput"),"collapseMarkInput"==t.activeButton&&this.toggleDisplay("collapsedMarkInput","expandedMarkInput"),"expandCredits"==t.activeButton&&this.toggleDisplay("expandedCredits","collapsedCredits"),"collapseCredits"==t.activeButton&&this.toggleDisplay("collapsedCredits","expandedCredits"),"expandDocumentation"==t.activeButton&&this.toggleDisplay("expandedDocumentation","collapsedDocumentation"),"collapseDocumentation"==t.activeButton&&this.toggleDisplay("collapsedDocumentation","expandedDocumentation"),"expandCourseTable"==t.activeButton&&this.toggleDisplay("expandedCourseTable","collapsedCourseTable"),"collapseCourseTable"==t.activeButton&&this.toggleDisplay("collapsedCourseTable","expandedCourseTable"),"expandAstroChart"==t.activeButton&&this.toggleDisplay("expandedAstroChart","collapsedAstroChart"),"collapseAstroChart"==t.activeButton&&this.toggleDisplay("collapsedAstroChart","expandedAstroChart"),"download"==t.activeButton&&this.downloadObserverHistory(),"calculateMarkPositions"==t.activeButton&&this.calculateMarkPositions(),"clearMarkDefinitionsTable"==t.activeButton&&er("#MarkDefinitionsTable > tbody").selectAll("tr").remove(),"saveCurrentLocation"==t.activeButton&&this.saveCurrentLocation())}downloadObserverHistory(){let t=this.observer.history.dump();if(0==t.length)return;let e=("number"==typeof(n=t[0].timestamp)&&(n=new Date(n)),Mr(n.getFullYear(),4)+Mr(n.getMonth()+1,2)+Mr(n.getDate(),2)+"T"+Mr(n.getHours(),2)+Mr(n.getMinutes(),2)+Mr(n.getSeconds(),2));var n;let i=document.createElement("p");i.setAttribute("class","download");let s=document.createElement("a");s.setAttribute("id",`download_${e}`),s.href=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"text/json"})),s.download=`observer.${e}.json`,s.textContent=`download_${e}`,i.appendChild(s),document.body.appendChild(i),s.click()}calculateMarkPositions(){let t,e=document.getElementById("markInputTextArea").value;try{t=this.parseMDLText(e,this.latestMagvar),this.definitions=t.definitions}catch(t){console.error(t),this.definitions=void 0}var n,i;n="MarkDefinitionsTable",i=this.definitions,er(`#${n}`).select("tbody").selectAll("tr").remove(),null!=i&&er(`#${n}`).select("tbody").selectAll("tr").data(i.definitions).enter().append(((t,e,n)=>{let i=document.createElement("tr");if(t instanceof ya){let e=document.createElement("td");e.textContent=t.comment,e.setAttribute("colspan",9),i.appendChild(e)}else if(t instanceof Ca){let e=[];for(let t=0;t<9;t++)e.push(document.createElement("td"));if(e[0].textContent=t.name,void 0!==t.description&&(e[1].textContent=t.description),t.value instanceof da)e[4].textContent=Number(t.value.value).toFixed(6),e[4].setAttribute("class","NumberCell"),e[8].textContent="Number";else if(t.value instanceof Ea)e[5].textContent=Number(t.value.distanceInMeters).toFixed(6),e[5].setAttribute("class","NumberCell"),e[8].textContent="Distance";else if(t.value instanceof pa)e[6].textContent=Number(t.value.degrees).toFixed(6),e[6].setAttribute("class","NumberCell"),e[8].textContent="Angle";else if(t.value instanceof ga)e[6].textContent=Number(t.value.degrees).toFixed(6),e[6].setAttribute("class","NumberCell"),e[8].textContent="Azimuth";else if(t.value instanceof xa)e[2].textContent=Mr(t.value.latitude,10,6),e[2].setAttribute("class","NumberCell"),e[3].textContent=Mr(t.value.longitude,10,6),e[3].setAttribute("class","NumberCell"),e[8].textContent="Location";else if(t.value instanceof Ta)e[5].textContent=Mr(t.value.distance.distanceInMeters,10,6),e[5].setAttribute("class","NumberCell"),e[6].textContent=Mr(t.value.azimuth.degrees,10,6),e[6].setAttribute("class","NumberCell"),e[8].textContent="Offset";else if(t.value instanceof Na){let n=t.value.roundings.roundings.map((t=>`${t.name.name}[${t.direction.direction}]`)).join(" -> ");e[7].textContent=n,e[8].textContent="Course"}for(let t=0;t<9;t++)i.appendChild(e[t])}return i})),this.dispatcher.notify("Definitions",this.definitions)}onDefinitionsChange(t){this.definitions=t;let e=this.latestSettings.courseSelect,n=er("#courseSelect");n.selectAll("option").remove();let i=this.definitions.getDefinitionNames("MDLCourse");i.unshift(""),n.selectAll("options").data(i).enter().append("option").attr("value",(t=>t)).text((t=>""===t?"None":t)),""!==e&&i.includes(e)&&(document.getElementById("courseSelect").value=e),this.settingsVC.poke()}onCourseChange(t){let e=this.latestSettings.markSelect,n=er("#markSelect");if(n.selectAll("option").remove(),void 0!==t&&""!==t){let i=t.options();n.selectAll("option").data(i,(t=>t)).enter().append("option").attr("value",(t=>t)).text((t=>t)),""!==e&&i.includes(e)&&(document.getElementById("markSelect").value=e)}else{let t=this.definitions.getDefinitionNames("MDLLocation");n.selectAll("option").data(t,(t=>t)).enter().append("option").attr("value",(t=>t)).text((t=>t)),""!==e&&t.includes(e)&&(document.getElementById("markSelect").value=e)}this.settingsVC.poke()}saveCurrentLocation(){let t=this.observer.latestPosition,e=`# Location saved at ${wr(t.timestamp)}`,n="L"+("number"==typeof(i=t.timestamp)&&(i=new Date(i)),Mr(i.getHours(),2)+Mr(i.getMinutes(),2)+Mr(i.getSeconds(),2));var i;let s=this.latestSettings.angleFormat,r=this.latestSettings.angleSign;"longSuffix"==r&&(r="shortSuffix");let o="";o="signed"==r?`${Mr(t.longitude,3,6)}, ${Mr(t.latitude,3,6)}`:`${Dr(t.longitude,s,r,"EW","fine")}, ${Dr(t.latitude,s,r,"NS","fine")}`;let a=document.getElementById("markInputTextArea");a.value=`${e}\n${n} = ${o}\n`+a.value}},vincentyGivenTwoPoints:Xr,vincentySanityCheck:function(){var t={longitude:-122,latitude:37},e={longitude:-121,latitude:37},n=Xr(t,e);$r(n.distanceInMeters,89011.26253669697,.01),$r(n.azimuthForwardInTrueDegrees,89.69908759545304,.001),$r(n.azimuthBackwardInTrueDegrees,270.300912404547,.001);var i=Xr(e,t);$r(i.distanceInMeters,89011.26253669697,.01),$r(i.azimuthForwardInTrueDegrees,270.300912404547,.001),$r(i.azimuthBackwardInTrueDegrees,89.69908759545304,.001);var s=Xr(t,{longitude:-122,latitude:38});$r(s.distanceInMeters,110987.04431012011,.01),$r(s.azimuthForwardInTrueDegrees,0,.001),$r(s.azimuthBackwardInTrueDegrees,180,.001);var r=Xr(t,{longitude:-121,latitude:38});return $r(r.distanceInMeters,141903.34701409607,.01),$r(r.azimuthForwardInTrueDegrees,38.24164318945553,.001),$r(r.azimuthBackwardInTrueDegrees,218.85043763214966,.001),"pass"}},window.globals.main.start();else{let t=document.getElementById("content"),e=[60,112,32,99,108,97,115,115,61,34,101,120,112,105,114,101,100,34,62,84,104,97,110,107,32,121,111,117,32,102,111,114,32,117,115,105,110,103,32,116,104,105,115,44,32,98,117,116,32,116,104,105,115,32,118,101,114,115,105,111,110,32,104,97,115,32,114,101,97,99,104,101,100,32,101,110,100,32,111,102,32,108,105,102,101,46,32,65,32,110,101,119,101,114,32,118,101,114,115,105,111,110,32,109,97,121,32,98,101,32,97,118,97,105,108,97,98,108,101,46,60,47,112,62].map((t=>String.fromCodePoint(t))).join("");t.innerHTML=e}})()})();